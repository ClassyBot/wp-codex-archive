<p class="LanguageLinks" style="border:1px solid #CCCCCC; line-height:1.5; text-align:left; color:#333333; font-size:90%; padding:10px;"><span style="white-space:nowrap;"><a href="https://codex.wordpress.org/Multilingual_Codex" title="Multilingual Codex" class="mw-redirect">Languages</a>:</span> 
<strong class="selflink">English</strong> • 
<a rel="nofollow" class="external text" href="https://wpdocs.osdn.jp/Class">Reference/WP Comment Query 日本語</a> 
 <small>(<a href="https://codex.wordpress.org/Multilingual_Codex#Language_Cross_Reference" title="Multilingual Codex" class="mw-redirect">Add your language</a>)</small>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Usage"><span class="tocnumber">2</span> <span class="toctext">Usage</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Default_Usage"><span class="tocnumber">2.1</span> <span class="toctext">Default Usage</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Methods_and_Properties"><span class="tocnumber">3</span> <span class="toctext">Methods and Properties</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Properties"><span class="tocnumber">3.1</span> <span class="toctext">Properties</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Methods"><span class="tocnumber">3.2</span> <span class="toctext">Methods</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Parameters"><span class="tocnumber">4</span> <span class="toctext">Parameters</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Custom_Field_Parameters"><span class="tocnumber">4.1</span> <span class="toctext">Custom Field Parameters</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Returns"><span class="tocnumber">5</span> <span class="toctext">Returns</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Change_Log"><span class="tocnumber">6</span> <span class="toctext">Change Log</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Source_File"><span class="tocnumber">7</span> <span class="toctext">Source File</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Resources"><span class="tocnumber">8</span> <span class="toctext">Resources</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#Related"><span class="tocnumber">9</span> <span class="toctext">Related</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Description">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Class_Reference/WP_Comment_Query&amp;action=edit&amp;section=1" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><tt>WP_Comment_Query</tt> is a class, defined in <code><a rel="nofollow" class="external text" href="https://core.trac.wordpress.org/browser/tags/5.1.1/src/wp-includes/class-wp-comment-query.php#L0">wp-includes/class-wp-comment-query.php</a></code>, that allows querying <a href="https://codex.wordpress.org/Database_Description" title="Database Description">WordPress database</a> tables '<tt><a href="https://codex.wordpress.org/Database_Description#Table:_wp_comments" title="Database Description">wp_comments</a></tt>' and '<tt><a href="https://codex.wordpress.org/Database_Description#Table:_wp_commentmeta" title="Database Description">wp_commentmeta</a></tt>'. The class was introduced in <a href="https://codex.wordpress.org/Version_3.1" title="Version 3.1">Version 3.1</a>.
</p>
<h2><span class="mw-headline" id="Usage">Usage</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Class_Reference/WP_Comment_Query&amp;action=edit&amp;section=2" title="Edit section: Usage">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre>
&lt;?php
$args = array(
   // args here
);

// The Query
$comments_query = new WP_Comment_Query;
$comments = $comments_query-&gt;query( $args );

// Comment Loop
if ( $comments ) {
	foreach ( $comments as $comment ) {
		echo '&lt;p&gt;' . $comment-&gt;comment_content . '&lt;/p&gt;';
	}
} else {
	echo 'No comments found.';
}
?&gt;
</pre>
<h3><span class="mw-headline" id="Default_Usage">Default Usage</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Class_Reference/WP_Comment_Query&amp;action=edit&amp;section=3" title="Edit section: Default Usage">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<pre>
&lt;?php
$args = array(
    'author_email' =&gt; '',    
    'author_url' =&gt; '',
    'author__in' =&gt; '',
    'author__not_in' =&gt; '',
    'include_unapproved' =&gt; '',
    'fields' =&gt; '',
    'ID' =&gt; '',
    'comment__in' =&gt; '',
    'comment__not_in' =&gt; '',
    'karma' =&gt; '',
    'number' =&gt; '',
    'offset' =&gt; '',
    'no_found_rows' =&gt; true,
    'orderby' =&gt; '',
    'order' =&gt; 'DESC',
    'parent' =&gt; '',
    'parent__in' =&gt; '',
    'parent__not_in' =&gt; '',
    'post_author__in' =&gt; '',
    'post_author__not_in' =&gt; '',
    'post_id' =&gt; 0,
    'post__in' =&gt; '',
    'post__not_in' =&gt; '',
    'post_author' =&gt; '',
    'post_name' =&gt; '',
    'post_parent' =&gt; '',
    'post_status' =&gt; '',
    'post_type' =&gt; '',
    'status' =&gt; 'all',
    'type' =&gt; '',
    'type__in' =&gt; '',
    'type__not_in' =&gt; '',
    'user_id' =&gt; '',
    'search' =&gt; '',
    'hierarchical' =&gt; false,
    'count' =&gt; false,
    'cache_domain' =&gt; 'core',
    'meta_key' =&gt; '',
    'meta_value' =&gt; '',
    'meta_query' =&gt; '',
    'date_query' =&gt; null, // See WP_Date_Query
    'update_comment_meta_cache' =&gt; true,
    'update_comment_post_cache' =&gt; false,
);
?&gt;
</pre>
<h2><span class="mw-headline" id="Methods_and_Properties">Methods and Properties</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Class_Reference/WP_Comment_Query&amp;action=edit&amp;section=4" title="Edit section: Methods and Properties">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Properties">Properties</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Class_Reference/WP_Comment_Query&amp;action=edit&amp;section=5" title="Edit section: Properties">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<h3><span class="mw-headline" id="Methods">Methods</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Class_Reference/WP_Comment_Query&amp;action=edit&amp;section=6" title="Edit section: Methods">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<h2><span class="mw-headline" id="Parameters">Parameters</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Class_Reference/WP_Comment_Query&amp;action=edit&amp;section=7" title="Edit section: Parameters">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<dl><dt> <tt>$status</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#String" title="How to Pass Tag Parameters"><i>string</i></a>) (<i>optional</i>) Only return comments with this status.<ul><li><tt>'hold'</tt> - unapproved comments</li><li><tt>'approve'</tt> - approved comments</li><li><tt>'trash'</tt> - trash comments</li></ul>
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<dl><dt> <tt>$orderby</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#String" title="How to Pass Tag Parameters"><i>string</i></a>) (<i>optional</i>) Set the field used to sort comments.
<dl><dd> Default: comment_date_gmt</dd></dl></dd></dl>
<dl><dt> <tt>$order</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#String" title="How to Pass Tag Parameters"><i>string</i></a>) (<i>optional</i>) How to sort <tt>$orderby</tt>. Valid values:<ul><li><tt>'ASC'</tt> - Ascending (lowest to highest).</li><li><tt>'DESC'</tt> - Descending (highest to lowest).</li></ul>
<dl><dd> Default: DESC</dd></dl></dd></dl>
<dl><dt> <tt>$number</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Integer" title="How to Pass Tag Parameters"><i>integer</i></a>) (<i>optional</i>) Number of comments to return. Leave blank to return all comments.
<dl><dd> Default: unlimited</dd></dl></dd></dl>
<dl><dt> <tt>$offset</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Integer" title="How to Pass Tag Parameters"><i>integer</i></a>) (<i>optional</i>) Offset from latest comment. You must include $number along with this.
<dl><dd> Default: 0</dd></dl></dd></dl>
<dl><dt> <tt>$post_id</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Integer" title="How to Pass Tag Parameters"><i>integer</i></a>) (<i>optional</i>) Only return comments for a particular post or page.
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<dl><dt> <tt>$user_id</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Integer" title="How to Pass Tag Parameters"><i>integer</i></a>) (<i>optional</i>) Only return comments for a particular user.
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<dl><dt> <tt>$count</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Integer" title="How to Pass Tag Parameters"><i>integer</i></a>) (<i>optional</i>) Only return the total count of comments.
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<p><br />
</p>
<dl><dt> <tt>$type__in</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Array" title="How to Pass Tag Parameters"><i>array</i></a>) (<i>optional</i>)  Allows specification of specific comment types
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<dl><dt> <tt>$type__not_in</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Array" title="How to Pass Tag Parameters"><i>array</i></a>) (<i>optional</i>)  Allows specifying all comment types except those in the array
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<dl><dt> <tt>$meta_key</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#String" title="How to Pass Tag Parameters"><i>string</i></a>) (<i>optional</i>) Custom meta field key.
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<dl><dt> <tt>$meta_value</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#String" title="How to Pass Tag Parameters"><i>string</i></a>) (<i>optional</i>) Custom meta field value.
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<dl><dt> <tt>$meta_query</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Array" title="How to Pass Tag Parameters"><i>array</i></a>) (<i>optional</i>) Advanced meta query parameters (available with <a href="https://codex.wordpress.org/Version_3.5" title="Version 3.5">Version 3.5</a>).
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<dl><dt> <tt>$fields</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#String" title="How to Pass Tag Parameters"><i>string</i></a>) (<i>optional</i>) Which fields to return (available with <a href="https://codex.wordpress.org/Version_4.0" title="Version 4.0">Version 4.0</a>).<ul><li><tt>'ids'</tt> - Comments ID's</li><li><tt>'*'</tt> - All comment fields.</li></ul>
<dl><dd> Default: *</dd></dl></dd></dl>
<h3><span class="mw-headline" id="Custom_Field_Parameters">Custom Field Parameters</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Class_Reference/WP_Comment_Query&amp;action=edit&amp;section=8" title="Edit section: Custom Field Parameters">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Show comments associated with a certain custom field.
</p>
<ul><li> <b><tt>meta_key</tt></b> (<i>string</i>) - Custom field key.</li>
<li> <b><tt>meta_value</tt></b> (<i>string</i>) - Custom field value.</li></ul>
<ul><li> <b><tt>meta_query</tt></b> (<i>array</i>) - Custom field parameters (available with <a href="https://codex.wordpress.org/Version_3.5" title="Version 3.5">Version 3.5</a>).
<ul><li> <b><tt>key</tt></b> (<i>string</i>) - Custom field key.</li>
<li> <b><tt>value</tt></b> (<i>string</i>|<i>array</i>) - Custom field value (<i>Note</i>: Array support is limited to a compare value of 'IN', 'NOT IN', 'BETWEEN', 'NOT BETWEEN', 'EXISTS' or 'NOT EXISTS')</li>
<li> <b><tt>compare</tt></b> (<i>string</i>) - Operator to test. Possible values are '=', '!=', '&gt;', '&gt;=', '&lt;', '&lt;=', 'LIKE', 'NOT LIKE', 'IN', 'NOT IN', 'BETWEEN', 'NOT BETWEEN', 'EXISTS', and 'NOT EXISTS'. Default value is '='.</li>
<li> <b><tt>type</tt></b> (<i>string</i>) - Custom field type. Possible values are 'NUMERIC', 'BINARY', 'CHAR', 'DATE', 'DATETIME', 'DECIMAL', 'SIGNED', 'TIME', 'UNSIGNED'. Default value is 'CHAR'.</li></ul></li></ul>
<p><b>Display featured comments</b>
</p>
<pre>$comment_query = new WP_Comment_Query( array( 'meta_key' =&gt; 'featured', 'meta_value' =&gt; '1' ) );
</pre>
<p><b>Multiple meta fields handling</b>
</p>
<pre>$args = array(
	'meta_query' =&gt; array(
		'relation' =&gt; 'AND',
		array(
			'key' =&gt; 'featured',
			'value' =&gt; '1'
		),
		array(
			'key' =&gt; 'buried',
			'value' =&gt; '1',
			'type' =&gt; 'numeric',
			'compare' =&gt; '!='
		)
	)
 );
$comment_query = new WP_Comment_Query( $args );
</pre>
<h2><span class="mw-headline" id="Returns">Returns</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Class_Reference/WP_Comment_Query&amp;action=edit&amp;section=9" title="Edit section: Returns">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<dl><dt> (Array)&#160;</dt>
<dd> Comment fields with the following index keys (or an empty array if there are no comments):</dd></dl>
<dl><dt> <tt>comment_ID</tt>&#160;</dt>
<dd> (<i>integer</i>) The comment ID</dd>
<dt> <tt>comment_post_ID</tt>&#160;</dt>
<dd> (<i>integer</i>) The ID of the post/page that this  comment responds to</dd>
<dt> <tt>comment_author</tt>&#160;</dt>
<dd> (<i>string</i>) The comment author's name</dd>
<dt> <tt>comment_author_email</tt>&#160;</dt>
<dd> (<i>string</i>) The comment author's email</dd>
<dt> <tt>comment_author_url</tt>&#160;</dt>
<dd> (<i>string</i>) The comment author's webpage</dd>
<dt> <tt>comment_author_IP</tt>&#160;</dt>
<dd> (<i>string</i>) The comment author's IP</dd>
<dt> <tt>comment_date</tt>&#160;</dt>
<dd> (<i>string</i>) The datetime of the comment (<tt>YYYY-MM-DD HH:MM:SS</tt>)</dd>
<dt> <tt>comment_date_gmt</tt>&#160;</dt>
<dd> (<i>string</i>) The GMT datetime of the comment (<tt>YYYY-MM-DD HH:MM:SS</tt>)</dd>
<dt> <tt>comment_content</tt>&#160;</dt>
<dd> (<i>string</i>) The comment's content</dd>
<dt> <tt>comment_karma</tt>&#160;</dt>
<dd> (<i>integer</i>) The comment's karma</dd>
<dt> <tt>comment_approved</tt>&#160;</dt>
<dd> (<i>string</i>) The comment approval level (0, 1 or "spam")</dd>
<dt> <tt>comment_agent</tt>&#160;</dt>
<dd> (<i>string</i>) The commenter's user agent (browser, operating system, etc.)</dd>
<dt> <tt>comment_type</tt>&#160;</dt>
<dd> (<i>string</i>) The comment's type if meaningfull (<tt>pingback|trackback</tt>), empty for normal comments</dd>
<dt> <tt>comment_parent</tt>&#160;</dt>
<dd> (<i>string</i>) The parent comment's ID for nested comments (0 for top level)</dd>
<dt> <tt>user_id</tt>&#160;</dt>
<dd> (<i>integer</i>) The comment author's ID if s/he is registered (0 otherwise)</dd></dl>
<h2><span class="mw-headline" id="Change_Log">Change Log</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Class_Reference/WP_Comment_Query&amp;action=edit&amp;section=10" title="Edit section: Change Log">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> <a href="https://codex.wordpress.org/Version_4.6" title="Version 4.6">4.6.0</a>:
<ul><li> Add '<tt>$cache_domain</tt>' parameter.</li></ul></li></ul>
<ul><li> <a href="https://codex.wordpress.org/Version_4.5" title="Version 4.5">4.5.0</a>:
<ul><li> Add '<tt>$author_url</tt>' parameter.</li></ul></li></ul>
<ul><li> <a href="https://codex.wordpress.org/Version_4.4" title="Version 4.4">4.4.0</a>:
<ul><li> Add '<tt>$parent__in</tt>' and '<tt>$parent__not_in</tt>' parameters.</li>
<li> Add '<tt>$no_found_rows</tt>' and '<tt>$hierarchical</tt>' parameters.</li>
<li> Add '<tt>$update_comment_meta_cache</tt>' and '<tt>$update_comment_post_cache</tt>' parameters.</li>
<li> Add Order by '<tt>comment__in</tt>'.</li></ul></li></ul>
<ul><li> <a href="https://codex.wordpress.org/Version_4.1" title="Version 4.1">4.1.0</a>:
<ul><li> Add '<tt>comment__in</tt>', '<tt>comment__not_in</tt>', '<tt>post_author__in</tt>', '<tt>post_author__not_in</tt>', '<tt>author__in</tt>', '<tt>author__not_in</tt>', '<tt>post__in</tt>', '<tt>post__not_in</tt>', '<tt>include_unapproved</tt>', '<tt>type__in</tt>', and '<tt>type__not_in</tt>' parameters.</li></ul></li></ul>
<ul><li> Since: <a href="https://codex.wordpress.org/Version_3.1" title="Version 3.1">3.1.0</a></li></ul>
<h2><span class="mw-headline" id="Source_File">Source File</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Class_Reference/WP_Comment_Query&amp;action=edit&amp;section=11" title="Edit section: Source File">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><tt>WP_Comment_Query</tt> is located in <code><a rel="nofollow" class="external text" href="https://core.trac.wordpress.org/browser/tags/5.1.1/src/wp-includes/class-wp-comment-query.php#L0">wp-includes/class-wp-comment-query.php</a></code>.
</p>
<h2><span class="mw-headline" id="Resources">Resources</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Class_Reference/WP_Comment_Query&amp;action=edit&amp;section=12" title="Edit section: Resources">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> <a rel="nofollow" class="external text" href="http://generatewp.com/wp_comment_query/">WordPress WP_Comment_Query Generator</a></li></ul>
<h2><span class="mw-headline" id="Related">Related</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Class_Reference/WP_Comment_Query&amp;action=edit&amp;section=13" title="Edit section: Related">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> <a href="https://codex.wordpress.org/Class_Reference/WP_Query" title="Class Reference/WP Query"> WP_Query</a> - Class for post-related queries</li>
<li> <a href="https://codex.wordpress.org/Class_Reference/WP_User_Query" title="Class Reference/WP User Query"> WP_User_Query</a> - Class for user-related queries</li></ul>
<div style="background-color:#DFDFDF; border:1px solid #CCCCCC; color:#000000; padding:7px; margin:0.5em auto 0.5em auto; vertical-align:middle; overflow:hidden;">See also index of <a href="https://codex.wordpress.org/Class_Reference" title="Class Reference">Class Reference</a> and index of <a href="https://codex.wordpress.org/Function_Reference" title="Function Reference">Function Reference</a>.</div>


