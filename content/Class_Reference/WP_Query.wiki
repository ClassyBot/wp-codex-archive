{{Languages|
{{en|Class Reference/WP_Query}}
{{it|Riferimento classi/WP_Query}}
{{ko|Class Reference/WP_Query}}
{{ja|関数リファレンス/WP_Query}}
{{zh-cn|Class Reference/WP_Query}}
{{pt-br|Referência de Classe/WP_Query}}
}}
This page was moved to https://developer.wordpress.org/reference/classes/wp_query/ except above language locator.

<!--

==Description==

<tt>WP_Query</tt> is a class defined in {{Trac|wp-includes/class-wp-query.php}} that deals with the intricacies of a post's (or page's) request to a WordPress blog. The <tt>{{Trac|wp-blog-header.php}}</tt> (or the WP class in [[Version 2.0]]) gives the <tt>$wp_query</tt> object information defining the current request, and then <tt>$wp_query</tt> determines what type of query it's dealing with (possibly a category archive, dated archive, feed, or search), and fetches the requested posts. It retains a lot of information on the request, which can be pulled at a later date.

==Interacting with WP_Query==

Most of the time you can find the information you want without actually dealing with the class internals and global variables. There are a whole bunch of functions that you can call from anywhere that will enable you to get the information you need.

There are two main scenarios you might want to use <tt>WP_Query</tt> in. The first is to find out what type of request WordPress is currently dealing with. The <tt>$is_*</tt> properties are designed to hold this information: use the [[Conditional Tags]] to interact here. This is the more common scenario to plugin writers (the second normally applies to theme writers).

The second is during [[The Loop]]. <tt>WP_Query</tt> provides numerous functions for common tasks within The Loop. To begin with, [[Function_Reference/have_posts|have_posts()]], which calls <tt>$wp_query->have_posts()</tt>, is called to see if there are any posts to show. If there are, a <tt>while</tt> loop is begun, using [[Function_Reference/have_posts|have_posts()]] as the condition. This will iterate around as long as there are posts to show. In each iteration, [[Function_Reference/the_post|the_post()]], which calls <tt>$wp_query->the_post()</tt> is called, setting up internal variables within <tt>$wp_query</tt> and the global <tt>$post</tt> variable (which the [[Template Tags]] rely on), as above. These are the functions you should use when writing a theme file that needs a loop. See also [[The Loop]] and [[The Loop in Action]] for more information.

'''Note:''' If you use [[Function_Reference/the_post|the_post()]] with your query, you need to run [[Function_Reference/wp_reset_postdata|wp_reset_postdata()]] afterwards to have [[Template Tags]] use the main query's current post again.

'''Note:''' [https://core.trac.wordpress.org/ticket/18408 Ticket #18408] For querying posts in the admin, consider using [[Function_Reference/get_posts|get_posts()]] as [[Function_Reference/wp_reset_postdata|wp_reset_postdata()]] might not behave as expected.

==Usage==

===Standard Loop===

<pre>
<?php

// The Query
$the_query = new WP_Query( $args );

// The Loop
if ( $the_query->have_posts() ) {
	echo '<ul>';
	while ( $the_query->have_posts() ) {
		$the_query->the_post();
		echo '<li>' . get_the_title() . '</li>';
	}
	echo '</ul>';
	/* Restore original Post Data */
	wp_reset_postdata();
} else {
	// no posts found
}
</pre>

===Standard Loop (Alternate)===

<pre>
<?php 

// the query
$the_query = new WP_Query( $args ); ?>

<?php if ( $the_query->have_posts() ) : ?>

	<!-- pagination here -- >

	<!-- the loop -- >
	<?php while ( $the_query->have_posts() ) : $the_query->the_post(); ?>
		<h2><?php the_title(); ?></h2>
	<?php endwhile; ?>
	<!-- end of the loop -- >

	<!-- pagination here -- >

	<?php wp_reset_postdata(); ?>

<?php else : ?>
	<p><?php esc_html_e( 'Sorry, no posts matched your criteria.' ); ?></p>
<?php endif; ?>
</pre>

===Multiple Loops===
If you have multiple queries, you need to perform multiple loops. Like so...

<pre>
<?php

// The Query
$query1 = new WP_Query( $args );

if ( $query1->have_posts() ) {
	// The Loop
	while ( $query1->have_posts() ) {
		$query1->the_post();
		echo '<li>' . get_the_title() . '</li>';
	}
	
	/* Restore original Post Data 
	 * NB: Because we are using new WP_Query we aren't stomping on the 
	 * original $wp_query and it does not need to be reset with 
	 * wp_reset_query(). We just need to set the post data back up with
	 * wp_reset_postdata().
	 */
	wp_reset_postdata();
}

/* The 2nd Query (without global var) */
$query2 = new WP_Query( $args2 );

if ( $query2->have_posts() ) {
	// The 2nd Loop
	while ( $query2->have_posts() ) {
		$query2->the_post();
		echo '<li>' . get_the_title( $query2->post->ID ) . '</li>';
	}

	// Restore original Post Data
	wp_reset_postdata();
}

?>
</pre>

==Methods and Properties==

This is the formal documentation of <tt>WP_Query</tt>. You shouldn't alter the properties directly, but instead use the methods to interact with them. Also see [[#Interacting_with_WP_Query|Interacting with WP_Query]] for some useful functions that avoid the need to mess around with class internals and global variables.

===Properties===

; <tt>$query</tt>
: Holds the query string that was passed to the $wp_query object by  WP class.

; <tt>$query_vars</tt>
: An associative array containing the dissected <tt>$query</tt>: an array of the query variables and their respective values.

; <tt>$queried_object</tt>
: Applicable if the request is a category, author, permalink or Page. Holds information on the requested category, author, post or Page.

; <tt>$queried_object_id</tt>
: If the request is a category, author, permalink or post / page, holds the corresponding ID.

; <tt>$posts</tt>
: Gets filled with the requested posts from the database.

; <tt>$post_count</tt>
: The number of posts being displayed.

; <tt>$found_posts</tt>
: The total number of posts found matching the current query parameters

; <tt>$max_num_pages</tt>
: The total number of pages. Is the result of $found_posts / $posts_per_page

; <tt>$current_post</tt>
: (available during [[The Loop]]) Index of the post currently being displayed.

; <tt>$post</tt>
: (available during [[The Loop]]) The post currently being displayed.

; <tt>$is_single</tt>, <tt>$is_page</tt>, <tt>$is_archive</tt>, <tt>$is_preview</tt>, <tt>$is_date</tt>, <tt>$is_year</tt>, <tt>$is_month</tt>, <tt>$is_time</tt>, <tt>$is_author</tt>, <tt>$is_category</tt>, <tt>$is_tag</tt>, <tt>$is_tax</tt>, <tt>$is_search</tt>, <tt>$is_feed</tt>, <tt>$is_comment_feed</tt>, <tt>$is_trackback</tt>, <tt>$is_home</tt>, <tt>$is_404</tt>, <tt>$is_comments_popup</tt>, <tt>$is_admin</tt>, <tt>$is_attachment</tt>, <tt>$is_singular</tt>, <tt>$is_robots</tt>, <tt>$is_posts_page</tt>, <tt>$is_paged</tt>
: [[Glossary#Boolean|Booleans]] dictating what type of request this is. For example, the first three represent 'is it a permalink?', 'is it a Page?', 'is it any type of archive page?', respectively. See also [[Conditional_Tags]].

===Methods===

(An ampersand (&) before a method name indicates it [http://www.php.net/manual/en/language.references.return.php returns by reference].)

; <tt>init()</tt>
: Initialise the object, set all properties to null, zero or false.

; <tt>parse_query( $query )</tt>
: Takes a query string defining the request, parses it and populates all properties apart from <tt>$posts</tt>, <tt>$post_count</tt>, <tt>$post</tt> and <tt>$current_post</tt>.

; <tt>parse_query_vars()</tt>
: Reparse the old query string.

; <tt>get( $query_var )</tt>
: Get a named query variable.

; <tt>set( $query_var, $value )</tt>
: Set a named query variable to a specific value.

; <tt>&get_posts()</tt>
: Fetch and return the requested posts from the database. Also populate <tt>$posts</tt> and <tt>$post_count</tt>.  <b>Note:</b> This is called during construction if WP_Query is constructed with arguments. It is <em>not</em> idempotent and should not be called more than once on the same query object. Doing so may result in a broken query.

; <tt>next_post()</tt>
: (to be used when in [[The Loop]]) Advance onto the next post in <tt>$posts</tt>. Increment <tt>$current_post</tt> and set <tt>$post</tt> to the (new) current post object (note: this does not set the global <tt>$post</tt> variable, only the WP_Query object's instance variable.) Returns the current post object <b>(This is deprecated pleases use 'next_post_link()' )</b>

; <tt>the_post()</tt>
: (to be used when in [[The Loop]]) Advance onto the next post, and set the global <tt>$post</tt> variable.

; <tt>have_posts()</tt>
: (to be used when in [[The Loop]], or just before The Loop) Determine if we have posts remaining to be displayed.  Calls <tt>rewind_posts()</tt> and returns false if don't have posts remaining.  Because of the rewind, you can't rely on have_posts() staying false.  See [[Function_Reference/have_posts#Note|have_posts() note]].

; <tt>rewind_posts()</tt>
: Reset <tt>$current_post</tt> and <tt>$post</tt>.

; <tt>&query( $query )</tt>
: Call <tt>parse_query()</tt> and <tt>get_posts()</tt>. Return the results of <tt>get_posts()</tt>.

; <tt>get_queried_object()</tt>
: Set <tt>$queried_object</tt> if it's not already set and return it.

; <tt>get_queried_object_id()</tt>
: Set <tt>$queried_object_id</tt> if it's not already set and return it.

; <tt>WP_Query( $query = <nowiki>''</nowiki> )</tt> (constructor)
: If you provide a query string, call <tt>query()</tt> with it.

==Parameters==

===Author Parameters===

Show posts associated with certain author.

* '''<tt>author</tt>''' (''int | string'') - use author id or comma-separated list of IDs.
* '''<tt>author_name</tt>''' (''string'') - use '<tt>user_nicename</tt>' - NOT name.
* '''<tt>author__in</tt>''' (''array'') - use author id (available since [[Version 3.7]]).
* '''<tt>author__not_in</tt>''' (''array'') - use author id (available since [[Version 3.7]]).

'''Show Posts for one Author'''

Display posts by author, using author id:

 $query = new WP_Query( array( 'author' => 123 ) );

Display posts by author, using author '<tt>user_nicename</tt>':

 $query = new WP_Query( array( 'author_name' => 'rami' ) );

'''Show Posts From Several Authors'''

Display posts from several specific authors: 

 $query = new WP_Query( array( 'author' => '2,6,17,38' ) );

'''Exclude Posts Belonging to an Author'''

Display all posts ''except'' those from an author(singular) by prefixing its id with a '-' (minus) sign:

 $query = new WP_Query( array( 'author' => -12 ) );

'''Multiple Author Handling'''

Display posts from multiple authors:

 $query = new WP_Query( array( 'author__in' => array( 2, 6 ) ) );

You can also exclude multiple author this way:

 $query = new WP_Query( array( 'author__not_in' => array( 2, 6 ) ) );

===Category Parameters===

Show posts associated with certain categories.

* '''<tt>cat</tt>''' (''int'') - use category id.
* '''<tt>category_name</tt>''' (''string'') - use category slug.
* '''<tt>category__and</tt>''' (''array'') - use category id.
* '''<tt>category__in</tt>''' (''array'') - use category id.
* '''<tt>category__not_in</tt>''' (''array'') - use category id.

'''Show Posts for One Category'''

Display posts that have this category (and any children of that category), using category id:

 $query = new WP_Query( array( 'cat' => 4 ) );

Display posts that have this category (and any children of that category), using category slug:

 $query = new WP_Query( array( 'category_name' => 'staff' ) );

Display posts that have this category (not children of that category), using category id:

 $query = new WP_Query( array( 'category__in' => 4 ) );

'''Show Posts From Several Categories'''

Display posts that have these categories, using category id:

 $query = new WP_Query( array( 'cat' => '2,6,17,38' ) );

Display posts that have these categories, using category slug:

 $query = new WP_Query( array( 'category_name' => 'staff,news' ) );

Display posts that have "all" of these categories:

 $query = new WP_Query( array( 'category_name' => 'staff+news' ) );

'''Exclude Posts Belonging to Category'''

Display all posts ''except'' those from a category by prefixing its id with a '-' (minus) sign.

 $query = new WP_Query( array( 'cat' => '-12,-34,-56' ) );

'''Multiple Category Handling'''

Display posts that are in multiple categories.  This shows posts that are in both categories 2 and 6:

 $query = new WP_Query( array( 'category__and' => array( 2, 6 ) ) );

To display posts from either category 2 OR 6, you could use <tt>cat</tt> as mentioned above, or by using <tt>category__in</tt> (note this does not show posts from any children of these categories):

 $query = new WP_Query( array( 'category__in' => array( 2, 6 ) ) );

You can also exclude multiple categories this way:

 $query = new WP_Query( array( 'category__not_in' => array( 2, 6 ) ) );

===Tag Parameters===

Show posts associated with certain tags.

* '''<tt>tag</tt>''' (''string'') - use tag slug.
* '''<tt>tag_id</tt>''' (''int'') - use tag id.
* '''<tt>tag__and</tt>''' (''array'') - use tag ids.
* '''<tt>tag__in</tt>''' (''array'') - use tag ids.
* '''<tt>tag__not_in</tt>''' (''array'') - use tag ids.
* '''<tt>tag_slug__and</tt>''' (''array'') - use tag slugs.
* '''<tt>tag_slug__in</tt>''' (''array'') - use tag slugs.

'''Show Posts for One Tag'''

Display posts that have this tag, using tag slug:

 $query = new WP_Query( array( 'tag' => 'cooking' ) );

Display posts that have this tag, using tag id:

 $query = new WP_Query( array( 'tag_id' => 13 ) );

'''Show Posts From Several Tags'''

Display posts that have "either" of these tags:

 $query = new WP_Query( array( 'tag' => 'bread,baking' ) );

Display posts that have "all" of these tags:

 $query = new WP_Query( array( 'tag' => 'bread+baking+recipe' ) );

'''Multiple Tag Handling'''

Display posts that are tagged with both tag id 37 and tag id 47:

 $query = new WP_Query( array( 'tag__and' => array( 37, 47 ) ) );

To display posts from either tag id 37 or 47, you could use <tt>tag</tt> as mentioned above, or explicitly specify by using <tt>tag__in</tt>:

 $query = new WP_Query( array( 'tag__in' => array( 37, 47 ) ) );

Display posts that do not have any of the two tag ids 37 and 47:

 $query = new WP_Query( array( 'tag__not_in' => array( 37, 47 ) ) );

The <tt>tag_slug__in</tt> and <tt>tag_slug__and</tt> behave much the same, except match against the tag's slug.

===Taxonomy Parameters===

Show posts associated with certain [[Taxonomies|taxonomy]].

* '''<tt>{tax}</tt>''' (''string'') - use taxonomy slug. ('''Deprecated''' since [[Version 3.1]] in favor of '<tt>tax_query</tt>').
* '''<tt>tax_query</tt>''' (''array'') - use taxonomy parameters (available since [[Version 3.1]]).
** '''<tt>relation</tt>''' (''string'') - The logical relationship between each inner taxonomy array when there is more than one. Possible values are 'AND', 'OR'. Do not use with a single inner taxonomy array. Default value is 'AND'.
*** '''<tt>taxonomy</tt>''' (''string'') - Taxonomy.
*** '''<tt>field</tt>''' (''string'') -  Select taxonomy term by. Possible values are 'term_id', 'name', 'slug' or 'term_taxonomy_id'. Default value is 'term_id'.
*** '''<tt>terms</tt>''' (''int/string/array'') - Taxonomy term(s).
*** '''<tt>include_children</tt>''' (''boolean'') -  Whether or not to include children for hierarchical taxonomies. Defaults to true.
*** '''<tt>operator</tt>''' (''string'') - Operator to test. Possible values are 'IN', 'NOT IN', 'AND', 'EXISTS' and 'NOT EXISTS'. Default value is 'IN'.

'''Note:''' If <tt>WP_Query</tt> determines that the result will be singular (<tt>[[Function_Reference/is_singular|is_singular()]]</tt> is <tt>true</tt>), it will ignore the <tt>tax_query</tt> parameter.  To modify <tt>tax_query</tt>, use the <tt>[[Plugin_API/Filter_Reference/posts_clauses|posts_clauses]]</tt> filter to add the required SQL statements.

'''Important Note:''' <tt>tax_query</tt> takes an '''array''' of tax query arguments '''arrays''' (it takes an array of arrays).
This construct allows you to query multiple taxonomies by using the '''<tt>relation</tt>''' parameter in the first (outer) array to describe the boolean relationship between the taxonomy arrays.

'''Simple Taxonomy Query:'''

Display '''posts''' tagged with '''bob''', under '''people''' custom taxonomy:

<pre>
$args = array(
	'post_type' => 'post',
	'tax_query' => array(
		array(
			'taxonomy' => 'people',
			'field'    => 'slug',
			'terms'    => 'bob',
		),
	),
);
$query = new WP_Query( $args );
</pre>

'''Multiple Taxonomy Handling:'''

Display '''posts''' from several custom taxonomies:

<pre>
$args = array(
	'post_type' => 'post',
	'tax_query' => array(
		'relation' => 'AND',
		array(
			'taxonomy' => 'movie_genre',
			'field'    => 'slug',
			'terms'    => array( 'action', 'comedy' ),
		),
		array(
			'taxonomy' => 'actor',
			'field'    => 'term_id',
			'terms'    => array( 103, 115, 206 ),
			'operator' => 'NOT IN',
		),
	),
);
$query = new WP_Query( $args );
</pre>

Display '''posts''' that are in the '''quotes''' category OR have the '''quote''' [[Post Formats|format]]:

<pre>
$args = array(
	'post_type' => 'post',
	'tax_query' => array(
		'relation' => 'OR',
		array(
			'taxonomy' => 'category',
			'field'    => 'slug',
			'terms'    => array( 'quotes' ),
		),
		array(
			'taxonomy' => 'post_format',
			'field'    => 'slug',
			'terms'    => array( 'post-format-quote' ),
		),
	),
);
$query = new WP_Query( $args );
</pre>

'''Nested Taxonomy Handling:'''

The <tt>'tax_query'</tt> clauses can be nested, to create more complex queries. Example: Display '''posts''' that are in the '''quotes''' category OR both have the '''quote''' post format AND are in the '''wisdom''' category:

<pre>
$args = array(
	'post_type' => 'post',
	'tax_query' => array(
		'relation' => 'OR',
		array(
			'taxonomy' => 'category',
			'field'    => 'slug',
			'terms'    => array( 'quotes' ),
		),
		array(
                        'relation' => 'AND',
                        array(
			        'taxonomy' => 'post_format',
			        'field'    => 'slug',
			        'terms'    => array( 'post-format-quote' ),
                        ),
                        array(
                                'taxonomy' => 'category',
                                'field'    => 'slug',
                                'terms'    => array( 'wisdom' ),
                        ),
		),
	),
);
$query = new WP_Query( $args );
</pre>

===Search Parameter===

Show posts based on a keyword search.

* '''<tt>s</tt>''' (''string'') - Search keyword.

'''Show Posts based on a keyword search'''

Display posts that match the search term "keyword":

 $query = new WP_Query( array( 's' => 'keyword' ) );

Prepending a term with a hyphen will exclude posts matching that term. Eg, 'pillow -sofa' will return posts containing 'pillow' but not 'sofa' (available since [[Version 4.4]]).

===Post & Page Parameters===

Display content based on post and page parameters. Remember that default <tt>post_type</tt> is only set to display posts but not pages.

* '''<tt>p</tt>''' (''int'') - use post id. Default post type is post.
* '''<tt>name</tt>''' (''string'') - use post slug.
* '''<tt>title</tt>''' (''string'') - use post title (available with [[Version 4.4]]).
* '''<tt>page_id</tt>''' (''int'') - use page id.
* '''<tt>pagename</tt>''' (''string'') - use page slug.
* '''<tt>post_parent</tt>''' (''int'') - use page id to return only child pages. Set to 0 to return only top-level entries.
* '''<tt>post_parent__in</tt>''' (''array'') - use post ids. Specify posts whose parent is in an array. (available since [[Version 3.6]])
* '''<tt>post_parent__not_in</tt>''' (''array'') - use post ids. Specify posts whose parent is not in an array. Like post__in/post__not_in, id's that are present in post_parent__in will over-ride ids specified in post_parent__not_in  (available since [[Version 3.6]])
* '''<tt>post__in</tt>''' (''array'') - use post ids. Specify posts to retrieve. '''ATTENTION''' If you use sticky posts, they will be included (prepended!) in the posts you retrieve whether you want it or not. To suppress this behaviour use [http://codex.wordpress.org/Class_Reference/WP_Query#Pagination_Parameters ignore_sticky_posts].
* '''<tt>post__not_in</tt>''' (''array'') - use post ids. Specify post NOT to retrieve. If this is used in the same query as post__in, it will be ignored.
* '''<tt>post_name__in</tt>''' (''array'') - use post slugs. Specify posts to retrieve. (available since [[Version 4.4]])

'''NOTE:''' [https://core.trac.wordpress.org/ticket/28099 Ticket #28099] Passing an empty array to <tt>post__in</tt> will return <tt>have_posts()</tt> as true (and all posts will be returned). Logic should be used before hand to determine if <tt>WP_Query</tt> should be used in the event that the array being  passed to <tt>post__in</tt> is empty.

'''Show Post/Page by ID'''

Display post by ID:

 $query = new WP_Query( array( 'p' => 7 ) );
 //for page, use:              'page_id'=>7

'''NOTE:'''Beware of ID = 0. This might return results. 

'''Show Post/Page by Slug'''

Display post by <tt>slug</tt>:

 $query = new WP_Query( array( 'name' => 'about-my-life' ) );
 //for page, use:              'pagename'=>'about-my-life'

'''Show Child Posts/Pages'''

Display child page using the slug of the parent and the child page, separated by a slash (e.g. 'parent_slug/child_slug'):

 $query = new WP_Query( array( 'pagename' => 'contact_us/canada' ) );

Display child pages using parent page ID:

 $query = new WP_Query( array( 'post_parent' => 93 ) );

Display only top-level pages, exclude all child pages:

 $query = new WP_Query( array( 'post_parent' => 0 ) );

Display posts whose parent is in an array:

 $query = new WP_Query( array( 'post_parent__in' => array( 2, 5, 12, 14, 20 ) ) );

'''Multiple Posts/Pages Handling'''

Display only the specific posts:

 $query = new WP_Query( array( 'post_type' => 'page', 'post__in' => array( 2, 5, 12, 14, 20 ) ) );

Display all posts but NOT the specified ones:

 $query = new WP_Query( array( 'post_type' => 'post', 'post__not_in' => array( 2, 5, 12, 14, 20 ) ) );

Note: you cannot combine <tt>post__in</tt> and <tt>post__not_in</tt> in the same query.

Also note, not to pass comma separated string 

 'post__not_in' => array( '1,2,3' )  // <--- this wont work

===Password Parameters===

Show content based on post and page parameters. Remember that default <tt>post_type</tt> is only set to display posts but not pages.

* '''<tt>has_password</tt>''' (''bool'') -  true for posts with passwords ; false for posts without passwords ; null for all posts with and without passwords (available since [[Version 3.9]]).
* '''<tt>post_password</tt>''' (''string'') - show posts with a particular password (available since [[Version 3.9]])

'''Show Posts with/without passwords'''

Display only password protected posts:

 $query = new WP_Query( array( 'has_password' => true ) );

Display only posts without passwords:

 $query = new WP_Query( array( 'has_password' => false ) );

Display only posts with and without passwords:

 $query = new WP_Query( array( 'has_password' => null ) );

'''Show Posts with particular password'''

Display posts with 'zxcvbn' password:

 $query = new WP_Query( array( 'post_password' => 'zxcvbn' ) );

===Type Parameters===

Show posts associated with certain [[Post Types|type]].

* '''<tt>post_type</tt>''' (''string'' / ''array'') - use post types. Retrieves posts by [[Post Types]], default value is '<tt>post</tt>'. If '<tt>tax_query</tt>' is set for a query, the default value becomes '<tt>any</tt>';
** '<tt>post</tt>' - a post.
** '<tt>page</tt>' - a page.
** '<tt>revision</tt>' - a revision.
** '<tt>attachment</tt>' - an attachment. Whilst the default WP_Query <tt>post_status</tt> is 'publish', attachments have a default <tt>post_status</tt> of 'inherit'.  This means no attachments will be returned unless you also explicitly set <tt>post_status</tt> to 'inherit' or 'any'. (See [[Class_Reference/WP_Query#Status_Parameters|post_status]], below)
** '<tt>nav_menu_item</tt>' - a navigation menu item
** '<tt>any</tt>' - retrieves any type except revisions and types with 'exclude_from_search' set to true.
** Custom Post Types (e.g. movies)

'''Show Post by Type'''

Display only pages:

 $query = new WP_Query( array( 'post_type' => 'page' ) );

Display '<tt>any</tt>' post type (retrieves any type except revisions and types with 'exclude_from_search' set to TRUE):

 $query = new WP_Query( array( 'post_type' => 'any' ) );

Display multiple post types, including custom post types:

<pre>
$args = array(
	'post_type' => array( 'post', 'page', 'movie', 'book' )
);
$query = new WP_Query( $args );
</pre>

===Status Parameters===

Show posts associated with certain [[Post Status|status]].

* '''<tt>post_status</tt>''' (''string'' / ''array'') - use post status. Retrieves posts by [[Post Status]]. Default value is '<tt>publish</tt>', but if the user is logged in, '<tt>private</tt>' is added. Public [[Post_Status#Custom_Status|custom statuses]] are also included by default. And if the query is run in an admin context (administration area or AJAX call), protected statuses are added too. By default protected statuses are '<tt>future</tt>', '<tt>draft</tt>' and '<tt>pending</tt>'. 
** '<tt>publish</tt>' - a published post or page.
** '<tt>pending</tt>' - post is pending review.
** '<tt>draft</tt>' - a post in draft status.
** '<tt>auto-draft</tt>' - a newly created post, with no content.
** '<tt>future</tt>' - a post to publish in the future.
** '<tt>private</tt>' - not visible to users who are not logged in.
** '<tt>inherit</tt>' - a revision. see [[Function_Reference/get_children|get_children]].
** '<tt>trash</tt>' - post is in trashbin (available since [[Version 2.9]]).
** '<tt>any</tt>' - retrieves any status except those from post statuses with 'exclude_from_search' set to true (i.e. trash and auto-draft).

'''Show Post by Status'''

Display only drafts:

 $query = new WP_Query( array( 'post_status' => 'draft' ) );

Display multiple post status:

<pre>
$args = array(
	'post_status' => array( 'pending', 'draft', 'future' )
);
$query = new WP_Query( $args );
</pre>

Display all attachments:

<pre>
$args = array(
	'post_status' => 'any',
	'post_type'   => 'attachment'
);
$query = new WP_Query( $args );
</pre>


===Comment Parameters===

@since [[Version 4.9]] Introduced the `$comment_count` parameter.

* '''<tt>comment_count</tt>''' (''int'') - The amount of comments your CPT has to have ( Search operator will do a '=' operation )
* '''<tt>comment_count</tt>''' (''array'') - 
** '''<tt>value</tt>''' (''int'') - The amount of comments your CPT has to have when comparing
** '''<tt>compare</tt>''' (''string'') - The search operator. Possible values are '=', '!=', '>', '>=', '<', '<='.  Default value is '='.


'''Simple Comment count Query:'''

Display '''posts''' with with '''20''' comments:

<pre>
$args = array(
	'post_type' => 'post',
	'comment_count' => 20,
	)
);
$query = new WP_Query( $args );
</pre>


'''Advanced Comment count Query:'''

Display '''posts''' with at least '''25''' comments:

<pre>
$args = array(
	'post_type' => 'post',
	'comment_count' => array(
		'value' => 25,
		'compare' => '>=',
	)
);
$query = new WP_Query( $args );
</pre>

===Pagination Parameters===

* '''<tt>nopaging</tt>''' (''boolean'') - show all posts or use pagination. Default value is 'false', use paging.
* '''<tt>posts_per_page</tt>''' (''int'') - number of post to show per page (available since [[Version 2.1]], replaced '''<tt>showposts</tt>''' parameter). Use <tt>'posts_per_page'=>-1</tt> to show all posts (the <tt>'offset'</tt> parameter is ignored with a <tt>-1</tt> value). Set the '[[#set-paged|paged]]' parameter if pagination is off after using this parameter. ''Note'': if the query is in a feed, wordpress overwrites this parameter with the stored 'posts_per_rss' option. To reimpose the limit, try using the 'post_limits' filter, or filter 'pre_option_posts_per_rss' and return -1
* '''<tt>posts_per_archive_page</tt>''' (''int'') - number of posts to show per page - on archive pages only. Over-rides '''<tt>posts_per_page</tt>''' and '''<tt>showposts</tt>''' on pages where <tt>[[Function_Reference/is_archive|is_archive()]]</tt> or <tt>[[Function_Reference/is_search|is_search()]]</tt> would be true.
* '''<tt>offset</tt>''' (''int'') - number of post to ''displace'' or pass over. ''Warning'': Setting the offset parameter overrides/ignores the paged parameter and breaks pagination ([[Making_Custom_Queries_using_Offset_and_Pagination|Click here for a workaround]]). The <tt>'offset'</tt> parameter is ignored when <tt>'posts_per_page'=>-1</tt> (show all posts) is used.
* '''<tt>paged</tt>''' (''int'') - number of page. Show the posts that would normally show up just on page X when using the "Older Entries" link.
* '''<tt>page</tt>''' (''int'') - number of page for a [[Creating_a_Static_Front_Page|static front page]]. Show the posts that would normally show up just on page X of a Static Front Page.
* '''<tt>ignore_sticky_posts</tt>''' (''boolean'') - ignore post stickiness (available since [[Version 3.1]], replaced '''<tt>caller_get_posts</tt>''' parameter). <tt>false</tt> (default): move sticky posts to the start of the set. <tt>true</tt>: do not move sticky posts to the start of the set.


'''Show x Posts per page'''

 $query = new WP_Query( array( 'posts_per_page' => 3 ) );     // Display 3 posts per page

 $query = new WP_Query( array( 'posts_per_page' => -1 ) );    // Display all posts in one page

Display all posts by disabling pagination:

 $query = new WP_Query( array( 'nopaging' => true ) );

'''Pass over Posts'''

Display posts from the 4th one:

 $query = new WP_Query( array( 'offset' => 3 ) );

Display 5 posts per page which follow the 3 most recent posts:

 $query = new WP_Query( array( 'posts_per_page' => 5, 'offset' => 3 ) );

'''Show Posts from page x'''

 $query = new WP_Query( array( 'paged' => 6 ) );   // page number 6

'''Show Posts from Current Page'''

 $query = new WP_Query( array( 'paged' => get_query_var( 'paged' ) ) );

<span id="set-paged">Display posts from the current page and set the 'paged' parameter to 1 when the query variable is not set (first page).</span>

 $paged = ( get_query_var('paged') ) ? get_query_var('paged') : 1;
 $query = new WP_Query( array( 'paged' => $paged ) );

Pagination Note: Use <tt>get_query_var('page');</tt> if you want your query to work in a [[Pages#Page_Templates|Page template]] that you've set as your [[Creating_a_Static_Front_Page|static front page]].  The query variable 'page' also holds the pagenumber for a single paginated Post or Page that includes the <code>&lt;!--nextpage--&gt;</code> [[Write_Post_SubPanel#Quicktags | Quicktag]] in the post content.

Display posts from current page on a [[Creating_a_Static_Front_Page|static front page]]:
 $paged = ( get_query_var('page') ) ? get_query_var('page') : 1;
 $query = new WP_Query( array( 'paged' => $paged ) );

'''Show Sticky Posts'''


Display just the first sticky post:

 $sticky = get_option( 'sticky_posts' );
 $query = new WP_Query( array( 'p' => $sticky[0] ) );

Display just the first sticky post, if none return the last post published:

<pre>
$sticky = get_option( 'sticky_posts' );
$args = array(
	'posts_per_page'      => 1,
	'post__in'            => $sticky,
	'ignore_sticky_posts' => 1,
);
$query = new WP_Query( $args );
</pre>

Display just the first sticky post,  add this line to above block:
<pre>
if ( $sticky[0] ) {
	// insert here your stuff...
}
</pre>

'''Don't Show Sticky Posts'''

Exclude all sticky posts from the query:

 $query = new WP_Query( array( 'post__not_in' => get_option( 'sticky_posts' ) ) );

Return ALL posts within the category, but don't show ("ignore") sticky posts at the top (They will still show in their natural position, e.g. by date):

 $query = new WP_Query( array( 'ignore_sticky_posts' => 1, 'posts_per_page' => 3, 'cat' => 6 );

Exclude sticky posts from a category. Return posts within the category, but exclude sticky posts completely, and adhere to paging rules:

<pre>
$paged = get_query_var( 'paged' ) ? get_query_var( 'paged' ) : 1;
$sticky = get_option( 'sticky_posts' );
$args = array(
	'cat'                 => 3,
	'ignore_sticky_posts' => 1,
	'post__not_in'        => $sticky,
	'paged'               => $paged,
);
$query = new WP_Query( $args );
</pre>

===Order & Orderby Parameters===

Sort retrieved posts.

* '''<tt>order</tt>''' (''string | array'') - Designates the ascending or descending order of the '<tt>orderby</tt>' parameter.  Defaults to 'DESC'. An array can be used for multiple order/orderby sets.
** '<tt>ASC</tt>' - ascending order from lowest to highest values (1, 2, 3; a, b, c).
** '<tt>DESC</tt>' - descending order from highest to lowest values (3, 2, 1; c, b, a).

* '''<tt>orderby</tt>''' (''string | array'') - Sort retrieved posts by parameter.  Defaults to 'date (post_date)'. One or more options can be passed.
** '<tt>none</tt>' - No order (available since [[Version 2.8]]).
** '<tt>ID</tt>' - Order by post id.  Note the capitalization.
** '<tt>author</tt>' - Order by author.  ('<tt>post_author</tt>' is also accepted.)
** '<tt>title</tt>' - Order by title.  ('<tt>post_title</tt>' is also accepted.)
** '<tt>name</tt>' - Order by post name (post slug).  ('<tt>post_name</tt>' is also accepted.)
** '<tt>type</tt>' - Order by [[post type]] (available since [[Version 4.0]]).  ('<tt>post_type</tt>' is also accepted.)
** '<tt>date</tt>' - Order by date.  ('<tt>post_date</tt>' is also accepted.)
** '<tt>modified</tt>' - Order by last modified date.  ('<tt>post_modified</tt>' is also accepted.)
** '<tt>parent</tt>' - Order by post/page parent id.  ('<tt>post_parent</tt>' is also accepted.)
** '<tt>rand</tt>' - Random order.  You can also use '<tt>RAND(x)</tt>' where '<tt>x</tt>' is an integer seed value. Note an "order" parameter needs to be present for "orderby" rand to work.
** '<tt>comment_count</tt>' - Order by number of comments (available since [[Version 2.9]]).
** '<tt>relevance</tt>' - Order by search terms in the following order: First, whether the entire sentence is matched. Second, if all the search terms are within the titles. Third, if any of the search terms appear in the titles. And, fourth, if the full sentence appears in the contents.
** '<tt>menu_order</tt>' - Order by  Page Order. Used most often for [[Pages]] (''Order'' field in the Edit Page Attributes box) and for [[Attachments]] (the integer fields in the Insert / Upload Media Gallery dialog), but could be used for any post type with distinct '<tt>menu_order</tt>' values (they all default to <var>0</var>).
** '<tt>meta_value</tt>' - Note that a '<tt>meta_key=keyname</tt>' must also be present in the query. Note also that the sorting will be alphabetical which is fine for strings (i.e. words), but can be unexpected for numbers (e.g. 1, 3, 34, 4, 56, 6, etc, rather than 1, 3, 4, 6, 34, 56 as you might naturally expect). Use '<tt>meta_value_num</tt>' instead for numeric values. You may also specify '<tt>meta_type</tt>' if you want to cast the meta value as a specific type. Possible values are 'NUMERIC', 'BINARY', 'CHAR', 'DATE', 'DATETIME', 'DECIMAL', 'SIGNED', 'TIME', 'UNSIGNED', same as in '<tt>$meta_query</tt>'. When using '<tt>meta_type</tt>' you can also use '<tt>meta_value_*</tt>' accordingly. For example, when using DATETIME as '<tt>meta_type</tt>' you can use '<tt>meta_value_datetime</tt>' to define order structure.
** '<tt>meta_value_num</tt>' - Order by numeric meta value (available since [[Version 2.8]]). Also note that a '<tt>meta_key=keyname</tt>' must also be present in the query. This value allows for numerical sorting as noted above in '<tt>meta_value</tt>'.
** '<tt>post__in</tt>' - Preserve post ID order given in the '<tt>post__in</tt>' array (available since [[Version 3.5]]).  '''Note''' - the value of the <tt>order</tt> parameter does not change the resulting sort order.
** '<tt>post_name__in</tt>' - Preserve post slug order given in the '<tt>post_name__in</tt>' array (available since [[Version 4.6]]).  '''Note''' - the value of the <tt>order</tt> parameter does not change the resulting sort order.
** '<tt>post_parent__in</tt>' - Preserve post parent order given in the '<tt>post_parent__in</tt>' array (available since [[Version 4.6]]).  '''Note''' - the value of the <tt>order</tt> parameter does not change the resulting sort order.

'''Show Posts sorted by Title, Descending order'''

Display posts sorted by post 'title' in a descending order:

<pre>
$args = array(
	'orderby' => 'title',
	'order'   => 'DESC',
);
$query = new WP_Query( $args );
</pre>

Display posts sorted by 'menu_order' with a fallback to post 'title', in a descending order:

<pre>
$args = array(
	'orderby' => 'menu_order title',
	'order'   => 'DESC',
);
$query = new WP_Query( $args );
</pre>

'''Show Random Post'''

Display one random post:

<pre>
$args = array(
	'orderby'        => 'rand',
	'posts_per_page' => 1,

);
$query = new WP_Query( $args );
</pre>

'''Show Popular Posts'''

Display posts ordered by comment count:

<pre>
$args = array(
	'orderby' => 'comment_count'
);
$query = new WP_Query( $args );
</pre>

'''Show Products sorted by Price'''

Display posts with 'Product' type ordered by 'Price' custom field:

<pre>
$args = array(
	'post_type' => 'product',
	'orderby'   => 'meta_value_num',
	'meta_key'  => 'price',
);
$query = new WP_Query( $args );
</pre>

'''Multiple 'orderby' values'''

Display pages ordered by 'title' and 'menu_order'. (title is dominant):

<pre>
$args = array(
	'post_type' => 'page',
	'orderby'   => 'title menu_order',
	'order'     => 'ASC',
);
$query = new WP_Query( $args );
</pre>

'''Multiple 'orderby' values using an array'''

Display pages ordered by 'title' and 'menu_order' with different sort orders (ASC/DESC) (available since [[Version 4.0]]):

<pre>
$args = array(
	'orderby' => array( 'title' => 'DESC', 'menu_order' => 'ASC' )
);
$query = new WP_Query( $args );
</pre>

*[http://make.wordpress.org/core/2014/08/29/a-more-powerful-order-by-in-wordpress-4-0/ A more powerful ORDER BY in WordPress 4.0]

'''Mulitiple orderby/order pairs'''

<pre>
$args = array(
	'orderby'  => array( 'meta_value_num' => 'DESC', 'title' => 'ASC' ),
	'meta_key' => 'age'
);
$query = new WP_Query( $args );
</pre>

''''orderby' with 'meta_value' and custom post type'''

Display posts of type 'my_custom_post_type', ordered by 'age', and filtered to show only ages 3 and 4 (using meta_query).

<pre>
$args = array(
	'post_type'  => 'my_custom_post_type',
	'meta_key'   => 'age',
	'orderby'    => 'meta_value_num',
	'order'      => 'ASC',
	'meta_query' => array(
		array(
			'key'     => 'age',
			'value'   => array( 3, 4 ),
			'compare' => 'IN',
		),
	),
);
$query = new WP_Query( $args );
</pre>


''''orderby' with multiple 'meta_key's'''

If you wish to order by two different pieces of postmeta (for example, City first and State second), you need to combine and link your meta query to your orderby array using 'named meta queries'. See the example below:

<pre>
$q = new WP_Query( array(
    'meta_query' => array(
        'relation' => 'AND',
        'state_clause' => array(
            'key' => 'state',
            'value' => 'Wisconsin',
        ),
        'city_clause' => array(
            'key' => 'city',
            'compare' => 'EXISTS',
        ), 
    ),
    'orderby' => array( 
        'city_clause' => 'ASC',
        'state_clause' => 'DESC',
    ),
) );
</pre>

Props cybmeta on WPSE for [http://wordpress.stackexchange.com/a/246358/3687 this example].

===Date Parameters===

Show posts associated with a certain time and date period.

* '''<tt>year</tt>''' (''int'') - 4 digit year (e.g. 2011).
* '''<tt>monthnum</tt>''' (''int'') - Month number (from 1 to 12).
* '''<tt>w</tt>''' (''int'') - Week of the year (from 0 to 53). Uses [http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_week MySQL WEEK command]. The mode is dependent on the "start_of_week" option.
* '''<tt>day</tt>''' (''int'') - Day of the month (from 1 to 31).
* '''<tt>hour</tt>''' (''int'') - Hour (from 0 to 23).
* '''<tt>minute</tt>''' (''int'') - Minute (from 0 to 60).
* '''<tt>second</tt>''' (''int'') - Second (0 to 60).
* '''<tt>m</tt>''' (''int'') - YearMonth (For e.g.: '''<tt>201307</tt>''').

* '''<tt>date_query</tt>''' (''array'') - Date parameters (available since [[Version 3.7]]).
** '''<tt>year</tt>''' (''int'') - 4 digit year (e.g. 2011).
** '''<tt>month</tt>''' (''int'') - Month number (from 1 to 12).
** '''<tt>week</tt>''' (''int'') - Week of the year (from 0 to 53).
** '''<tt>day</tt>''' (''int'') - Day of the month (from 1 to 31).
** '''<tt>hour</tt>''' (''int'') - Hour (from 0 to 23).
** '''<tt>minute</tt>''' (''int'') - Minute (from 0 to 59).
** '''<tt>second</tt>''' (''int'') - Second (0 to 59).
** '''<tt>after</tt>''' (''string/array'') - Date to retrieve posts after. Accepts <tt>[http://php.net/strtotime strtotime()]</tt>-compatible string, or array of 'year', 'month', 'day' values:
*** '''<tt>year</tt>''' (''string'') Accepts any four-digit year. Default is empty.
*** '''<tt>month</tt>''' (''string'') The month of the year. Accepts numbers 1-12. Default: 12.
*** '''<tt>day</tt>''' (''string'') The day of the month. Accepts numbers 1-31. Default: last day of month.
** '''<tt>before</tt>''' (''string/array'') - Date to retrieve posts before. Accepts <tt>[http://php.net/strtotime strtotime()]</tt>-compatible string, or array of 'year', 'month', 'day' values:
*** '''<tt>year</tt>''' (''string'') Accepts any four-digit year. Default is empty.
*** '''<tt>month</tt>''' (''string'') The month of the year. Accepts numbers 1-12. Default: 1.
*** '''<tt>day</tt>''' (''string'') The day of the month. Accepts numbers 1-31. Default: 1.
** '''<tt>inclusive</tt>''' (''boolean'') - For after/before, whether exact value should be matched or not'.
** '''<tt>compare</tt>''' (''string'') - See WP_Date_Query::get_compare().
** '''<tt>column</tt>''' (''string'') - [[Database_Description#Table:_wp_posts|Column]] to query against. Default: 'post_date'.
** '''<tt>relation</tt>''' (''string'') -  OR or AND, how the sub-arrays should be compared. Default: AND.

'''Returns posts dated December 12, 2012:'''

<pre>
$query = new WP_Query( 'year=2012&monthnum=12&day=12' );
</pre>

or:

<pre>
$args = array(
	'date_query' => array(
		array(
			'year'  => 2012,
			'month' => 12,
			'day'   => 12,
		),
	),
);
$query = new WP_Query( $args );
</pre>

'''Returns posts for today:'''

<pre>
$today = getdate();
$query = new WP_Query( 'year=' . $today['year'] . '&monthnum=' . $today['mon'] . '&day=' . $today['mday'] );
</pre>

or:

<pre>
$today = getdate();
$args = array(
	'date_query' => array(
		array(
			'year'  => $today['year'],
			'month' => $today['mon'],
			'day'   => $today['mday'],
		),
	),
);
$query = new WP_Query( $args );
</pre>

'''Returns posts for this week:'''

<pre>
$week = date( 'W' );
$year = date( 'Y' );
$query = new WP_Query( 'year=' . $year . '&w=' . $week );
</pre>

or:

<pre>
$args = array(
	'date_query' => array(
		array(
			'year' => date( 'Y' ),
			'week' => date( 'W' ),
		),
	),
);
$query = new WP_Query( $args );
</pre>

'''Return posts between 9AM to 5PM on weekdays'''
<pre>
$args = array(
	'date_query' => array(
		array(
			'hour'      => 9,
			'compare'   => '>=',
		),
		array(
			'hour'      => 17,
			'compare'   => '<=',
		),
		array(
			'dayofweek' => array( 2, 6 ),
			'compare'   => 'BETWEEN',
		),
	),
	'posts_per_page' => -1,
);
$query = new WP_Query( $args );
</pre>

'''Return posts from January 1st to February 28th'''
<pre>
$args = array(
	'date_query' => array(
		array(
			'after'     => 'January 1st, 2013',
			'before'    => array(
				'year'  => 2013,
				'month' => 2,
				'day'   => 28,
			),
			'inclusive' => true,
		),
	),
	'posts_per_page' => -1,
);
$query = new WP_Query( $args );
</pre>

Note that if a <tt>[http://php.net/strtotime strtotime()]</tt>-compatible string with just a date was passed in the <tt>before</tt> parameter, this will be converted to 00:00:00 on that date.  In this case, even if <tt>inclusive</tt> was set to true, the date would not be included in the query. If you want a before date to be inclusive, include the time as well, such as <tt>'before' => '2013-02-28 23:59:59'</tt>, or use the array format, which is adjusted automatically if <tt>inclusive</tt> is set.

'''Return posts made over a year ago but modified in the past month'''
<pre>
$args = array(
	'date_query' => array(
		array(
			'column' => 'post_date_gmt',
			'before' => '1 year ago',
		),
		array(
			'column' => 'post_modified_gmt',
			'after'  => '1 month ago',
		),
	),
	'posts_per_page' => -1,
);
$query = new WP_Query( $args );
</pre>

The <tt>'date_query'</tt> clauses can be nested, in order to construct complex queries. See [[#Taxonomy Parameters]] for details on the syntax.

===Custom Field Parameters===

Show posts associated with a certain custom field.

This part of the query is parsed by <tt>[[Class_Reference/WP_Meta_Query | WP_Meta_Query]]</tt>, so check [[Class_Reference/WP_Meta_Query#Accepted_Arguments |the docs for it]] as well in case this list of arguments isn't up to date.

* '''<tt>meta_key</tt>''' (''string'') - Custom field key.
* '''<tt>meta_value</tt>''' (''string'') - Custom field value.
* '''<tt>meta_value_num</tt>''' (''number'') - Custom field value.
* '''<tt>meta_compare</tt>''' (''string'') - Operator to test the '<tt>meta_value</tt>'. Possible values are '=', '!=', '>', '>=', '<', '<=', 'LIKE', 'NOT LIKE', 'IN', 'NOT IN', 'BETWEEN', 'NOT BETWEEN', 'NOT EXISTS', 'REGEXP', 'NOT REGEXP' or 'RLIKE'. Default value is '='.

* '''<tt>meta_query</tt>''' (''array'') - Custom field parameters (available since [[Version 3.1]]).
** '''<tt>relation</tt>''' (''string'') - The logical relationship between each inner meta_query array when there is more than one. Possible values are 'AND', 'OR'. Do not use with a single inner meta_query array.

<tt>meta_query</tt> also contains one or more arrays with the following keys:

* '''<tt>key</tt>''' (''string'') - Custom field key.
* '''<tt>value</tt>''' (''string''|''array'') - Custom field value. It can be an array only when <tt>'''compare'''</tt> is <tt>'IN'</tt>, <tt>'NOT IN'</tt>, <tt>'BETWEEN'</tt>, or <tt>'NOT BETWEEN'</tt>. You don't have to specify a value when using the <tt>'EXISTS'</tt> or <tt>'NOT EXISTS'</tt> comparisons in WordPress 3.9 and up. <br>(<strong>Note:</strong> Due to [http://core.trac.wordpress.org/ticket/23268 bug #23268], <tt>value</tt> is required for <tt>NOT EXISTS</tt> comparisons to work correctly <strong>prior to 3.9</strong>. You must supply ''some'' string for the <tt>value</tt> parameter. An empty string or NULL will NOT work. However, any other string will do the trick and will NOT show up in your SQL when using <tt>NOT EXISTS</tt>. Need inspiration? How about <tt>'bug #23268'</tt>.)
* '''<tt>compare</tt>''' (''string'') - Operator to test. Possible values are '=', '!=', '>', '>=', '<', '<=', 'LIKE', 'NOT LIKE', 'IN', 'NOT IN', 'BETWEEN', 'NOT BETWEEN', 'EXISTS' and 'NOT EXISTS'. Default value is '='.
* '''<tt>type</tt>''' (''string'') - Custom field type. Possible values are 'NUMERIC', 'BINARY', 'CHAR', 'DATE', 'DATETIME', 'DECIMAL', 'SIGNED', 'TIME', 'UNSIGNED'. Default value is 'CHAR'. You can also specify precision and scale for the 'DECIMAL' and 'NUMERIC' types (for example, 'DECIMAL(10,5)' or 'NUMERIC(10)' are valid).

The 'type' DATE works with the 'compare' value BETWEEN only if the date is stored at the format YYYY-MM-DD and tested with this format.

'''Important Note:''' <tt>meta_query</tt> takes an '''array''' of meta query arguments '''arrays''' (it takes an array of arrays) - you can see this in the examples below.
This construct allows you to query multiple metadatas by using the '''<tt>relation</tt>''' parameter in the first (outer) array to describe the boolean relationship between the meta queries. Accepted arguments are 'AND', 'OR'. The default is 'AND'.

'''Simple Custom Field Query:'''

Display posts where the custom field key is 'color', regardless of the custom field value:

 $query = new WP_Query( array( 'meta_key' => 'color' ) );

Display posts where the custom field value is 'blue', regardless of the custom field key:

 $query = new WP_Query( array( 'meta_value' => 'blue' ) );

Display [[Pages|Page]] where the custom field value is 'blue', regardless of the custom field key:

<pre>
$args = array(
	'meta_value' => 'blue',
	'post_type'  => 'page'
);
$query = new WP_Query( $args );
</pre>

Display posts where the custom field key is 'color' and the custom field value is 'blue':

<pre>
$args = array(
	'meta_key'   => 'color',
	'meta_value' => 'blue'
);
$query = new WP_Query( $args );
</pre>

Display posts where the custom field key is 'color' and the custom field value IS NOT 'blue':

<pre>
$args = array(
	'meta_key'     => 'color',
	'meta_value'   => 'blue',
	'meta_compare' => '!='
);
$query = new WP_Query( $args );
</pre>

Display posts where the custom field value is a number. Displays only posts where that number is less than 10.
(<tt>WP_Query</tt> uses this equation to compare: <tt>$post_meta . $args['meta_compare'] . $args['meta_value']</tt>, where <tt>'$post_meta'</tt> is the value of the custom post meta stored in each post; the actual equation with the values filled in: <tt>$post_meta < 10</tt>)

<pre>
$args = array(
	'post_type' => 'post',
	'meta_key' => 'number',
	'meta_value_num' => 10,
	'meta_compare' => '<',
);
$query = new WP_Query( $args );
</pre>

Display posts where the custom field key is a set date and the custom field value is now. Displays only posts which date has not passed.

<pre>
$args = array(
	'post_type'    => 'event',
	'meta_key'     => 'event_date',
	'meta_value'   => date( "Ymd" ), // change to how "event date" is stored
	'meta_compare' => '>',
);
$query = new WP_Query( $args );
</pre>

Display 'product'(s) where the custom field key is 'price' and the custom field value that is LESS THAN OR EQUAL TO 22.<br />''By using the 'meta_value' parameter the value 99 will be considered greater than 100 as the data are stored as 'strings', not 'numbers'. For number comparison use 'meta_value_num'.''

<pre>
$args = array(
	'meta_key'     => 'price',
	'meta_value'   => '22',
	'meta_compare' => '<=',
	'post_type'    => 'product'
);
$query = new WP_Query( $args );
</pre>

Display posts with a custom field value of zero (0), regardless of the custom field key:

<pre>
$args = array(
	'meta_value' => '_wp_zero_value'
);
$query = new WP_Query( $args );
</pre>

'''Single Custom Field Handling:'''

Display posts from a single custom field:

<pre>
$args = array(
	'post_type'  => 'product',
	'meta_query' => array(
		array(
			'key'     => 'color',
			'value'   => 'blue',
			'compare' => 'NOT LIKE',
		),
	),
);
$query = new WP_Query( $args );
</pre>

(Note that meta_query expects nested arrays, even if you only have one query.)

'''Multiple Custom Field Handling:'''

Display posts that have meta key 'color' NOT LIKE value 'blue' OR meta key 'price' with values BETWEEN 20 and 100:

<pre>
$args = array(
	'post_type'  => 'product',
	'meta_query' => array(
		'relation' => 'OR',
		array(
			'key'     => 'color',
			'value'   => 'blue',
			'compare' => 'NOT LIKE',
		),
		array(
			'key'     => 'price',
			'value'   => array( 20, 100 ),
			'type'    => 'numeric',
			'compare' => 'BETWEEN',
		),
	),
);
$query = new WP_Query( $args );
</pre>

The <tt>'meta_query'</tt> clauses can be nested in order to construct complex queries. For example, show products where '''color=orange''' OR '''color=red&size=small''' translates to the following:

<pre>
$args = array(
	'post_type'  => 'product',
	'meta_query' => array(
		'relation' => 'OR',
		array(
			'key'     => 'color',
			'value'   => 'orange',
			'compare' => '=',
		),
                array(
                        'relation' => 'AND',
                        array(
                                'key' => 'color',
                                'value' => 'red',
                                'compare' => '=',
                        ),
                        array(
                                'key' => 'size',
                                'value' => 'small',
                                'compare' => '=',
                        ),
		),
	),
);
$query = new WP_Query( $args );
</pre>

===Permission Parameters===

* '''<tt>perm</tt>''' (''string'') - User permission.

'''Show posts if user has the appropriate capability:'''

Display published and private posts, if the user has the appropriate capability:

<pre>
$args = array(
	'post_status' => array( 'publish', 'private' ),
	'perm'        => 'readable',
);
$query = new WP_Query( $args );
</pre>

===Mime Type Parameters===

Used with the attachments post type.
* '''<tt>post_mime_type</tt>''' (''string/array'') - Allowed mime types.

'''Get attachments that are ''gif'' images:'''

Get gif images and remember that by default the attachment's post_status is set to '''inherit'''.

<pre>
$args = array(
	'post_type'	 => 'attachment',
	'post_status'	 => 'inherit',
	'post_mime_type' => 'image/gif',
);
$query = new WP_Query( $args );
</pre>

'''Get attachments that are not images:'''

To exclude certain mime types you first need to get all mime types using [https://codex.wordpress.org/Function_Reference/get_allowed_mime_types get_allowed_mime_types()] and run a difference between arrays of what you want and the allowed mime types with [http://php.net/manual/en/function.array-diff.php array_diff()].

<pre>
$unsupported_mimes  = array( 'image/jpeg', 'image/gif', 'image/png', 'image/bmp', 'image/tiff', 'image/x-icon' );
$all_mimes          = get_allowed_mime_types();
$accepted_mimes     = array_diff( $all_mimes, $unsupported_mimes );
$args		    = array(
    'post_type'         => 'attachment',
    'post_status'       => 'inherit',
    'post_mime_type'    => $accepted_mimes,
);
$query		    = new WP_Query( $query_args );
</pre>

===Caching Parameters===

Stop the data retrieved from being added to the cache.

* '''<tt>cache_results</tt>''' (''boolean'') - Post information cache.
* '''<tt>update_post_meta_cache</tt>''' (''boolean'') - Post meta information cache.
* '''<tt>update_post_term_cache</tt>''' (''boolean'') - Post term information cache.

'''Show Posts without adding post information to the cache'''

Display 50 posts, but don't add post information to the cache:

<pre>
$args = array(
	'posts_per_page' => 50,
	'cache_results'  => false
);
$query = new WP_Query( $args );
</pre>

'''Show Posts without adding post meta information to the cache'''

Display 50 posts, but don't add post meta information to the cache:

<pre>
$args = array(
	'posts_per_page'         => 50,
	'update_post_meta_cache' => false
);
$query = new WP_Query( $args );
</pre>

'''Show Posts without adding post term information to the cache'''

Display 50 posts, but don't add post term information to the cache:

<pre>
$args = array(
	'posts_per_page'         => 50,
	'update_post_term_cache' => false
);
$query = new WP_Query( $args );
</pre>

In general usage you should not need to use these, adding to the cache is the right thing to do, however they may be useful in specific circumstances.   An example of such circumstances might be when using a WP_Query to retrieve a list of post titles and URLs to be displayed, but in which no other information about the post will be used and the taxonomy and meta data won't be needed. By not loading this information, you can save time from the extra unnecessary SQL queries.

'''Note''': If a persistent object cache backend (such as memcached) is used, these flags are set to false by default since there is no need to update the cache every page load when a persistent cache exists.

===Return Fields Parameter===

Set return values.

* '''<tt>fields</tt>''' (''string'') - Which fields to return. All fields are returned by default. There are two other options:
** '<tt>ids</tt>' - Return an array of post IDs.
** '<tt>id=>parent</tt>' - Return an array of <tt>stdClass</tt> objects with <tt>ID</tt> and <tt>post_parent</tt> properties.
** Passing anything else will return all fields (default) - an array of post objects.

==Filters==

* '''<tt>[[Plugin_API/Filter_Reference/posts_distinct|posts_distinct]]</tt>''' - Alters SQL 'DISTINCTROW' clause to the query that returns the post array.
* '''<tt>[[Plugin_API/Filter_Reference/posts_groupby|posts_groupby]]</tt>''' - Alters SQL 'GROUP BY' clause of the query that returns the post array.
* '''<tt>[[Plugin_API/Filter_Reference/posts_join|posts_join]]</tt>''' - Alters SQL 'JOIN' clause of the query that returns the post array.
* '''<tt>[[Plugin_API/Filter_Reference/post_limits|post_limits]]</tt>''' - Alters SQL 'LIMIT' clause of the query that returns the post array.
* '''<tt>[[Plugin_API/Filter_Reference/posts_orderby|posts_orderby]]</tt>''' - Alters SQL 'ORDER BY' clause of the query that returns the post array.
* '''<tt>[[Plugin_API/Filter_Reference/posts_where|posts_where]]</tt>''' - Alters SQL 'WHERE' clause of the query that returns the post array.
* '''<tt>[[Plugin_API/Filter_Reference/posts_join_paged|posts_join_paged]]</tt>''' - Alters SQL paging for posts using 'JOIN' clause of the query that returns the post array.
* '''<tt>[[Plugin_API/Filter_Reference/posts_where_paged|posts_where_paged]]</tt>''' - Alters SQL paging for posts using 'WHERE' clause of the query that returns the post array.
* '''posts_fields''' - Alters SQL 'SELECT' clause of the query that returns the post array.
* '''<tt>[[Plugin_API/Filter_Reference/posts_clauses|posts_clauses]]</tt>''' - Alters ''all'' the SQL clauses above in one go. It gives you an array of elements that are easy to alter (available with [[Version 3.1]]).

Note, that there are more filters than the mentioned. As it is hard to keep the codex up to date, please inspect the <code>get_posts()</code> method inside the <code>WP_Query</code> class yourself ({{Trac|wp-includes/class-wp-query.php}}).

== Change Log ==
* [[Version 4.9|4.9.0]]:
** Introduced the `$comment_count` parameter.
* [[Version 4.6|4.6.0]]:
** Add filter '<tt>posts_pre_query</tt>' to filter the posts array before the query takes place.
** Add '<tt>post_name__in</tt>' to '<tt>$orderby</tt>'.
* [[Version 4.5|4.5.0]]:
** Removed the '<tt>$comments_popup</tt>' property.

* [[Version 4.4|4.4.0]]:
** Add filter '<tt>old_slug_redirect_url</tt>' to filter the old slug redirect URL.
** Add the ability to pass a post ID to '<tt>$post</tt>' parameter of '<tt>setup_postdata</tt>' method and function.
** Introduced '<tt>$post_name__in</tt>' and '<tt>$title</tt>' parameters. 
** '<tt>$s</tt>' was updated to support excluded search terms, by prepending a hyphen.

* [[Version 4.1|4.1.0]]:
** Add '<tt>$this</tt>' parameter to '<tt>the_post</tt>' action (The current Query object (passed by reference)).

==Source File==

<tt>WP_Query()</tt> is located in {{Trac|wp-includes/class-wp-query.php}}.

==External Resources==
* [http://generatewp.com/wp_query/ WordPress WP_Query Generator]
* [http://thereforei.am/2011/10/28/advanced-taxonomy-queries-with-pretty-urls/ Advanced Taxonomy Queries with Pretty URLs]
* [http://ottopress.com/2010/wordpress-3-1-advanced-taxonomy-queries/ Advanced Taxonomy Queries in WordPress 3.1]
* [http://scribu.net/wordpress/advanced-metadata-queries.html Advanced Metadata Queries in WordPress 3.1]
* [https://gist.github.com/2023628 Comprehensive Argument Reference by Mark Luetke]
* [http://web-profile.net/wordpress/themes/wordpress-custom-loop/ WordPress custom loop]
* [https://premium.wpmudev.org/blog/mastering-wp-query/ An In-Depth Guide to Conquering WP_Query]

== Related ==

{{Query Tags}}

{{Class Footer}}

[[Category:Classes]]
{{Copyedit}}