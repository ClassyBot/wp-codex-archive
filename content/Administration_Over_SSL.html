<p class="LanguageLinks" style="border:1px solid #CCCCCC; line-height:1.5; text-align:left; color:#333333; font-size:90%; padding:10px;"><span style="white-space:nowrap;"><a href="https://codex.wordpress.org/Multilingual_Codex" title="Multilingual Codex" class="mw-redirect">Languages</a>:</span> 
<strong class="selflink">English</strong> • 
<a rel="nofollow" class="external text" href="https://wpdocs.osdn.jp/Administration">Over SSL 日本語</a> 
 <small>(<a href="https://codex.wordpress.org/Multilingual_Codex#Language_Cross_Reference" title="Multilingual Codex" class="mw-redirect">Add your language</a>)</small>
</p>
<p>To easily enable (and enforce) WordPress administration over SSL, there are two constants that you can define in your site's <a href="https://codex.wordpress.org/Editing_wp-config.php" title="Editing wp-config.php">wp-config.php</a> file. It is not sufficient to define these constants in a plugin file; they must be defined in your <a href="https://codex.wordpress.org/Editing_wp-config.php" title="Editing wp-config.php">wp-config.php</a> file. You must also already have SSL configured on the server and a (virtual) host configured for the secure server before your site will work properly with these constants set to true.
</p><p><b>Note:</b> FORCE_SSL_LOGIN was deprecated in <a href="https://codex.wordpress.org/Version_4.0" title="Version 4.0">Version 4.0</a>. Please use FORCE_SSL_ADMIN.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#To_Force_SSL_Logins_and_SSL_Admin_Access"><span class="tocnumber">1</span> <span class="toctext">To Force SSL Logins <i>and</i> SSL Admin Access</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Example"><span class="tocnumber">1.1</span> <span class="toctext">Example</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#Using_a_Reverse_Proxy"><span class="tocnumber">2</span> <span class="toctext">Using a Reverse Proxy</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Example_2"><span class="tocnumber">2.1</span> <span class="toctext">Example</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Further_Information"><span class="tocnumber">3</span> <span class="toctext">Further Information</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Virtual_Hosts"><span class="tocnumber">3.1</span> <span class="toctext">Virtual Hosts</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="#Rewrite_Rules_For_The_Insecure_Host"><span class="tocnumber">3.1.1</span> <span class="toctext">Rewrite Rules For The Insecure Host</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Rewrite_Rules_For_Secure_Host_.28Optional.29"><span class="tocnumber">3.1.2</span> <span class="toctext">Rewrite Rules For Secure Host (Optional)</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#Setting_WordPress_URI"><span class="tocnumber">3.1.3</span> <span class="toctext">Setting WordPress URI</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#Example_Config_Stanzas"><span class="tocnumber">3.1.4</span> <span class="toctext">Example Config Stanzas</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#Rewrite_for_Login_and_Registration"><span class="tocnumber">3.1.5</span> <span class="toctext">Rewrite for Login and Registration</span></a>
<ul>
<li class="toclevel-4 tocsection-12"><a href="#Insecure"><span class="tocnumber">3.1.5.1</span> <span class="toctext">Insecure</span></a></li>
<li class="toclevel-4 tocsection-13"><a href="#Secure"><span class="tocnumber">3.1.5.2</span> <span class="toctext">Secure</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-14"><a href="#Rewrite_for_sites_running_on_port_443_or_port_80"><span class="tocnumber">3.1.6</span> <span class="toctext">Rewrite for sites running on port 443 or port 80</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-15"><a href="#Summary"><span class="tocnumber">3.2</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Verification"><span class="tocnumber">3.3</span> <span class="toctext">Verification</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Limitations"><span class="tocnumber">3.4</span> <span class="toctext">Limitations</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-18"><a href="#Related"><span class="tocnumber">4</span> <span class="toctext">Related</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="To_Force_SSL_Logins_and_SSL_Admin_Access">To Force SSL Logins <i>and</i> SSL Admin Access</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Administration_Over_SSL&amp;action=edit&amp;section=1" title="Edit section: To Force SSL Logins and SSL Admin Access">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The constant FORCE_SSL_ADMIN can be set to true in the wp-config.php file to force all logins <b>and</b> all admin sessions to happen over SSL.
</p>
<h3><span class="mw-headline" id="Example">Example</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Administration_Over_SSL&amp;action=edit&amp;section=2" title="Edit section: Example">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<pre>
  define('FORCE_SSL_ADMIN', true);
</pre>
<p>Note: FORCE_SSL_ADMIN should be set before wp-settings.php is required.
</p>
<h2><span class="mw-headline" id="Using_a_Reverse_Proxy">Using a Reverse Proxy</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Administration_Over_SSL&amp;action=edit&amp;section=3" title="Edit section: Using a Reverse Proxy">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>If WordPress is hosted behind a reverse proxy that provides SSL, but is hosted itself without SSL, these options will initially send any requests into an infinite redirect loop. To avoid this, you may configure WordPress to recognize the HTTP_X_FORWARDED_PROTO header (assuming you have properly configured the reverse proxy to set that header).
</p>
<h3><span class="mw-headline" id="Example_2">Example</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Administration_Over_SSL&amp;action=edit&amp;section=4" title="Edit section: Example">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<pre>
define('FORCE_SSL_ADMIN', true);
// in some setups HTTP_X_FORWARDED_PROTO might contain 
// a comma-separated list e.g. http,https
// so check for https existence
if (strpos($_SERVER['HTTP_X_FORWARDED_PROTO'], 'https')&#160;!== false)
       $_SERVER['HTTPS']='on';
</pre>
<p>You can also indicate the following line in the .htaccess file (before anything else)&#160;:
</p>
<pre>
SetEnvIf X-Forwarded-Proto https HTTPS
</pre>
<p>For those who don't exactly know how their hoster configured the server, you can recognize this situation by infinite 302 redirections on the login page, leading to an error message saying that the page is not correctly redirected.
</p>
<h2><span class="mw-headline" id="Further_Information">Further Information</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Administration_Over_SSL&amp;action=edit&amp;section=5" title="Edit section: Further Information">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The rest of this article serves as information in case you're using an older version of WordPress (which ideally you shouldn't!) or your SSL setup is somewhat different (ie. your SSL certificate is for a different domain).
</p><p>Sometimes, you want your whole wp-admin to run over a secure connection using the https protocol.  Conceptually, the procedure works like this:
</p>
<ol><li> Set up two virtual hosts with the same url (the blog url), one secure, the other not.</li>
<li> On the secure virtual host, set up a rewrite rule that shuttles all non-wp-admin traffic to the insecure site.</li>
<li> On the insecure virtual host, set up a rewrite rule that shuttles all traffic to wp-admin to the secure host.</li>
<li> Put in a filter (via a plugin) that filters the links in wp-admin so that once activated, administrative links are rewritten to use https and that edits cookies to work only over encrypted connections.</li></ol>
<p>The following guide is for WordPress 1.5 and Apache running mod_rewrite, using rewrite rules in httpd.conf (as opposed to .htaccess files) but could easily be modified to fit other hosting scenarios.
</p>
<h3><span class="mw-headline" id="Virtual_Hosts">Virtual Hosts</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Administration_Over_SSL&amp;action=edit&amp;section=6" title="Edit section: Virtual Hosts">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>You need a (virtual) host configured for the secure server in addition to the non-secure site.  In this example, the secure virtual host uses the same <code>DocumentRoot</code> as the insecure host.  Hypothetically, you could use a host with a different name, such as wpadmin.mysite.com and link the document root to the wpadmin directory.  
</p><p>Please ask your ISP to set up a secure virtual host for you, or if you have administrative access set up your own.  Note that <a rel="nofollow" class="external text" href="http://httpd.apache.org/docs-2.0/ssl/ssl_faq.html#vhosts2">you cannot use name based virtual hosting to identify different SSL servers</a>.
</p>
<h4><span class="mw-headline" id="Rewrite_Rules_For_The_Insecure_Host">Rewrite Rules For The Insecure Host</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Administration_Over_SSL&amp;action=edit&amp;section=7" title="Edit section: Rewrite Rules For The Insecure Host">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>In the .htaccess or virtual host stanza in httpd.conf for your insecure host, add this rewrite rule to automatically go to the secure host when you browse to http://mysite.com/wp-admin/ or http://mysite.com/wp-login.php
</p><p>This should go above the main wordpress rewrite block.
</p>
<pre>
  RewriteCond&#160;%{THE_REQUEST} ^[A-Z]{3,9}\ /(.*)\ HTTP/ [NC]
  RewriteCond&#160;%{HTTPS}&#160;!=on [NC]
  RewriteRule ^/?(wp-admin/|wp-login\.php) https://mysite.com%{REQUEST_URI}%{QUERY_STRING} [R=301,QSA,L]
</pre>
<p>If you are using permalink rewrite rules, this line must come before <code>RewriteRule ^.*$ - [S=40]</code>.
</p><p>An important idea in this block is using THE_REQUEST, which ensures only actual http requests are rewritten and not local direct file requests, like an include or fopen.
</p>
<h4><span class="mw-headline" id="Rewrite_Rules_For_Secure_Host_.28Optional.29">Rewrite Rules For Secure Host (Optional)</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Administration_Over_SSL&amp;action=edit&amp;section=8" title="Edit section: Rewrite Rules For Secure Host (Optional)">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>These rewrite rules are optional.  They disable access to the public site over a secure connection.  If you wish to remain logged in to the public portion of your site using the plugin below, you must <i>not</i> add these rules, as the plugin disables the cookie over unencrypted connections.
</p><p>The secure virtual host should have two rewrite rules in an .htaccess file or in the virtual host declaration (see <a href="https://codex.wordpress.org/Using_Permalinks" title="Using Permalinks">Using Permalinks</a> for more on rewriting):
</p>
<pre>
   RewriteRule&#160;!^/wp-admin/(.*) - [C]
   RewriteRule ^/(.*) http://www.mysite.com/$1 [QSA,L]
</pre>
<p>The first rule excludes the wp-admin directory from the next rule, which shuffles traffic to the secure site over to the insecure site, to keep things nice and seamless for your audience.
</p>
<h4><span class="mw-headline" id="Setting_WordPress_URI">Setting WordPress URI</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Administration_Over_SSL&amp;action=edit&amp;section=9" title="Edit section: Setting WordPress URI">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>For some plugins to work, and for other reasons, you may wish to set your WordPress URI in options to reflect the https protocol by making this setting https://mysite.com.  Your blog address should not change.
</p>
<h4><span class="mw-headline" id="Example_Config_Stanzas">Example Config Stanzas</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Administration_Over_SSL&amp;action=edit&amp;section=10" title="Edit section: Example Config Stanzas">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>NOTE: The below config is not 100% compatible with WordPress 2.8+, WordPress 2.8 uses some files from the wp-includes folder. The redirection that the first set of Rewrite rules introduces may cause security warnings for some users. See <a rel="nofollow" class="external autonumber" href="http://core.trac.wordpress.org/ticket/10079">[1]</a> for more information.
</p>
<pre>
&lt;VirtualHost nnn.nnn.nnn.nnn:443&gt;
        ServerName www.mysite.com

        SSLEngine On
        SSLCertificateFile    /etc/apache2/ssl/thissite.crt
        SSLCertificateKeyFile /etc/apache2/ssl/thissite.pem
        SetEnvIf User-Agent ".*MSIE.*" nokeepalive ssl-unclean-shutdown

        DocumentRoot /var/www/mysite

        &lt;IfModule mod_rewrite.c&gt;
                RewriteEngine On
                RewriteRule&#160;!^/wp-(admin|includes)/(.*) - [C]
                RewriteRule ^/(.*) http://www.mysite.com/$1 [QSA,L]
        &lt;/IfModule&gt;
        ...
&lt;/VirtualHost&gt;

# Insecure site
&lt;VirtualHost *&gt;
        ServerName www.mysite.com

        DocumentRoot /var/www/ii/mysite

        &lt;Directory /var/www/ii/mysite &gt;
                &lt;IfModule mod_rewrite.c&gt;
                        RewriteEngine On
                        RewriteBase /
                        RewriteCond&#160;%{REQUEST_FILENAME} -f [OR]
                        RewriteCond&#160;%{REQUEST_FILENAME} -d
                        RewriteRule ^wp-admin/(.*) https://www.mysite.com/wp-admin/$1 [C]
                        RewriteRule ^.*$ - [S=40]
                        RewriteRule ^feed/(feed|rdf|rss|rss2|atom)/?$ /index.php?&amp;feed=$1 [QSA,L]
                        ...
                &lt;/IfModule&gt;
         &lt;/Directory&gt;
         ...
&lt;/VirtualHost&gt;</pre>
<h4><span class="mw-headline" id="Rewrite_for_Login_and_Registration">Rewrite for Login and Registration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Administration_Over_SSL&amp;action=edit&amp;section=11" title="Edit section: Rewrite for Login and Registration">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>It is probably a good idea to utilize SSL for user logins and registrations.  Consider the following substitute RewriteRules.
</p>
<h5><span class="mw-headline" id="Insecure">Insecure</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Administration_Over_SSL&amp;action=edit&amp;section=12" title="Edit section: Insecure">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<pre>RewriteRule ^/wp-(admin|login|register)(.*) https://www.mysite.com/wp-$1$2 [C]</pre>
<h5><span class="mw-headline" id="Secure">Secure</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Administration_Over_SSL&amp;action=edit&amp;section=13" title="Edit section: Secure">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<pre>RewriteRule&#160;!^/wp-(admin|login|register)(.*) - [C]</pre>
<h4><span class="mw-headline" id="Rewrite_for_sites_running_on_port_443_or_port_80">Rewrite for sites running on port 443 or port 80</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Administration_Over_SSL&amp;action=edit&amp;section=14" title="Edit section: Rewrite for sites running on port 443 or port 80">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<pre>
# BEGIN WordPress
&lt;IfModule mod_rewrite.c&gt;
RewriteEngine On
RewriteBase /

# For a site running on port 443 or else (http over ssl)
RewriteCond&#160;%{SERVER_PORT} &#160;!^80$
RewriteRule&#160;!^wp-(admin|login|register)(.*) - [C]
RewriteRule ^(.*)$ http://%{SERVER_NAME}/$1 [L]

# For a site running on port 80 (http)
RewriteCond&#160;%{SERVER_PORT}  ^80$
RewriteCond&#160;%{REQUEST_FILENAME} -f [OR]
RewriteCond&#160;%{REQUEST_FILENAME} -d
RewriteRule ^wp-(admin|login|register)(.*) https://%{SERVER_NAME}:10001/wp-$1$2 [L]

RewriteCond&#160;%{SERVER_PORT}  ^80$
RewriteCond&#160;%{REQUEST_FILENAME}&#160;!-f
RewriteCond&#160;%{REQUEST_FILENAME}&#160;!-d
RewriteRule . /index.php [L]

&lt;/IfModule&gt;

</pre>
<h3><span class="mw-headline" id="Summary">Summary</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Administration_Over_SSL&amp;action=edit&amp;section=15" title="Edit section: Summary">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This method does <i>not</i> fix some <a rel="nofollow" class="external text" href="http://wordpress.org/support/topic/24558#post-154136">inherent security risks</a> in WordPress, nor does it protect you against man-in-the-middle attacks or other risks that can cripple secure connections.
</p><p>However, this <i>should</i> make it much harder for a malicious person to steal your cookies and/or authentication headers and use them to impersonate you and gain access to wp-admin.  It also obfuscates the ability to sniff your content, which could be important for legal blogs which may have drafts of documents that need strict protection.
</p>
<h3><span class="mw-headline" id="Verification">Verification</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Administration_Over_SSL&amp;action=edit&amp;section=16" title="Edit section: Verification">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>On the author's server, logs indicate that both GET and POST requests are over SSL and that all traffic to wp-admin on the insecure host is being shuttled over to the secure host.
</p><p>Sample POST log line:
</p>
<pre>
[Thu Apr 28 09:34:33 2005] [info] Subsequent (No.5) HTTPS request received for child 6 (server foo.com:443)
xx.xxx.xxx.xxx - - [28/Apr/2005:09:34:33 -0500] "POST /wp-admin/post.php HTTP/1.1" 302 - "https://foo.com/wp-admin/post.php?acti
on=edit&amp;post=71" "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.7) Gecko/20050414 Firefox/1.0.3"
</pre>
<p>More testing, preferably with a packet sniffer and some hardcore network analysis tools, would help to confirm.
</p>
<h3><span class="mw-headline" id="Limitations">Limitations</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Administration_Over_SSL&amp;action=edit&amp;section=17" title="Edit section: Limitations">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><a rel="nofollow" class="external text" href="https://tools.ietf.org/html/rfc6265">RFC 6265</a> - <i>HTTP State Management Mechanism</i>, addresses the management of cookies. In <a rel="nofollow" class="external text" href="https://tools.ietf.org/html/rfc6265#section-8.3">section 8.3</a> it states that cookies sent over a secure link are by default considered secure. Such cookies are not to be sent by the client using an unsecure protocol.
</p><p>A side effect of using <code>FORCE_SSL_ADMIN</code> is that <a href="https://codex.wordpress.org/Function_Reference/admin_url" title="Function Reference/admin url"> admin_url()</a> will return URLs using the https scheme. Assuming the front end is using non-secure http protocol, this can result in mixed protocol usage. Further, any cookies returned by AJAX calls to URLs built using <code>admin_url('admin-ajax.php')</code> will be secure and thus unavailable to other parts of the front end. Unexpected behavior can result. It is possible to specify an alternate protocol on calls to  <a href="https://codex.wordpress.org/Function_Reference/admin_url" title="Function Reference/admin url"> admin_url()</a> to override the default behavior.
</p>
<h2><span class="mw-headline" id="Related">Related</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Administration_Over_SSL&amp;action=edit&amp;section=18" title="Edit section: Related">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> <a href="https://codex.wordpress.org/Function_Reference/force_ssl_admin" title="Function Reference/force ssl admin"> force_ssl_admin() </a></li>
<li> <a href="https://codex.wordpress.org/Function_Reference/force_ssl_content" title="Function Reference/force ssl content"> force_ssl_content() </a></li>
<li> <a href="https://codex.wordpress.org/Function_Reference/is_ssl" title="Function Reference/is ssl"> is_ssl() </a></li></ul>

<!-- 
NewPP limit report
Cached time: 20190429052926
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.020 seconds
Real time usage: 0.034 seconds
Preprocessor visited node count: 207/1000000
Preprocessor generated node count: 473/1000000
Post‐expand include size: 501/2097152 bytes
Template argument size: 148/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    3.993      1 - Template:Languages
100.00%    3.993      1 - -total
 31.53%    1.259      1 - Template:ja
 29.85%    1.192      1 - Template:en
-->
