{{Languages|
{{en|Function Reference/add_post_meta}}
{{zh-hans|函数参考/add_post_meta}}
{{ru|Справочник_по_функциям/add_post_meta}}
{{es|Referencia de Funciones/add_post_meta}}
{{ja|関数リファレンス/add_post_meta}}
}}
==Описание==

'''add_post_meta''' добавляет [[Произвольные_поля|произвольные_поля]] в указанную запись, страницу или другой [[post type|тип документа]].

Если параметру <tt>$unique</tt> задать значение <var>true</var> и поле с указанным ключом уже существует, функция вернёт <var>false</var> и не произведёт изменений; в противном случае возвращается <var>true</var>.

==Использование==

%%% <?php add_post_meta($post_id, $meta_key, $meta_value, $unique); ?> %%%

==Параметры==

{{Parameter|$post_id|integer|ID записи, к которой нужно добавить произвольное поле.}}
{{Parameter|$meta_key|string|Ключ (название) произвольного поля, которое будет добавлено.}}
{{Parameter|$meta_value|mixed|Значение произвольного поля, которое будет добавлено. Массив будет преобразован в строку.}}
{{Parameter|$unique|boolean|Указывает, должно ли поле быть уникальным. Если указать значение true, при добавлении поля, сначала будет проверяться существует ли уже поле с таким <tt>$meta_key</tt>, и если существует, то поле не будет добавлено.|optional|false}}

==Примеры==

===По умолчанию===

 <?php add_post_meta(68, 'my_key', 47); ?>

===Добавить или обновить уникальное поле===

Добавляет произвольное поле, если такое поле ещё не существует или обновляет существующее.
Примечание: если четвёртому параметру add_post_meta установить значение true, то поле не будет обновлено, если оно уже существует (проверено на версии WP 2.6.2). Рекомендуется использовать <tt>if (!update_post_meta(...)) add_post_meta(...)</tt>.

  <?php add_post_meta(7, 'fruit', 'banana', true) or update_post_meta(7, 'fruit', 'banana'); ?>

===Другие примеры===

Что перед добавлением поля ''"my_key"'' убедиться, что оно ещё не существует, следуетиспользовать такой вариант:
 <?php add_post_meta(68, 'my_key', '47', true); ?>

Добавить несколько значений полю ''"my_key"'' можно следующим образом:
<pre><?php add_post_meta(68, 'my_key', '47'); ?>
<?php add_post_meta(68, 'my_key', '682'); ?>
<?php add_post_meta(68, 'my_key', 'The quick, brown fox jumped over the lazy dog.'); ?>
...</pre>

Больше подробных примеров можно найти на странице [[Function Reference/post meta Function Examples|post_meta Functions Examples]].

=== Создание скрытых произвольных полей ===

Если вы разработчик и вам нужно создать произвольное поле, которое не будет видно пользователям, но при этом будет работать как обычное произвольное поле, то знайте что WordPress не показывает произвольные поля начинающиеся с "_" (нижнего подчеркивания). Не показывает значит, что они игнорируются на странице редактирования постов или при использовании функции шаблона the_meta().

Поэтому, если нужно вдруг нужно спрятать произвольное поле, то нужно создавать поле с ключом начинающимся с "_", например:
 <?php add_post_meta(68, '_color', 'red', true); ?>
добавит уникальное произвольное поле _color со значением red и это поле не будет выводится в админке на странице редактирования постов/постоянных страниц.

Кроме того, если $meta_value является массивом, оно не будет отображаться на странице редактирования записи или страницы.

== Исходный файл ==

<tt>add_post_meta()</tt> объявляется в {{Trac|wp-includes/post.php}}

== История изменений==

* с версии [[Version 1.5|1.5.0]]

==Схожее==

{{Post Meta Tags}}

{{Tag Footer}}

[[Category:Functions]]
[[Category:Функции]]
[[Category:Russian Codex]]