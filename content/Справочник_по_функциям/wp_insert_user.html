<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.D0.9E.D0.BF.D0.B8.D1.81.D0.B0.D0.BD.D0.B8.D0.B5"><span class="tocnumber">1</span> <span class="toctext">Описание</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#.D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"><span class="tocnumber">2</span> <span class="toctext">Использование</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#.D0.9F.D0.B0.D1.80.D0.B0.D0.BC.D0.B5.D1.82.D1.80.D1.8B"><span class="tocnumber">3</span> <span class="toctext">Параметры</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#.D0.92.D0.BE.D0.B7.D0.B2.D1.80.D0.B0.D1.89.D0.B0.D0.B5.D0.BC.D1.8B.D0.B5_.D0.B7.D0.BD.D0.B0.D1.87.D0.B5.D0.BD.D0.B8.D1.8F"><span class="tocnumber">4</span> <span class="toctext">Возвращаемые значения</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#.D0.A8.D0.B0.D0.B1.D0.BB.D0.BE.D0.BD_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D1.8F"><span class="tocnumber">5</span> <span class="toctext">Шаблон использования</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#.D0.96.D1.83.D1.80.D0.BD.D0.B0.D0.BB_.D0.B8.D0.B7.D0.BC.D0.B5.D0.BD.D0.B5.D0.BD.D0.B8.D0.B9"><span class="tocnumber">6</span> <span class="toctext">Журнал изменений</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#.D0.9F.D1.80.D0.B8.D0.BC.D0.B5.D1.87.D0.B0.D0.BD.D0.B8.D1.8F"><span class="tocnumber">7</span> <span class="toctext">Примечания</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#.D0.94.D0.BE.D0.BF.D0.BE.D0.BB.D0.BD.D0.B8.D1.82.D0.B5.D0.BB.D1.8C.D0.BD.D1.8B.D0.B5"><span class="tocnumber">8</span> <span class="toctext">Дополнительные</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#.D0.9D.D0.B0_.D0.B7.D0.B0.D0.BC.D0.B5.D1.82.D0.BA.D1.83"><span class="tocnumber">9</span> <span class="toctext">На заметку</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id=".D0.9E.D0.BF.D0.B8.D1.81.D0.B0.D0.BD.D0.B8.D0.B5">Описание</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=%D0%A1%D0%BF%D1%80%D0%B0%D0%B2%D0%BE%D1%87%D0%BD%D0%B8%D0%BA_%D0%BF%D0%BE_%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F%D0%BC/wp_insert_user&amp;action=edit&amp;section=1" title="Edit section: Описание">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Вставляет данные пользователя в Базу Данных. Создает/обновляет пользователя.Укажите ID существующего пользователя и данные, если нужно обновить данные пользователя, а не создавать нового.wp_insert_user() используется в: wp_update_user(), wp_create_user().
</p>
<h2><span class="mw-headline" id=".D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5">Использование</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=%D0%A1%D0%BF%D1%80%D0%B0%D0%B2%D0%BE%D1%87%D0%BD%D0%B8%D0%BA_%D0%BF%D0%BE_%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F%D0%BC/wp_insert_user&amp;action=edit&amp;section=2" title="Edit section: Использование">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre>&lt;?php wp_insert_user( $userdata )&#160;?&gt;</pre>
<h2><span class="mw-headline" id=".D0.9F.D0.B0.D1.80.D0.B0.D0.BC.D0.B5.D1.82.D1.80.D1.8B">Параметры</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=%D0%A1%D0%BF%D1%80%D0%B0%D0%B2%D0%BE%D1%87%D0%BD%D0%B8%D0%BA_%D0%BF%D0%BE_%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F%D0%BC/wp_insert_user&amp;action=edit&amp;section=3" title="Edit section: Параметры">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<dl><dt> <tt>$userdata</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Mixed" title="How to Pass Tag Parameters"><i>mixed</i></a>) (<i>required</i>) Массив из данных пользователя, stdClass или обьект <a href="https://codex.wordpress.org/Class_Reference/WP_User" title="Class Reference/WP User">WP_User</a>.
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<h2><span class="mw-headline" id=".D0.92.D0.BE.D0.B7.D0.B2.D1.80.D0.B0.D1.89.D0.B0.D0.B5.D0.BC.D1.8B.D0.B5_.D0.B7.D0.BD.D0.B0.D1.87.D0.B5.D0.BD.D0.B8.D1.8F">Возвращаемые значения</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=%D0%A1%D0%BF%D1%80%D0%B0%D0%B2%D0%BE%D1%87%D0%BD%D0%B8%D0%BA_%D0%BF%D0%BE_%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F%D0%BC/wp_insert_user&amp;action=edit&amp;section=4" title="Edit section: Возвращаемые значения">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Функция возвращает ID вновь созданного пользователя или объект WP_Error.
</p>
<h2><span class="mw-headline" id=".D0.A8.D0.B0.D0.B1.D0.BB.D0.BE.D0.BD_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D1.8F">Шаблон использования</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=%D0%A1%D0%BF%D1%80%D0%B0%D0%B2%D0%BE%D1%87%D0%BD%D0%B8%D0%BA_%D0%BF%D0%BE_%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F%D0%BC/wp_insert_user&amp;action=edit&amp;section=5" title="Edit section: Шаблон использования">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre>&lt;?php 
      
    $userdata = array(  
        'ID' =&gt; 0  
        ,'user_pass' =&gt; '' //обязательно  
        ,'user_login' =&gt; '' //обязательно  
        ,'user_nicename' =&gt; ''  
        ,'user_url' =&gt; ''  
        ,'user_email' =&gt; ''  
        ,'display_name' =&gt; ''  
        ,'nickname' =&gt; ''  
        ,'first_name' =&gt; ''  
        ,'last_name' =&gt; ''  
        ,'description' =&gt; ''  
        ,'rich_editing' =&gt; true  // false - выключить визуальный редактор для пользователя.  
        ,'user_registered' =&gt; '' // дата регистрации (Y-m-d H:i:s)  
        ,'role' =&gt; '' // (строка) роль пользвателя  
        ,'jabber' =&gt; ''  
        ,'aim' =&gt; ''  
        ,'yim' =&gt; ''  
    );  
      
    wp_insert_user( $userdata );  
?&gt;</pre>
<h2><span class="mw-headline" id=".D0.96.D1.83.D1.80.D0.BD.D0.B0.D0.BB_.D0.B8.D0.B7.D0.BC.D0.B5.D0.BD.D0.B5.D0.BD.D0.B8.D0.B9">Журнал изменений</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=%D0%A1%D0%BF%D1%80%D0%B0%D0%B2%D0%BE%D1%87%D0%BD%D0%B8%D0%BA_%D0%BF%D0%BE_%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F%D0%BC/wp_insert_user&amp;action=edit&amp;section=6" title="Edit section: Журнал изменений">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>С версии 2.7.1 эта функция не хэширует пароль, потому для обновления пароля, используйте: wp_update_user().
</p>
<h2><span class="mw-headline" id=".D0.9F.D1.80.D0.B8.D0.BC.D0.B5.D1.87.D0.B0.D0.BD.D0.B8.D1.8F">Примечания</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=%D0%A1%D0%BF%D1%80%D0%B0%D0%B2%D0%BE%D1%87%D0%BD%D0%B8%D0%BA_%D0%BF%D0%BE_%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F%D0%BC/wp_insert_user&amp;action=edit&amp;section=7" title="Edit section: Примечания">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Параметры
</p><p>$userdata (массив) (обязательный)
Массив данных создаваемого пользователя.
По умолчанию: по умолчанию
Аргументы параметра $userdata
</p><p>ID (число) - ID пользователя. Указывается только, если надо обновить данные уже существующего пользователя. Все обязательные параметры, становятся не обязательными.
</p><p>user_pass (строка) (обязательный) - Пароль для создаваемого пользователя. Хэшируется.
</p><p>user_login (строка) (обязательный) - Логин нового пользователя. Для дополнительной проверки логина, можно использовать фильтр: pre_user_login
</p><p>user_nicename (строка) - Имя пользователя. Если не указать, будет как логин.
</p><p>user_url (строка) - Сайт. Фильтр: pre_user_url
</p><p>user_email (строка) - Почта. Проверяется на существования в БД.
</p><p>display_name (строка) - Отображаемое имя. Если пусто будет как логин.
</p><p>nickname (строка) - Ник. Если пусто, будет как логин.
</p><p>first_name (строка) - Имя.
</p><p>last_name (строка) - Фамилия.
</p><p>description (строка) - Немного о себе.
</p><p>rich_editing (логический) - Включить (true) или нет (false) визуальный редактор. По умолчанию - true
</p><p>user_registered (строка) - Дата регистрации. Формат: Y-m-d H:i:s. Если пусто, то текущая дата.
</p><p>role (строка) - Роль пользователя. По умолчанию берется из настроек: get_option('default_role')
</p><p>jabber (строка) - Профиль.
</p><p>aim (строка) - Профиль.
</p><p>yim (строка) - Профиль.
</p>
<h2><span class="mw-headline" id=".D0.94.D0.BE.D0.BF.D0.BE.D0.BB.D0.BD.D0.B8.D1.82.D0.B5.D0.BB.D1.8C.D0.BD.D1.8B.D0.B5">Дополнительные</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=%D0%A1%D0%BF%D1%80%D0%B0%D0%B2%D0%BE%D1%87%D0%BD%D0%B8%D0%BA_%D0%BF%D0%BE_%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F%D0%BC/wp_insert_user&amp;action=edit&amp;section=8" title="Edit section: Дополнительные">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>admin_color (строка) - Тема админки. По умолчанию fresh
</p><p>show_admin_bar_front (строка) - Показывать админ бар на сайте или нет. По умолчанию true.
Примеры
</p><p>1. Обновим поле Веб-сайт у пользователя 1:
</p>
<pre>&lt;?php  
    $user_id = 1;  
    $website = 'http://wordpress.org';  
    wp_insert_user( array ('ID' =&gt; $user_id, 'user_url' =&gt; $website) )&#160;;  
?&gt;</pre>
<p><br /> 
</p>
<h2><span class="mw-headline" id=".D0.9D.D0.B0_.D0.B7.D0.B0.D0.BC.D0.B5.D1.82.D0.BA.D1.83">На заметку</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=%D0%A1%D0%BF%D1%80%D0%B0%D0%B2%D0%BE%D1%87%D0%BD%D0%B8%D0%BA_%D0%BF%D0%BE_%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F%D0%BC/wp_insert_user&amp;action=edit&amp;section=9" title="Edit section: На заметку">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Используются фильтры (pre_ - фильтр срабатывает до использования значения, все фильтры передают значение параметра):
</p>
<pre>   pre_user_user_pass
   pre_user_user_login
   pre_user_user_nicename
   pre_user_user_url
   pre_user_user_email
   pre_user_display_name
   pre_user_nickname
   pre_user_first_name
   pre_user_last_name
   pre_user_description
</pre>
<p>user_register - срабатывает после добавления пользователя. Передает ID.
</p><p>wp_insert_user()  из файла: /wp-includes/user.php WP 3.4
</p>
<pre>   function wp_insert_user($userdata) {  
       global $wpdb;  
     
       extract($userdata, EXTR_SKIP);  
 
       // Are we updating or creating?  
       if (&#160;!empty($ID) ) {  
           $ID = (int) $ID;  
           $update = true;  
           $old_user_data = WP_User::get_data_by( 'id', $ID );  
       } else {  
           $update = false;  
           // Hash the password  
           $user_pass = wp_hash_password($user_pass);  
       }  
 
       $user_login = sanitize_user($user_login, true);  
       $user_login = apply_filters('pre_user_login', $user_login);  
 
       //Remove any non-printable chars from the login string to see if we have ended up with an empty username  
       $user_login = trim($user_login);  
 
       if ( empty($user_login) )  
           return new WP_Error('empty_user_login', __('Cannot create a user with an empty login name.') );  
 
       if (&#160;!$update &amp;&amp; username_exists( $user_login ) )  
           return new WP_Error('existing_user_login', __('This username is already registered.') );  
 
       if ( empty($user_nicename) )  
           $user_nicename = sanitize_title( $user_login );  
       $user_nicename = apply_filters('pre_user_nicename', $user_nicename);  
 
       if ( empty($user_url) )  
           $user_url = <i>;  </i>
       $user_url = apply_filters('pre_user_url', $user_url);  
 
       if ( empty($user_email) )  
           $user_email = <i>;  </i>
       $user_email = apply_filters('pre_user_email', $user_email);  
 
       if (&#160;!$update &amp;&amp;&#160;! defined( 'WP_IMPORTING' ) &amp;&amp; email_exists($user_email) )  
           return new WP_Error('existing_user_email', __('This email address is already registered.') );  
 
       if ( empty($display_name) )  
           $display_name = $user_login;  
       $display_name = apply_filters('pre_user_display_name', $display_name);  
     
       if ( empty($nickname) )  
           $nickname = $user_login;  
       $nickname = apply_filters('pre_user_nickname', $nickname);  
     
       if ( empty($first_name) )  
           $first_name = <i>;  </i>
       $first_name = apply_filters('pre_user_first_name', $first_name);  
     
       if ( empty($last_name) )  
       $last_name = <i>;  </i>
       $last_name = apply_filters('pre_user_last_name', $last_name);  
     
       if ( empty($description) )  
           $description = <i>;  </i>
       $description = apply_filters('pre_user_description', $description);  
 
       if ( empty($rich_editing) )  
           $rich_editing = 'true';  
     
       if ( empty($comment_shortcuts) )  
           $comment_shortcuts = 'false';  
 
       if ( empty($admin_color) )  
           $admin_color = 'fresh';  
       $admin_color = preg_replace('|[^a-z0-9 _.\-@]|i', <i>, $admin_color);  </i>
     
       if ( empty($use_ssl) )  
           $use_ssl = 0;  
     
       if ( empty($user_registered) )  
           $user_registered = gmdate('Y-m-d H:i:s');  
     
       if ( empty($show_admin_bar_front) )  
           $show_admin_bar_front = 'true';  
     
       $user_nicename_check = $wpdb-&gt;get_var( $wpdb-&gt;prepare("SELECT ID FROM $wpdb-&gt;users WHERE     user_nicename =&#160;%s AND user_login&#160;!=&#160;%s LIMIT 1" , $user_nicename, $user_login));  
     
       if ( $user_nicename_check ) {  
       $suffix = 2;  
           while ($user_nicename_check) {  
               $alt_user_nicename = $user_nicename . "-$suffix";  
               $user_nicename_check = $wpdb-&gt;get_var( $wpdb-&gt;prepare("SELECT ID FROM $wpdb-&gt;users     WHERE user_nicename =&#160;%s AND user_login&#160;!=&#160;%s LIMIT 1" , $alt_user_nicename, $user_login));  
               $suffix++;  
           }  
           $user_nicename = $alt_user_nicename;  
       }  
     
       $data = compact( 'user_pass', 'user_email', 'user_url', 'user_nicename', 'display_name',     'user_registered' );  
       $data = stripslashes_deep( $data );  
     
       if ( $update ) {  
           $wpdb-&gt;update( $wpdb-&gt;users, $data, compact( 'ID' ) );  
           $user_id = (int) $ID;  
       } else {  
           $wpdb-&gt;insert( $wpdb-&gt;users, $data + compact( 'user_login' ) );  
           $user_id = (int) $wpdb-&gt;insert_id;  
       }  
     
       $user = new WP_User( $user_id );  
     
       foreach ( _get_additional_user_keys( $user ) as $key ) {  
           if ( isset( $$key ) )  
               update_user_meta( $user_id, $key, $$key );  
       }  
     
       if ( isset($role) )  
           $user-&gt;set_role($role);  
       elseif (&#160;!$update )  
           $user-&gt;set_role(get_option('default_role'));  
     
       wp_cache_delete($user_id, 'users');  
       wp_cache_delete($user_login, 'userlogins');  
     
       if ( $update )  
           do_action('profile_update', $user_id, $old_user_data);  
       else  
           do_action('user_register', $user_id);  
     
       return $user_id;  
   }
</pre>
<!-- 
NewPP limit report
Cached time: 20190429054929
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.012 seconds
Real time usage: 0.016 seconds
Preprocessor visited node count: 75/1000000
Preprocessor generated node count: 185/1000000
Post‐expand include size: 235/2097152 bytes
Template argument size: 141/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    1.430      1 - Template:Parameter
100.00%    1.430      1 - -total
-->
