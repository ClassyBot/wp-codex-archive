<p class="LanguageLinks" style="border:1px solid #CCCCCC; line-height:1.5; text-align:left; color:#333333; font-size:90%; padding:10px;"><span style="white-space:nowrap;"><a href="https://codex.wordpress.org/Multilingual_Codex" title="Multilingual Codex" class="mw-redirect">Languages</a>:</span> 
<strong class="selflink">English</strong> • 
<a rel="nofollow" class="external text" href="https://wpdocs.osdn.jp/関数リファレンス/register_activation_hook">日本語</a> 
 <small>(<a href="https://codex.wordpress.org/Multilingual_Codex#Language_Cross_Reference" title="Multilingual Codex" class="mw-redirect">Add your language</a>)</small>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Usage"><span class="tocnumber">2</span> <span class="toctext">Usage</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Examples"><span class="tocnumber">4</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Notes"><span class="tocnumber">5</span> <span class="toctext">Notes</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Process_Flow"><span class="tocnumber">5.1</span> <span class="toctext">Process Flow</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#A_Note_on_Variable_Scope"><span class="tocnumber">5.2</span> <span class="toctext">A Note on Variable Scope</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Discussions_-_External_Resources"><span class="tocnumber">6</span> <span class="toctext">Discussions - External Resources</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Changelog"><span class="tocnumber">7</span> <span class="toctext">Changelog</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Source_File"><span class="tocnumber">8</span> <span class="toctext">Source File</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Related"><span class="tocnumber">9</span> <span class="toctext">Related</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Description">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/register_activation_hook&amp;action=edit&amp;section=1" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The <b>register_activation_hook</b> function registers a plugin function to be run <a href="https://codex.wordpress.org/Managing_Plugins#Installing_Plugins" title="Managing Plugins">when the plugin is activated</a>.
</p><p>When a plugin is activated, the action <tt>'activate_PLUGINNAME'</tt> hook is called. In the name of this hook, <tt>PLUGINNAME</tt> is replaced with the name of the plugin, including the optional subdirectory. For example, when the plugin is located in <tt>wp-content/plugin/sampleplugin/sample.php</tt>, then the name of this hook will become <tt>'activate_sampleplugin/sample.php'</tt>. When the plugin consists of only one file and is (as by default) located at <tt>wp-content/plugin/sample.php</tt> the name of this hook will be <tt>'activate_sample.php'</tt>.
</p><p>This function is a wrapper for the <tt>'activate_PLUGINNAME'</tt> action, and is easier to use.
</p>
<h2><span class="mw-headline" id="Usage">Usage</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/register_activation_hook&amp;action=edit&amp;section=2" title="Edit section: Usage">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><code><span style="color: #000000">
&#160;<span style="color: #0000BB">&lt;?php&#160;register_activation_hook</span><span style="color: #007700">(&#160;</span><span style="color: #0000BB">$file</span><span style="color: #007700">,&#160;</span><span style="color: #0000BB">$function&#160;</span><span style="color: #007700">);&#160;</span><span style="color: #0000BB">?&gt;</span>&#160;</span>
</code>
</p>
<h2><span class="mw-headline" id="Parameters">Parameters</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/register_activation_hook&amp;action=edit&amp;section=3" title="Edit section: Parameters">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<dl><dt> <tt>$file</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#String" title="How to Pass Tag Parameters"><i>string</i></a>) (<i>required</i>) Path to the <a href="https://codex.wordpress.org/Writing_a_Plugin#Plugin_Files" title="Writing a Plugin">main plugin file</a> inside the <tt>wp-content/plugins</tt> directory. A full path will work.
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<dl><dt> <tt>$function</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Callback" title="How to Pass Tag Parameters"><i>callback</i></a>) (<i>required</i>) The function to be run when the plugin is activated. Any of <a rel="nofollow" class="external text" href="http://us2.php.net/manual/en/language.pseudo-types.php#language.types.callback">PHP's callback pseudo-types</a> will work.
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<h2><span class="mw-headline" id="Examples">Examples</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/register_activation_hook&amp;action=edit&amp;section=4" title="Edit section: Examples">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>If you have a function called <tt>myplugin_activate()</tt> in the <a href="https://codex.wordpress.org/Writing_a_Plugin#Plugin_Files" title="Writing a Plugin">main plugin file</a> at either 
</p>
<ul><li>	<tt>wp-content/plugins/<var>myplugin</var>.php</tt> or</li>
<li>	<tt>wp-content/plugins/<var>myplugin</var>/<var>myplugin</var>.php</tt></li></ul>
<p>use this code:
</p>
<pre>
function myplugin_activate() {

    // Activation code here...
}
register_activation_hook( __FILE__, 'myplugin_activate' );
</pre>
<p>This will call the <tt>myplugin_activate()</tt> function on activation of the plugin.
</p><p>If your plugin uses the singleton class pattern, add the activation hook like so:
</p>
<pre>class MyPlugin {
     static function install() {
            // do not generate any output here
     }
}
register_activation_hook( __FILE__, array( 'MyPlugin', 'install' ) );
</pre>
<p>If the class that holds your activation function/method is in some additional file, register your activation function like this:
</p>
<pre>
include_once dirname( __FILE__ ) . '/your_additional_file.php';
register_activation_hook( __FILE__, array( 'YourAdditionalClass', 'on_activate_function' ) );
</pre>
<p>Or, because the activation hook requires a static function, if you're inside of a <tt>__construct()</tt>:
</p>
<pre>register_activation_hook( __FILE__, array( 'MyPlugin', 'YOUR_METHOD_NAME' ) );</pre>
<h2><span class="mw-headline" id="Notes">Notes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/register_activation_hook&amp;action=edit&amp;section=5" title="Edit section: Notes">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> Related discussion with another sample of working code: <a rel="nofollow" class="external free" href="http://wordpress.org/support/topic/312342">http://wordpress.org/support/topic/312342</a> </li>
<li> <strong>Registering the hook inside the 'plugins_loaded' hook will not work.</strong> You can't call <tt>register_activation_hook()</tt> inside a function hooked to the <tt><a href="https://codex.wordpress.org/Plugin_API/Action_Reference/plugins_loaded" title="Plugin API/Action Reference/plugins loaded"> 'plugins_loaded'</a></tt> or <tt><a href="https://codex.wordpress.org/Plugin_API/Action_Reference/init" title="Plugin API/Action Reference/init"> 'init'</a></tt> hooks (or any other hook). These hooks are called <i>before</i> the plugin is loaded or activated.</li>
<li> When a plugin is activated, all active plugins are loaded, then the plugin being activated. The plugin's activation hook is run and then the page is immediately redirected (see <a href="#Process_Flow">below</a>).</li></ul>
<h3><span class="mw-headline" id="Process_Flow">Process Flow</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/register_activation_hook&amp;action=edit&amp;section=6" title="Edit section: Process Flow">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>If you are interested in doing something just after a plugin has been activated it is important to note that the hook process performs an instant redirect after it fires.  So it is impossible to use <tt><a href="https://codex.wordpress.org/Function_Reference/add_action" title="Function Reference/add action"> add_action()</a></tt> or <tt><a href="https://codex.wordpress.org/Function_Reference/add_filter" title="Function Reference/add filter"> add_filter()</a></tt> type calls until the redirect has occurred (e.g., only two hooks are fired after the plugin's activation hook: <tt><a href="https://codex.wordpress.org/Plugin_API/Action_Reference/activated_plugin" title="Plugin API/Action Reference/activated plugin"> 'activated_plugin'</a></tt> and <tt><a href="https://codex.wordpress.org/Plugin_API/Action_Reference/shutdown" title="Plugin API/Action Reference/shutdown"> 'shutdown'</a></tt>).  A quick workaround to this quirk is to use <tt><a href="https://codex.wordpress.org/Function_Reference/add_option" title="Function Reference/add option"> add_option()</a></tt> like so:
</p>
<pre>
/* Main Plugin File */
...
function my_plugin_activate() {

  add_option( 'Activated_Plugin', 'Plugin-Slug' );

  /* activation code here */
}
register_activation_hook( __FILE__, 'my_plugin_activate' );

function load_plugin() {

    if ( is_admin() &amp;&amp; get_option( 'Activated_Plugin' ) == 'Plugin-Slug' ) {

        delete_option( 'Activated_Plugin' );

        /* do stuff once right after activation */
        // example: add_action( 'init', 'my_init_function' );
    }
}
add_action( 'admin_init', 'load_plugin' );
</pre>
<p>You can check out the full post @ <a rel="nofollow" class="external free" href="http://stackoverflow.com/questions/7738953/is-there-a-way-to-determine-if-a-wordpress-plugin-is-just-installed/13927297#13927297">http://stackoverflow.com/questions/7738953/is-there-a-way-to-determine-if-a-wordpress-plugin-is-just-installed/13927297#13927297</a>.
</p><p>However, it <b>is</b> possible to use <tt><a href="https://codex.wordpress.org/Function_Reference/do_action" title="Function Reference/do action"> do_action()</a></tt>, like this:
</p>
<pre>
function my_plugin_activate() {

     do_action( 'my_plugin_activate' );
}
register_activation_hook( __FILE__, 'my_plugin_activate' );
</pre>
<p>Included plugin files and even other plugins <i>will</i> be able to hook into this action.
</p>
<h3><span class="mw-headline" id="A_Note_on_Variable_Scope">A Note on Variable Scope</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/register_activation_hook&amp;action=edit&amp;section=7" title="Edit section: A Note on Variable Scope">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>If you're using global variables, you may find that the function you pass to <tt>register_activation_hook()</tt> does not have access to global variables at the point when it is called, even though you state their global scope within the function like this:
</p>
<pre>
$myvar = 'whatever';

function myplugin_activate() {

  global $myvar;
  echo $myvar; // this will NOT be 'whatever'!
}

register_activation_hook( __FILE__, 'myplugin_activate' );
</pre>
<p>This is because on that very first include, your plugin is NOT included within the global scope. It's included in the <tt><a href="https://codex.wordpress.org/Function_Reference/activate_plugin" title="Function Reference/activate plugin"> activate_plugin()</a></tt> function, and so its "main body" is not automatically in the global scope.
</p><p>This is why you should <i>always</i> be explicit. If you want a variable to be global, then you need to declare it as such, and that means anywhere and everywhere you use it. If you use it in the main body of the plugin, then you need to declare it global there too.
</p><p>When activation occurs, your plugin is included from another function and then your <tt>myplugin_activate()</tt> is called from within that function (specifically, within the <tt>activate_plugin()</tt> function) at the point where your plugin is activated. The main body variables are therefore in the scope of the <tt>activate_plugin()</tt> function and are not global, unless you explicitly declare their global scope:
</p>
<pre>
global $myvar;
$myvar = 'whatever';

function myplugin_activate() {

   global $myvar;
   echo $myvar; // this will be 'whatever'
}
register_activation_hook( __FILE__, 'myplugin_activate' );
</pre>
<p>More information on this is available here: <a rel="nofollow" class="external free" href="http://wordpress.org/support/topic/201309">http://wordpress.org/support/topic/201309</a>
</p>
<h2><span class="mw-headline" id="Discussions_-_External_Resources">Discussions - External Resources</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/register_activation_hook&amp;action=edit&amp;section=8" title="Edit section: Discussions - External Resources">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> A good example for a basic activation/deactivation/uninstall class by "kaiser" can be found here on WPSE: <a rel="nofollow" class="external free" href="http://wordpress.stackexchange.com/questions/25910/uninstall-a-plugin-method-typical-features-how-to/25979#25979">http://wordpress.stackexchange.com/questions/25910/uninstall-a-plugin-method-typical-features-how-to/25979#25979</a></li></ul>
<h2><span class="mw-headline" id="Changelog">Changelog</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/register_activation_hook&amp;action=edit&amp;section=9" title="Edit section: Changelog">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> <a href="https://codex.wordpress.org/Version_3.1" title="Version 3.1">3.1</a>&#160;: This hook is now fired only when the user activates the plugin and not when an automatic plugin update occurs (<a rel="nofollow" class="external text" href="http://core.trac.wordpress.org/ticket/14915">#14915</a>).
<ul><li> <a rel="nofollow" class="external text" href="http://wpdevel.wordpress.com/2010/10/27/plugin-activation-hooks-no-longer-fire-for-updates/">Plugin activation hooks no longer fire for updates «&#160;WordPress Development Updates</a> (2010-10-28)</li>
<li> <a rel="nofollow" class="external text" href="http://wpdevel.wordpress.com/2010/10/27/plugin-activation-hooks/">Plugin activation hooks «&#160;WordPress Development Updates</a> (2010-10-27)</li></ul></li></ul>
<ul><li> since <a href="https://codex.wordpress.org/Version_2.0" title="Version 2.0">2.0</a></li></ul>
<h2><span class="mw-headline" id="Source_File">Source File</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/register_activation_hook&amp;action=edit&amp;section=10" title="Edit section: Source File">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><tt>register_activation_hook()</tt> is located in <code><a rel="nofollow" class="external text" href="https://core.trac.wordpress.org/browser/tags/5.1.1/src/wp-includes/plugin.php#L0">wp-includes/plugin.php</a></code>
</p>
<h2><span class="mw-headline" id="Related">Related</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/register_activation_hook&amp;action=edit&amp;section=11" title="Edit section: Related">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> See also <a href="https://codex.wordpress.org/Function_Reference/register_deactivation_hook" title="Function Reference/register deactivation hook">register_deactivation_hook()</a>, <a href="https://codex.wordpress.org/Function_Reference/register_uninstall_hook" title="Function Reference/register uninstall hook">register_uninstall_hook()</a></li></ul>
<div style="background-color:#F7F7F7; border:1px solid #CCCCCC; color:#000000; padding:7px; margin:0.5em auto 0.5em auto; vertical-align:middle; overflow:hidden;">See also index of <a href="https://codex.wordpress.org/Function_Reference" title="Function Reference">Function Reference</a> and index of <a href="https://codex.wordpress.org/Template_Tags" title="Template Tags">Template Tags</a>.</div>

<!-- 
NewPP limit report
Cached time: 20190429053609
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.020 seconds
Real time usage: 0.434 seconds
Preprocessor visited node count: 189/1000000
Preprocessor generated node count: 606/1000000
Post‐expand include size: 1812/2097152 bytes
Template argument size: 766/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%  242.038      1 - -total
 73.70%  178.391      2 - Template:Parameter
 22.82%   55.228      1 - Template:Tag_Footer
  5.78%   13.995      1 - Template:Message
  1.73%    4.187      1 - Template:Languages
  1.21%    2.927      1 - Template:Trac
  0.56%    1.353      1 - Template:ja
  0.52%    1.270      1 - Template:en
  0.42%    1.025      1 - Template:CurrentVersion
-->
