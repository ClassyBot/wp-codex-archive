<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Usage"><span class="tocnumber">2</span> <span class="toctext">Usage</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return_Value"><span class="tocnumber">4</span> <span class="toctext">Return Value</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Default_Usage"><span class="tocnumber">5.1</span> <span class="toctext">Default Usage</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Notes"><span class="tocnumber">6</span> <span class="toctext">Notes</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Changelog"><span class="tocnumber">7</span> <span class="toctext">Changelog</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Source_File"><span class="tocnumber">8</span> <span class="toctext">Source File</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Related"><span class="tocnumber">9</span> <span class="toctext">Related</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Description">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/activate_plugin&amp;action=edit&amp;section=1" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Attempts activation of plugin in a "sandbox" and redirects on success.
</p><p>A plugin that is already activated will not attempt to be activated again.
</p><p>The way it works is by setting the redirection to the error before trying to include the plugin file. If the plugin fails, then the redirection will not be overwritten with the success message. Also, the options will not be updated and the activation hook will not be called on plugin error.
</p><p>It should be noted that in no way the below code will actually prevent errors within the file. The code should not be used elsewhere to replicate the "sandbox", which uses redirection to work.
</p><p>If any errors are found or text is outputted, then it will be captured to ensure that the success redirection will update the error redirection.
</p>
<h2><span class="mw-headline" id="Usage">Usage</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/activate_plugin&amp;action=edit&amp;section=2" title="Edit section: Usage">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php&#160;activate_plugin</span><span style="color: #007700">(&#160;</span><span style="color: #0000BB">$plugin</span><span style="color: #007700">,&#160;</span><span style="color: #0000BB">$redirect&#160;</span><span style="color: #007700">=&#160;</span><span style="color: #DD0000"><i></span><span style="color: #007700">,&#160;</span><span style="color: #0000BB">$network_wide&#160;</span><span style="color: #007700">=&#160;</span><span style="color: #0000BB">false</span><span style="color: #007700">,&#160;</span><span style="color: #0000BB">$silent&#160;</span><span style="color: #007700">=&#160;</span><span style="color: #0000BB">false&#160;</span><span style="color: #007700">);&#160;</span><span style="color: #0000BB">?&gt;</span></i>
</span>
</code>
</p>
<h2><span class="mw-headline" id="Parameters">Parameters</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/activate_plugin&amp;action=edit&amp;section=3" title="Edit section: Parameters">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<dl><dt> <tt>$plugin</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#String" title="How to Pass Tag Parameters"><i>string</i></a>) (<i>required</i>) Plugin path to main plugin file with plugin data.
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<dl><dt> <tt>$redirect</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#String" title="How to Pass Tag Parameters"><i>string</i></a>) (<i>optional</i>) URL to redirect to.
<dl><dd> Default: NULL</dd></dl></dd></dl>
<dl><dt> <tt>$network_wide</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Boolean" title="How to Pass Tag Parameters"><i>boolean</i></a>) (<i>optional</i>) Whether to enable the plugin for all sites in the network or just the current site. Multisite only.
<dl><dd> Default: false</dd></dl></dd></dl>
<dl><dt> <tt>$silent</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Boolean" title="How to Pass Tag Parameters"><i>boolean</i></a>) (<i>optional</i>) Prevent calling activation hooks.
<dl><dd> Default: false</dd></dl></dd></dl>
<h2><span class="mw-headline" id="Return_Value">Return Value</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/activate_plugin&amp;action=edit&amp;section=4" title="Edit section: Return Value">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>(<i>WP_Error|null</i>) <a href="https://codex.wordpress.org/Class_Reference/WP_Error" title="Class Reference/WP Error">WP_Error</a> on invalid file or 'NULL' on success.
</p>
<h2><span class="mw-headline" id="Examples">Examples</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/activate_plugin&amp;action=edit&amp;section=5" title="Edit section: Examples">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Default_Usage">Default Usage</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/activate_plugin&amp;action=edit&amp;section=6" title="Edit section: Default Usage">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Attempts to activate the plugin, and returns WP_Error on failure
</p>
<pre>
$result = activate_plugin( 'plugin-dir/plugin-file.php' );
if ( is_wp_error( $result ) ) {
	// Process Error
}
</pre>
<h2><span class="mw-headline" id="Notes">Notes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/activate_plugin&amp;action=edit&amp;section=7" title="Edit section: Notes">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> Plugin will fail to activate with the following generic response for multiple reasons, including; issues parsing the header information, issue with the 'plugin' cache (see <a href="https://codex.wordpress.org/Class_Reference/WP_Object_Cache" title="Class Reference/WP Object Cache">WordPress Object Cache</a>), or a permissions error.</li></ul>
<pre>The plugin does not have a valid header
</pre>
<ul><li> Issues with the plugin cache, are caused when the plugin files are added or modified, after the plugins have all been initialised. This can be resolved by reloading the page, sending the <i>activate_plugin()</i> as a separate AJAX request, or if necessary, by manually updating the cache. Example below;</li></ul>
<pre>
$cache_plugins = wp_cache_get( 'plugins', 'plugins' );
if (&#160;!empty( $cache_plugins ) ) {
	$new_plugin = array(
		'Name' =&gt; $plugin_name,
		'PluginURI' =&gt; $plugin_uri,
		'Version' =&gt; $plugin_version,
		'Description' =&gt; $plugin_description,
		'Author' =&gt; $author_name,
		'AuthorURI' =&gt; $author_uri,
		'TextDomain' =&gt; '',
		'DomainPath' =&gt; '',
		'Network' =&gt; '',
		'Title' =&gt; $plugin_name,
		'AuthorName' =&gt; $author_name,
	);
	$cache_plugins[''][$plugin_path] = $new_plugin;
	wp_cache_set( 'plugins', $cache_plugins, 'plugins' );
}
</pre>
<h2><span class="mw-headline" id="Changelog">Changelog</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/activate_plugin&amp;action=edit&amp;section=8" title="Edit section: Changelog">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h2><span class="mw-headline" id="Source_File">Source File</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/activate_plugin&amp;action=edit&amp;section=9" title="Edit section: Source File">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><tt>activate_plugin()</tt> is located in <code><a rel="nofollow" class="external text" href="https://core.trac.wordpress.org/browser/tags/5.0.3/src/wp-admin/includes/plugin.php#L0">wp-admin/includes/plugin.php</a></code>.
</p>
<h2><span class="mw-headline" id="Related">Related</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/activate_plugin&amp;action=edit&amp;section=10" title="Edit section: Related">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> <a href="https://codex.wordpress.org/Function_Reference/register_activation_hook" title="Function Reference/register activation hook"><code>register_activation_hook()</code></a> </li>
<li> <a href="https://codex.wordpress.org/Function_Reference/is_plugin_active" title="Function Reference/is plugin active"><code>is_plugin_active()</code></a> </li></ul>
<div style="background-color:#F7F7F7; border:1px solid #CCCCCC; color:#000000; padding:7px; margin:0.5em auto 0.5em auto; vertical-align:middle; overflow:hidden;">See also index of <a href="https://codex.wordpress.org/Function_Reference" title="Function Reference">Function Reference</a> and index of <a href="https://codex.wordpress.org/Template_Tags" title="Template Tags">Template Tags</a>.</div>
<div style="background-color:#FAEBD7; border:1px solid #CCCCCC; color:#000000; padding:7px; margin:0.5em auto 0.5em auto; vertical-align:middle; overflow:hidden;">This page is <a href="https://codex.wordpress.org/Category:Stubs" title="Category:Stubs">marked</a> as incomplete. You can <a href="https://codex.wordpress.org/Codex:Contributing" title="Codex:Contributing">help</a> Codex by <b><a rel="nofollow" class="external text" href="https://codex.wordpress.org/index.php?title=Function_Reference/activate_plugin&amp;action=edit">expanding it</a></b>.</div>

<!-- 
NewPP limit report
Cached time: 20190211003755
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.020 seconds
Real time usage: 0.029 seconds
Preprocessor visited node count: 186/1000000
Preprocessor generated node count: 588/1000000
Post‐expand include size: 2248/2097152 bytes
Template argument size: 741/2097152 bytes
Highest expansion depth: 5/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%   11.735      1 - -total
 26.50%    3.110      1 - Template:Trac
 26.24%    3.079      4 - Template:Parameter
 23.53%    2.761      1 - Template:Tag_Footer
 14.68%    1.723      1 - Template:Stub
 14.32%    1.680      2 - Template:Message
  9.30%    1.091      1 - Template:CurrentVersion
-->
