<p class="LanguageLinks" style="border:1px solid #CCCCCC; line-height:1.5; text-align:left; color:#333333; font-size:90%; padding:10px;"><span style="white-space:nowrap;"><a href="https://codex.wordpress.org/Multilingual_Codex" title="Multilingual Codex" class="mw-redirect">Languages</a>:</span> 
<strong class="selflink">English</strong> • 
<a rel="nofollow" class="external text" href="https://wpdocs.osdn.jp/関数リファレンス/update">post meta 日本語</a> 
 <small>(<a href="https://codex.wordpress.org/Multilingual_Codex#Language_Cross_Reference" title="Multilingual Codex" class="mw-redirect">Add your language</a>)</small>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Usage"><span class="tocnumber">2</span> <span class="toctext">Usage</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return_Values"><span class="tocnumber">4</span> <span class="toctext">Return Values</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Default_Usage"><span class="tocnumber">5.1</span> <span class="toctext">Default Usage</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Other_Examples"><span class="tocnumber">5.2</span> <span class="toctext">Other Examples</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Character_Escaping"><span class="tocnumber">6</span> <span class="toctext">Character Escaping</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Do_not_store_escaped_values"><span class="tocnumber">6.1</span> <span class="toctext">Do not store escaped values</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Workaround"><span class="tocnumber">6.2</span> <span class="toctext">Workaround</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#Notes"><span class="tocnumber">7</span> <span class="toctext">Notes</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Source_Code"><span class="tocnumber">8</span> <span class="toctext">Source Code</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#Change_Log"><span class="tocnumber">9</span> <span class="toctext">Change Log</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Related"><span class="tocnumber">10</span> <span class="toctext">Related</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Description">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/update_post_meta&amp;action=edit&amp;section=1" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The function <tt>update_post_meta()</tt> updates the value of an existing meta key (custom field) for the specified post.
</p><p>This may be used in place of <tt><a href="https://codex.wordpress.org/Function_Reference/add_post_meta" title="Function Reference/add post meta"> add_post_meta()</a></tt> function.  The first thing this function will do is make sure that <tt>$meta_key</tt> already exists on <tt>$post_id</tt>.  If it does not, <tt>add_post_meta($post_id, $meta_key, $meta_value)</tt> is called instead and its result is returned.
</p><p>Returns <tt>meta_id</tt> if the meta doesn't exist, otherwise returns <tt>true</tt> on success and <tt>false</tt> on failure.  It also returns <tt>false</tt> if the value submitted is the same as the value that is already in the database.
</p><p>Please note that if your database collation is case insensitive (has with suffix <tt>_ci</tt>) then <tt>update_post_meta</tt> and <tt><a href="https://codex.wordpress.org/Function_Reference/delete_post_meta" title="Function Reference/delete post meta"> delete_post_meta</a></tt> and <tt><a href="https://codex.wordpress.org/Function_Reference/get_posts" title="Function Reference/get posts" class="mw-redirect"> get_posts</a></tt> will update/delete/query the meta records with keys that are upper or lower case.  However <tt><a href="https://codex.wordpress.org/Function_Reference/get_post_meta" title="Function Reference/get post meta"> get_post_meta</a></tt> will apparently be case sensitive due to <a href="https://codex.wordpress.org/Class_Reference/WP_Object_Cache" title="Class Reference/WP Object Cache"> WordPress caching</a>. See <a rel="nofollow" class="external free" href="https://core.trac.wordpress.org/ticket/18210">https://core.trac.wordpress.org/ticket/18210</a> for more info.
</p>
<h2><span class="mw-headline" id="Usage">Usage</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/update_post_meta&amp;action=edit&amp;section=2" title="Edit section: Usage">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><code><span style="color: #000000">
&#160;<span style="color: #0000BB">&lt;?php&#160;update_post_meta</span><span style="color: #007700">(&#160;</span><span style="color: #0000BB">$post_id</span><span style="color: #007700">,&#160;</span><span style="color: #0000BB">$meta_key</span><span style="color: #007700">,&#160;</span><span style="color: #0000BB">$meta_value</span><span style="color: #007700">,&#160;</span><span style="color: #0000BB">$prev_value&#160;</span><span style="color: #007700">);&#160;</span><span style="color: #0000BB">?&gt;</span>&#160;</span>
</code>
</p>
<h2><span class="mw-headline" id="Parameters">Parameters</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/update_post_meta&amp;action=edit&amp;section=3" title="Edit section: Parameters">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<dl><dt> <tt>$post_id</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Integer" title="How to Pass Tag Parameters"><i>integer</i></a>) (<i>required</i>) The ID of the post which contains the field you will edit.
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<dl><dt> <tt>$meta_key</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#String" title="How to Pass Tag Parameters"><i>string</i></a>) (<i>required</i>) The key of the custom field you will edit. (this should be raw as opposed to sanitized for database queries)
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<dl><dt> <tt>$meta_value</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Mixed" title="How to Pass Tag Parameters"><i>mixed</i></a>) (<i>required</i>) The new value of the custom field. A passed array will be serialized into a string.(this should be raw as opposed to sanitized for database queries)
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<dl><dt> <tt>$prev_value</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Mixed" title="How to Pass Tag Parameters"><i>mixed</i></a>) (<i>optional</i>) The old value of the custom field you wish to change. This is to differentiate between several fields with the same key.  If omitted, and there are multiple rows for this post and meta key, all meta values will be updated.
<dl><dd> Default: <i>Empty</i></dd></dl></dd></dl>
<h2><span class="mw-headline" id="Return_Values">Return Values</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/update_post_meta&amp;action=edit&amp;section=4" title="Edit section: Return Values">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<dl><dt> (mixed)&#160;</dt>
<dd> Returns meta_id if the meta doesn't exist, otherwise returns true on success and false on failure. NOTE: If the meta_value passed to this function is the same as the value that is already in the database, this function returns false.</dd></dl>
<h2><span class="mw-headline" id="Examples">Examples</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/update_post_meta&amp;action=edit&amp;section=5" title="Edit section: Examples">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Default_Usage">Default Usage</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/update_post_meta&amp;action=edit&amp;section=6" title="Edit section: Default Usage">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<pre>&lt;?php update_post_meta( 76, 'my_key', 'Steve' );&#160;?&gt;
</pre>
<h3><span class="mw-headline" id="Other_Examples">Other Examples</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/update_post_meta&amp;action=edit&amp;section=7" title="Edit section: Other Examples">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Assuming a post has an ID of 76, and the following 4 custom fields:
</p>
<div style="border:1px solid blue; width:50%; margin: 20px; padding:20px">
<p>[key_1] =&gt; 'Happy'<br />
[key_1] =&gt; 'Sad'<br />
[key_2] =&gt; 'Gregory'<br />
[my_key] =&gt; 'Steve'<br />
</p>
</div>
<p>To change <tt>key_2</tt>'s value to <i>Hans</i>:
</p>
<pre>&lt;?php update_post_meta( 76, 'key_2', 'Hans' );&#160;?&gt;
</pre>
<p>To change <tt>key_1</tt>'s value from <i>Sad</i> to <i>Happy</i>:
</p>
<pre>&lt;?php update_post_meta( 76, 'key_1', 'Happy', 'Sad' );&#160;?&gt;
</pre>
<p>The fields would now look like this:
</p>
<div style="border:1px solid blue; width:50%; margin: 20px; padding:20px">
<p>[key_1] =&gt; 'Happy'<br />
[key_1] =&gt; 'Happy'<br />
[key_2] =&gt; 'Hans'<br />
[my_key] =&gt; 'Steve'<br />
</p>
</div>
<p><i><b>Note:</b> This function will update only the first field that matches the criteria.</i>
</p><p>To change the first <tt>key_1</tt>'s value from <i>Happy</i> to <i>Excited</i>:
</p>
<pre>&lt;?php 
  update_post_meta( 76, 'key_1', 'Excited', 'Happy' );

  //Or

  update_post_meta( 76, 'key_1', 'Excited' );

  //To change all fields with the key "key_1":

  $key1_values = get_post_custom_values( 'key_1', 76 );
  foreach ( $key1_values as $value )
    update_post_meta( 76, 'key_1', 'Excited', $value );
?&gt;</pre>
<p><br />
Edit Page template
</p>
<pre>&lt;?php 
 update_post_meta( $id, '_wp_page_template', 'new_template.php' );
?&gt;</pre>
<p>For a more detailed example, go to the <a href="https://codex.wordpress.org/Function_Reference/post_meta_Function_Examples" title="Function Reference/post meta Function Examples">post_meta Functions Examples</a> page.
</p>
<h2><span class="mw-headline" id="Character_Escaping">Character Escaping</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/update_post_meta&amp;action=edit&amp;section=8" title="Edit section: Character Escaping">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Post meta values are passed through the <tt><a rel="nofollow" class="external text" href="http://www.php.net/stripslashes">stripslashes()</a></tt> function upon being stored, so you will need to be careful when passing in values (such as JSON) that might include <tt>\</tt> escaped characters.
</p>
<h3><span class="mw-headline" id="Do_not_store_escaped_values">Do not store escaped values</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/update_post_meta&amp;action=edit&amp;section=9" title="Edit section: Do not store escaped values">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Consider the JSON value <tt>{"key":"value with \"escaped quotes\""}</tt>:
</p>
<pre>&lt;?php
$escaped_json = '{"key":"value with \\"escaped quotes\\""}';
update_post_meta( $id, 'escaped_json', $escaped_json );
$broken = get_post_meta( $id, 'escaped_json', true );
/*
$broken, after passing through stripslashes() ends up unparsable:
{"key":"value with "escaped quotes""}
*/
?&gt;</pre>
<h3><span class="mw-headline" id="Workaround">Workaround</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/update_post_meta&amp;action=edit&amp;section=10" title="Edit section: Workaround">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>By adding one more level of <tt>\</tt> escaping using function <tt>wp_slash</tt> (introduced in WP 3.6), you can compensate for the call to <tt>stripslashes()</tt>:
</p>
<pre>&lt;?php
$escaped_json = '{"key":"value with \\"escaped quotes\\""}';
update_post_meta( $id, 'double_escaped_json', wp_slash( $escaped_json ) );
$fixed = get_post_meta( $id, 'double_escaped_json', true );
/*
$fixed, after stripslashes(), ends up being stored as desired:
{"key":"value with \"escaped quotes\""}
*/
?&gt;</pre>
<h2><span class="mw-headline" id="Notes">Notes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/update_post_meta&amp;action=edit&amp;section=11" title="Edit section: Notes">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> This function uses <tt><a href="https://codex.wordpress.org/Function_Reference/update_metadata" title="Function Reference/update metadata"> update_metadata()</a></tt>.</li></ul>
<h2><span class="mw-headline" id="Source_Code">Source Code</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/update_post_meta&amp;action=edit&amp;section=12" title="Edit section: Source Code">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><tt>update_post_meta()</tt> is located in <code><a rel="nofollow" class="external text" href="https://core.trac.wordpress.org/browser/tags/5.1.1/src/wp-includes/post.php#L0">wp-includes/post.php</a></code>
</p>
<h2><span class="mw-headline" id="Change_Log">Change Log</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/update_post_meta&amp;action=edit&amp;section=13" title="Edit section: Change Log">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Since <a href="https://codex.wordpress.org/Version_1.5" title="Version 1.5">1.5.0</a>
</p>
<h2><span class="mw-headline" id="Related">Related</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/update_post_meta&amp;action=edit&amp;section=14" title="Edit section: Related">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><a href="https://codex.wordpress.org/Custom_Fields" title="Custom Fields"><b>Custom Fields</b></a>: 
<a href="https://codex.wordpress.org/Function_Reference/the_meta" title="Function Reference/the meta"> the_meta()</a>, 
<a href="https://codex.wordpress.org/Function_Reference/get_post_meta" title="Function Reference/get post meta"> get_post_meta()</a>, 
<a href="https://codex.wordpress.org/Function_Reference/add_post_meta" title="Function Reference/add post meta"> add_post_meta()</a>, 
<strong class="selflink"> update_post_meta()</strong>, 
<a href="https://codex.wordpress.org/Function_Reference/delete_post_meta" title="Function Reference/delete post meta"> delete_post_meta()</a>, 
<a href="https://codex.wordpress.org/Function_Reference/get_post_custom" title="Function Reference/get post custom"> get_post_custom()</a>, 
<a href="https://codex.wordpress.org/Function_Reference/get_post_custom_values" title="Function Reference/get post custom values"> get_post_custom_values()</a>, 
<a href="https://codex.wordpress.org/Function_Reference/get_post_custom_keys" title="Function Reference/get post custom keys"> get_post_custom_keys()</a> 
(See Also: <a href="https://codex.wordpress.org/Function_Reference/post_meta_Function_Examples" title="Function Reference/post meta Function Examples"> post_meta Function Examples</a>)
</p>
<div style="background-color:#F7F7F7; border:1px solid #CCCCCC; color:#000000; padding:7px; margin:0.5em auto 0.5em auto; vertical-align:middle; overflow:hidden;">See also index of <a href="https://codex.wordpress.org/Function_Reference" title="Function Reference">Function Reference</a> and index of <a href="https://codex.wordpress.org/Template_Tags" title="Template Tags">Template Tags</a>.</div>


