<p class="LanguageLinks" style="border:1px solid #CCCCCC; line-height:1.5; text-align:left; color:#333333; font-size:90%; padding:10px;"><span style="white-space:nowrap;"><a href="https://codex.wordpress.org/Multilingual_Codex" title="Multilingual Codex" class="mw-redirect">Languages</a>:</span> 
<strong class="selflink">English</strong> • 
<a rel="nofollow" class="external text" href="https://wpdocs.osdn.jp/関数リファレンス/check_ajax_referer">日本語</a> 
 <small>(<a href="https://codex.wordpress.org/Multilingual_Codex#Language_Cross_Reference" title="Multilingual Codex" class="mw-redirect">Add your language</a>)</small>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Usage"><span class="tocnumber">2</span> <span class="toctext">Usage</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return_Values"><span class="tocnumber">4</span> <span class="toctext">Return Values</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Notes"><span class="tocnumber">6</span> <span class="toctext">Notes</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Change_Log"><span class="tocnumber">7</span> <span class="toctext">Change Log</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Source_File"><span class="tocnumber">8</span> <span class="toctext">Source File</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Related"><span class="tocnumber">9</span> <span class="toctext">Related</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#See_also"><span class="tocnumber">10</span> <span class="toctext">See also</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#External_Resources"><span class="tocnumber">11</span> <span class="toctext">External Resources</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Description">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/check_ajax_referer&amp;action=edit&amp;section=1" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This function can be overridden by <a href="https://codex.wordpress.org/Glossary#plugins" title="Glossary">plugins</a>. If no plugin redefines this function, then the standard functionality will be used.
</p><p>The standard function verifies the AJAX request, to prevent any processing of requests which are passed in by third-party sites or systems.
</p><p>Nonces should never be relied on for authentication, authorization or access control. Protect your functions using <a href="https://codex.wordpress.org/Function_Reference/current_user_can" title="Function Reference/current user can"><tt>current_user_can()</tt></a> and always assume that nonces can be compromised.
</p>
<h2><span class="mw-headline" id="Usage">Usage</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/check_ajax_referer&amp;action=edit&amp;section=2" title="Edit section: Usage">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php&#160;check_ajax_referer</span><span style="color: #007700">(&#160;</span><span style="color: #0000BB">$action</span><span style="color: #007700">,&#160;</span><span style="color: #0000BB">$query_arg</span><span style="color: #007700">,&#160;</span><span style="color: #0000BB">$die&#160;</span><span style="color: #007700">)&#160;</span><span style="color: #0000BB">?&gt;</span>
</span>
</code>
</p>
<h2><span class="mw-headline" id="Parameters">Parameters</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/check_ajax_referer&amp;action=edit&amp;section=3" title="Edit section: Parameters">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<dl><dt> <tt>$action</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#String" title="How to Pass Tag Parameters"><i>string</i></a>) (<i>optional</i>) Action <a href="http://en.wikipedia.org/wiki/Cryptographic_nonce" class="extiw" title="wikipedia:Cryptographic nonce">nonce</a>
<dl><dd> Default: -1</dd></dl></dd></dl>
<dl><dt> <tt>$query_arg</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#String" title="How to Pass Tag Parameters"><i>string</i></a>) (<i>optional</i>) where to look for <a href="http://en.wikipedia.org/wiki/Cryptographic_nonce" class="extiw" title="wikipedia:Cryptographic nonce">nonce</a> in <tt>$_REQUEST</tt> (since 2.5)
<dl><dd> Default: false</dd></dl></dd></dl>
<dl><dt> <tt>$die</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Boolean" title="How to Pass Tag Parameters"><i>boolean</i></a>) (<i>optional</i>) whether to die if the nonce is invalid
<dl><dd> Default: true</dd></dl></dd></dl>
<h2><span class="mw-headline" id="Return_Values">Return Values</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/check_ajax_referer&amp;action=edit&amp;section=4" title="Edit section: Return Values">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<dl><dt> <tt></tt> <tt style="color:gray">(<a href="https://codex.wordpress.org/Glossary#Boolean" title="Glossary"><i>boolean</i></a>)</tt>&#160;</dt>
<dd> If parameter <tt>$die</tt> is set to <tt>false</tt>, this function will return a boolean of <tt>true</tt> if the check passes or <tt>false</tt> if the check fails.</dd></dl>
<h2><span class="mw-headline" id="Examples">Examples</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/check_ajax_referer&amp;action=edit&amp;section=5" title="Edit section: Examples">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>In your main file, set the nonce like this:
</p>
<pre>
&lt;?php
//Set Your Nonce
$ajax_nonce = wp_create_nonce( "my-special-string" );
?&gt;

&lt;script type="text/javascript"&gt;
jQuery(document).ready(function($){
	var data = {
		action: 'my_action',
		security: '&lt;?php echo $ajax_nonce;&#160;?&gt;',
		my_string: 'Hello World!'
	};
	$.post(ajaxurl, data, function(response) {
		alert("Response: " + response);
	});
});
&lt;/script&gt;
</pre>
<p>In your ajax file, check the referrer like this. (As the <tt>$die</tt> parameter isn't set to false in this example, processing will stop immediately if the test fails.)
</p>
<pre>
add_action( 'wp_ajax_my_action', 'my_action_function' );
function my_action_function() {
	check_ajax_referer( 'my-special-string', 'security' );
	echo sanitize_text_field( $_POST['my_string'] );
	wp_die();
}
</pre>
<h2><span class="mw-headline" id="Notes">Notes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/check_ajax_referer&amp;action=edit&amp;section=6" title="Edit section: Notes">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> This function can be replaced via <a href="https://codex.wordpress.org/Glossary#plugins" title="Glossary">plugins</a>. If plugins do not redefine these functions, then this will be used instead.</li>
<li> If <tt>$query_arg</tt> is not specified (i.e. defaults to false), then the function will look for the nonce in <tt>'_ajax_nonce'</tt>. If that is not set, then it will assume that the nonce is in <tt>'_wpnonce'</tt>, regardless of whether that query arg actually exists.</li>
<li> If <tt>$die</tt> is set to <tt>true</tt>, execution of the script will be stopped if the nonce cannot be verified, and the output will be <tt>'-1'</tt>.</li></ul>
<h2><span class="mw-headline" id="Change_Log">Change Log</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/check_ajax_referer&amp;action=edit&amp;section=7" title="Edit section: Change Log">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> Since: <a href="https://codex.wordpress.org/Version_2.0.4" title="Version 2.0.4">2.0.4</a></li></ul>
<h2><span class="mw-headline" id="Source_File">Source File</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/check_ajax_referer&amp;action=edit&amp;section=8" title="Edit section: Source File">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><tt>check_ajax_referer()</tt> is located in <code><a rel="nofollow" class="external text" href="https://core.trac.wordpress.org/browser/tags/5.0.3/src/wp-includes/pluggable.php#L0">wp-includes/pluggable.php</a></code>.
</p>
<h2><span class="mw-headline" id="Related">Related</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/check_ajax_referer&amp;action=edit&amp;section=9" title="Edit section: Related">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><a href="https://codex.wordpress.org/WordPress_Nonces" title="WordPress Nonces"><b>Nonce functions</b></a>: 
<a href="https://codex.wordpress.org/Function_Reference/wp_nonce_ays" title="Function Reference/wp nonce ays">wp_nonce_ays()</a>,
<a href="https://codex.wordpress.org/Function_Reference/wp_nonce_field" title="Function Reference/wp nonce field">wp_nonce_field()</a>,
<a href="https://codex.wordpress.org/Function_Reference/wp_nonce_url" title="Function Reference/wp nonce url">wp_nonce_url()</a>,
<a href="https://codex.wordpress.org/Function_Reference/wp_verify_nonce" title="Function Reference/wp verify nonce">wp_verify_nonce()</a>,
<a href="https://codex.wordpress.org/Function_Reference/wp_create_nonce" title="Function Reference/wp create nonce">wp_create_nonce()</a>,
<a href="https://codex.wordpress.org/Function_Reference/check_admin_referer" title="Function Reference/check admin referer">check_admin_referer()</a>,
<strong class="selflink">check_ajax_referer()</strong>,
<a href="https://codex.wordpress.org/Function_Reference/wp_referer_field" title="Function Reference/wp referer field">wp_referer_field()</a> 
</p>
<h2><span class="mw-headline" id="See_also">See also</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/check_ajax_referer&amp;action=edit&amp;section=10" title="Edit section: See also">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> <a href="https://codex.wordpress.org/Wordpress_Nonce_Implementation" title="Wordpress Nonce Implementation" class="mw-redirect">Wordpress Nonce Implementation</a></li></ul>
<h2><span class="mw-headline" id="External_Resources">External Resources</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Function_Reference/check_ajax_referer&amp;action=edit&amp;section=11" title="Edit section: External Resources">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> <a rel="nofollow" class="external text" href="http://markjaquith.wordpress.com/2006/06/02/wordpress-203-nonces/">Mark Jaquith - WordPress Nonces</a></li>
<li> <a rel="nofollow" class="external text" href="http://www.prelovac.com/vladimir/improving-security-in-wordpress-plugins-using-nonces">Vladimir Prelovac - Using Nonces in WordPress Plugins</a></li>
<li> Wikipedia: <a href="http://en.wikipedia.org/wiki/Cryptographic_nonce" class="extiw" title="wikipedia:Cryptographic nonce">Cryptographic Nonce</a></li>
<li><a rel="nofollow" class="external text" href="https://codeseekah.com/2016/01/21/wordpress-nonces-vulnerabilities/">WordPress Nonce Vulnerabilities | codeseekah.com</a></li>
<li><a rel="nofollow" class="external text" href="https://www.bynicolas.com/code/wordpress-nonce/">Nicolas Sebastiani - How Do WordPress Nonces Really Work </a></li></ul>
<div style="background-color:#F7F7F7; border:1px solid #CCCCCC; color:#000000; padding:7px; margin:0.5em auto 0.5em auto; vertical-align:middle; overflow:hidden;">See also index of <a href="https://codex.wordpress.org/Function_Reference" title="Function Reference">Function Reference</a> and index of <a href="https://codex.wordpress.org/Template_Tags" title="Template Tags">Template Tags</a>.</div>

<!-- 
NewPP limit report
Cached time: 20190211003805
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.028 seconds
Real time usage: 0.340 seconds
Preprocessor visited node count: 183/1000000
Preprocessor generated node count: 740/1000000
Post‐expand include size: 2509/2097152 bytes
Template argument size: 837/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%  169.498      1 - -total
 30.83%   52.254      1 - Template:Tag_Footer
 30.78%   52.174      1 - Template:Languages
 19.32%   32.751      1 - Template:Trac
 12.34%   20.919      3 - Template:Parameter
 11.79%   19.991      1 - Template:ja
 10.24%   17.351      1 - Template:en
  5.67%    9.609      1 - Template:Message
  5.28%    8.955      1 - Template:Return
  0.78%    1.327      1 - Template:Nonce_Functions
-->
