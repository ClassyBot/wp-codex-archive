<p class="LanguageLinks" style="border:1px solid #CCCCCC; line-height:1.5; text-align:left; color:#333333; font-size:90%; padding:10px;"><span style="white-space:nowrap;"><a href="https://codex.wordpress.org/Multilingual_Codex" title="Multilingual Codex" class="mw-redirect">Languages</a>:</span> 
<strong class="selflink">English</strong> • 
<a rel="nofollow" class="external text" href="https://wpdocs.osdn.jp/Creating">Options Pages 日本語</a> 
<a href="https://codex.wordpress.org/%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86_%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B8" title="Создание страниц настройки">Русский</a> • 

<a href="https://codex.wordpress.org/zh-cn:%E6%B7%BB%E5%8A%A0%E5%90%8E%E5%8F%B0%E8%AE%BE%E7%BD%AE%E9%A1%B5" title="zh-cn:添加后台设置页">中文(简体)</a> • 
<a href="/index.php?title=zh-tw:%E6%B7%BB%E5%8A%A0%E5%BE%8C%E8%87%BA%E8%A8%AD%E7%BD%AE%E9%A0%81&amp;action=edit&amp;redlink=1" class="new" title="zh-tw:添加後臺設置頁 (page does not exist)">中文(繁體)</a> • 
 <small>(<a href="https://codex.wordpress.org/Multilingual_Codex#Language_Cross_Reference" title="Multilingual Codex" class="mw-redirect">Add your language</a>)</small>
</p>
<p><br />
<span style="color:red">This article is in transition to meet <a href="https://codex.wordpress.org/Settings_API" title="Settings API">Settings API</a>, which was introduced in <a href="https://codex.wordpress.org/Version_2.7" title="Version 2.7">Version 2.7</a>. For information prior to 2.7 see <a rel="nofollow" class="external text" href="http://codex.wordpress.org/index.php?title=Creating_Options_Pages&amp;oldid=97268">this revision.</a></span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Where_to_Save_the_Code"><span class="tocnumber">2</span> <span class="toctext">Where to Save the Code</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Opening_the_Page"><span class="tocnumber">3</span> <span class="toctext">Opening the Page</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Form_Tag"><span class="tocnumber">4</span> <span class="toctext">Form Tag</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#settings_fields_Function"><span class="tocnumber">4.1</span> <span class="toctext">settings_fields Function</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#do_settings_fields_Function"><span class="tocnumber">4.2</span> <span class="toctext">do_settings_fields Function</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Closing_Tags"><span class="tocnumber">5</span> <span class="toctext">Closing Tags</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Register_Settings"><span class="tocnumber">5.1</span> <span class="toctext">Register Settings</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#See_It_All_Together"><span class="tocnumber">5.2</span> <span class="toctext">See It All Together</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="#Example_.232"><span class="tocnumber">5.2.1</span> <span class="toctext">Example #2</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#Pitfalls"><span class="tocnumber">5.2.2</span> <span class="toctext">Pitfalls</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="#External_Resources"><span class="tocnumber">6</span> <span class="toctext">External Resources</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Introduction">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Creating_Options_Pages&amp;action=edit&amp;section=1" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Creating <b> custom options </b> panels in WordPress is relatively easy.
</p><p>First, to create the menu item and the new page, see <a href="https://codex.wordpress.org/Adding_Administration_Menus" title="Adding Administration Menus" class="mw-redirect">Adding Administration Menus</a>.
</p><p>So long as you stick to this structure, WordPress will handle all of the option creation, update, saving, and redirection for you. It will check permissions, and do all that other magic behind the scenes.
</p><p>Several new functions were added in WordPress 2.7. These new functions are optional in WordPress 2.7 but will be required in the future. They are required for WordPress MU 2.7. See <a href="https://codex.wordpress.org/Migrating_Plugins_and_Themes_to_2.7" title="Migrating Plugins and Themes to 2.7">Migrating Plugins and Themes to 2.7</a> and <a href="https://codex.wordpress.org/Settings_API" title="Settings API">Settings API</a> for more information.
</p><p>This article only covers the markup of the Settings page itself. For more information regarding how to add the Settings page, refer to <a href="https://codex.wordpress.org/Administration_Menus" title="Administration Menus">Administration Menus</a>
</p>
<h2><span class="mw-headline" id="Where_to_Save_the_Code">Where to Save the Code</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Creating_Options_Pages&amp;action=edit&amp;section=2" title="Edit section: Where to Save the Code">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>You can either put the code for your options page in your plugin php file (or, for Themes, in functions.php), or you can create a second file called options.php, for example, and include it using the php include function - <a rel="nofollow" class="external free" href="http://php.net/manual/en/function.include.php">http://php.net/manual/en/function.include.php</a>
</p>
<h2><span class="mw-headline" id="Opening_the_Page">Opening the Page</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Creating_Options_Pages&amp;action=edit&amp;section=3" title="Edit section: Opening the Page">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>If you'd like to match the look and feel of existing WordPress options pages, open with the following:
</p>
<pre>&lt;div class="wrap"&gt;
&lt;h1&gt;Your Plugin Page Title&lt;/h1&gt;
</pre>
<h2><span class="mw-headline" id="Form_Tag">Form Tag</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Creating_Options_Pages&amp;action=edit&amp;section=4" title="Edit section: Form Tag">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Once you have your page, you need to create an HTML form. Use this code:
</p>
<pre>&lt;form method="post" action="options.php"&gt; 
</pre>
<p><br />
</p>
<h3><span class="mw-headline" id="settings_fields_Function">settings_fields Function</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Creating_Options_Pages&amp;action=edit&amp;section=5" title="Edit section: settings fields Function">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The setting fields will know which settings your options page will handle.
</p><p>After the opening form tag, add this function
</p>
<pre>settings_fields( 'myoption-group' );
</pre>
<p>where <tt>myoption-group</tt> is the same name used in the <a href="https://codex.wordpress.org/Function_Reference/register_setting" title="Function Reference/register setting">register_setting</a> function.
</p><p>This function <b>replaces</b> the <b>nonce magic</b>, <b>action field</b>, and <b>page_options field</b> required prior to Version 2.7.
</p>
<h3><span class="mw-headline" id="do_settings_fields_Function">do_settings_fields Function</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Creating_Options_Pages&amp;action=edit&amp;section=6" title="Edit section: do settings fields Function">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>After the settings_fields() call, add this function
</p>
<pre>do_settings_sections( 'myoption-group' );
</pre>
<p>This function <b>replaces</b> the form-field markup in the form itself.
</p>
<h2><span class="mw-headline" id="Closing_Tags">Closing Tags</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Creating_Options_Pages&amp;action=edit&amp;section=7" title="Edit section: Closing Tags">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Then obviously close the form tag after your other options, and if you like, include another "Update Options" button, this is the WordPress default.
</p>
<pre>&lt;?php submit_button();&#160;?&gt;
&lt;/form&gt;
&lt;/div&gt;
</pre>
<p>You can personalize the button created by <a href="https://codex.wordpress.org/Function_Reference/submit_button" title="Function Reference/submit button">submit_button</a> function.
</p><p>Note the use of the _e() function to handle translation of the text, see <a href="https://codex.wordpress.org/Localizing_WordPress" title="Localizing WordPress" class="mw-redirect">Localizing WordPress</a> for more info.
</p>
<h3><span class="mw-headline" id="Register_Settings">Register Settings</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Creating_Options_Pages&amp;action=edit&amp;section=8" title="Edit section: Register Settings">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The <a href="https://codex.wordpress.org/Function_Reference/register_setting" title="Function Reference/register setting">register_setting</a> and <a href="https://codex.wordpress.org/Function_Reference/unregister_setting" title="Function Reference/unregister setting">unregister_setting</a> functions add and remove options from a whitelist of allowed options that the form is able to save. They can also name a sanitize callback function as a security measure to check each option's value.
</p><p>The register_setting function should be called in an <a href="https://codex.wordpress.org/Plugin_API/Action_Reference#Administrative_Actions" title="Plugin API/Action Reference">admin_init</a> action, which runs before every admin page and in particular, <tt>options.php</tt>, which receives this form.
</p><p>Your plugin probably has a section with an add_action that adds a new menu item to the administration menus. This line will be in the same section to add an action to admin_init.
</p>
<pre>
if ( is_admin() ){ // admin actions
  add_action( 'admin_menu', 'add_mymenu' );
  add_action( 'admin_init', 'register_mysettings' );
} else {
  // non-admin enqueues, actions, and filters
}
</pre>
<p>Then you create a new function that registers each option.
</p>
<pre>
function register_mysettings() { // whitelist options
  register_setting( 'myoption-group', 'new_option_name' );
  register_setting( 'myoption-group', 'some_other_option' );
  register_setting( 'myoption-group', 'option_etc' );
}
</pre>
<p>The name of <tt>myoption-group</tt> doesn't matter but it has to match the name used in the settings_fields function above.
</p><p><br />
</p>
<h3><span class="mw-headline" id="See_It_All_Together">See It All Together</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Creating_Options_Pages&amp;action=edit&amp;section=9" title="Edit section: See It All Together">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Please note: Some of the code in this example (particularly do_settings) is deprecated. <a rel="nofollow" class="external text" href="http://ottopress.com/2009/wordpress-settings-api-tutorial/">View Otto's tutorial here for better examples of workable code</a>.   In addition, there's another <a rel="nofollow" class="external text" href="http://planetozh.com/blog/2009/05/handling-plugins-options-in-wordpress-28-with-register_setting/">article</a> available by <a rel="nofollow" class="external text" href="http://planetozh.com/blog/about/">ozh</a>.
</p><p>To add icon to for your options page use the following code [this will work on version 3.4.2 and later] In following example, icon is stored in "images" folder in theme directory.
</p>
<pre>&lt;?php add_menu_page('My Cool Plugin Settings', 'Cool Settings', 'administrator', __FILE__, 'my_cool_plugin_settings_page', get_stylesheet_directory_uri('stylesheet_directory')."/images/media-button-other.gif");&#160;?&gt;</pre>
<p>The below example uses the new Settings API to create and save your plugin options
</p>
<pre>
&lt;?php
// create custom plugin settings menu
add_action('admin_menu', 'my_cool_plugin_create_menu');

function my_cool_plugin_create_menu() {

	//create new top-level menu
	add_menu_page('My Cool Plugin Settings', 'Cool Settings', 'administrator', __FILE__, 'my_cool_plugin_settings_page' , plugins_url('/images/icon.png', __FILE__) );

	//call register settings function
	add_action( 'admin_init', 'register_my_cool_plugin_settings' );
}


function register_my_cool_plugin_settings() {
	//register our settings
	register_setting( 'my-cool-plugin-settings-group', 'new_option_name' );
	register_setting( 'my-cool-plugin-settings-group', 'some_other_option' );
	register_setting( 'my-cool-plugin-settings-group', 'option_etc' );
}

function my_cool_plugin_settings_page() {
?&gt;
&lt;div class="wrap"&gt;
&lt;h1&gt;Your Plugin Name&lt;/h1&gt;

&lt;form method="post" action="options.php"&gt;
    &lt;?php settings_fields( 'my-cool-plugin-settings-group' );&#160;?&gt;
    &lt;?php do_settings_sections( 'my-cool-plugin-settings-group' );&#160;?&gt;
    &lt;table class="form-table"&gt;
        &lt;tr valign="top"&gt;
        &lt;th scope="row"&gt;New Option Name&lt;/th&gt;
        &lt;td&gt;&lt;input type="text" name="new_option_name" value="&lt;?php echo esc_attr( get_option('new_option_name') );&#160;?&gt;" /&gt;&lt;/td&gt;
        &lt;/tr&gt;
         
        &lt;tr valign="top"&gt;
        &lt;th scope="row"&gt;Some Other Option&lt;/th&gt;
        &lt;td&gt;&lt;input type="text" name="some_other_option" value="&lt;?php echo esc_attr( get_option('some_other_option') );&#160;?&gt;" /&gt;&lt;/td&gt;
        &lt;/tr&gt;
        
        &lt;tr valign="top"&gt;
        &lt;th scope="row"&gt;Options, Etc.&lt;/th&gt;
        &lt;td&gt;&lt;input type="text" name="option_etc" value="&lt;?php echo esc_attr( get_option('option_etc') );&#160;?&gt;" /&gt;&lt;/td&gt;
        &lt;/tr&gt;
    &lt;/table&gt;
    
    &lt;?php submit_button();&#160;?&gt;

&lt;/form&gt;
&lt;/div&gt;
&lt;?php }&#160;?&gt;
</pre>
<h4><span class="mw-headline" id="Example_.232">Example #2</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Creating_Options_Pages&amp;action=edit&amp;section=10" title="Edit section: Example #2">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>This example works on WP 3.5.1.  Much simpler and simply works.  This is an updated version of <a rel="nofollow" class="external text" href="http://ottopress.com/2009/wordpress-settings-api-tutorial/">Otto's tutorial</a>.
</p>
<pre>
&lt;?php
class MySettingsPage
{
    /**
     * Holds the values to be used in the fields callbacks
     */
    private $options;

    /**
     * Start up
     */
    public function __construct()
    {
        add_action( 'admin_menu', array( $this, 'add_plugin_page' ) );
        add_action( 'admin_init', array( $this, 'page_init' ) );
    }

    /**
     * Add options page
     */
    public function add_plugin_page()
    {
        // This page will be under "Settings"
        add_options_page(
            'Settings Admin', 
            'My Settings', 
            'manage_options', 
            'my-setting-admin', 
            array( $this, 'create_admin_page' )
        );
    }

    /**
     * Options page callback
     */
    public function create_admin_page()
    {
        // Set class property
        $this-&gt;options = get_option( 'my_option_name' );
       &#160;?&gt;
        &lt;div class="wrap"&gt;
            &lt;h1&gt;My Settings&lt;/h1&gt;
            &lt;form method="post" action="options.php"&gt;
            &lt;?php
                // This prints out all hidden setting fields
                settings_fields( 'my_option_group' );
                do_settings_sections( 'my-setting-admin' );
                submit_button();
           &#160;?&gt;
            &lt;/form&gt;
        &lt;/div&gt;
        &lt;?php
    }

    /**
     * Register and add settings
     */
    public function page_init()
    {        
        register_setting(
            'my_option_group', // Option group
            'my_option_name', // Option name
            array( $this, 'sanitize' ) // Sanitize
        );

        add_settings_section(
            'setting_section_id', // ID
            'My Custom Settings', // Title
            array( $this, 'print_section_info' ), // Callback
            'my-setting-admin' // Page
        );  

        add_settings_field(
            'id_number', // ID
            'ID Number', // Title 
            array( $this, 'id_number_callback' ), // Callback
            'my-setting-admin', // Page
            'setting_section_id' // Section           
        );      

        add_settings_field(
            'title', 
            'Title', 
            array( $this, 'title_callback' ), 
            'my-setting-admin', 
            'setting_section_id'
        );      
    }

    /**
     * Sanitize each setting field as needed
     *
     * @param array $input Contains all settings fields as array keys
     */
    public function sanitize( $input )
    {
        $new_input = array();
        if( isset( $input['id_number'] ) )
            $new_input['id_number'] = absint( $input['id_number'] );

        if( isset( $input['title'] ) )
            $new_input['title'] = sanitize_text_field( $input['title'] );

        return $new_input;
    }

    /** 
     * Print the Section text
     */
    public function print_section_info()
    {
        print 'Enter your settings below:';
    }

    /** 
     * Get the settings option array and print one of its values
     */
    public function id_number_callback()
    {
        printf(
            '&lt;input type="text" id="id_number" name="my_option_name[id_number]" value="%s" /&gt;',
            isset( $this-&gt;options['id_number'] )&#160;? esc_attr( $this-&gt;options['id_number'])&#160;: ''
        );
    }

    /** 
     * Get the settings option array and print one of its values
     */
    public function title_callback()
    {
        printf(
            '&lt;input type="text" id="title" name="my_option_name[title]" value="%s" /&gt;',
            isset( $this-&gt;options['title'] )&#160;? esc_attr( $this-&gt;options['title'])&#160;: ''
        );
    }
}

if( is_admin() )
    $my_settings_page = new MySettingsPage();
</pre>
<p>This will create something like this:
</p><p><a href="https://codex.wordpress.org/File:creating-options-pages-ex-2b.png" class="image"><img alt="creating-options-pages-ex-2b.png" src="/images/6/64/creating-options-pages-ex-2b.png" width="437" height="244" /></a>
</p><p><br />
Example 3 
</p><p>full example for options.php to get the values see after the code 
</p>
<pre>
&lt;?php

    $themename = "base-theme";
    $shortname = "mnt";
	
	/* functions to andale the options array  */
	
	function mnt_get_formatted_page_array() { 
		global $suffusion_pages_array;
		if (isset($suffusion_pages_array) &amp;&amp; $suffusion_pages_array&#160;!= null) {
			return $suffusion_pages_array;
		}
		$ret = array();
		$pages = get_pages('sort_column=menu_order');
		if ($pages&#160;!= null) {
			foreach ($pages as $page) {
				if (is_null($suffusion_pages_array)) {
					$ret[$page-&gt;ID] = array ("title" =&gt; $page-&gt;post_title, "depth" =&gt; count(get_ancestors($page-&gt;ID, 'page')));
				}
			}
		}
		if ($suffusion_pages_array == null) {
			$suffusion_pages_array = $ret;
			return $ret;
		}
		else {
			return $suffusion_pages_array;
		}
	 }
	
	function mnt_get_category_array() { 
		global $suffusion_category_array;
		if (isset($suffusion_category_array) &amp;&amp; $suffusion_category_array&#160;!= null) {
			return $suffusion_category_array;
		}
		$ret = array();
		$args = array(
	  'orderby' =&gt; 'name',
	  'parent' =&gt; 0
	  );
	$categories = get_categories( $args );
	if($categories&#160;!= null){
		foreach ($categories as $category) {
				if (is_null($suffusion_category_array)) {
					$ret[$category-&gt;cat_ID] = array ("name" =&gt; $category-&gt;name, "number" =&gt; $category-&gt;count);
				}
			}
		}
		
		if ($suffusion_category_array == null) {
			$suffusion_category_array = $ret;
			return $ret;
		}
		else {
			return $suffusion_category_array;
		}
	 }
	
	function create_opening_tag($value) { 
		$group_class = "";
		if (isset($value['grouping'])) {
			$group_class = "suf-grouping-rhs";
		}
		echo '&lt;div class="suf-section fix"&gt;'."\n";
		if ($group_class&#160;!= "") {
			echo "&lt;div class='$group_class fix'&gt;\n";
		}
		if (isset($value['name'])) {
			echo "&lt;h3&gt;" . $value['name'] . "&lt;/h3&gt;\n";
		}
		if (isset($value['desc']) &amp;&amp;&#160;!(isset($value['type']) &amp;&amp; $value['type'] == 'checkbox')) {
			echo $value['desc']."&lt;br /&gt;";
		}
		if (isset($value['note'])) {
			echo "&lt;span class=\"note\"&gt;".$value['note']."&lt;/span&gt;&lt;br /&gt;";
		}
	 }

	/**
	 * Creates the closing markup for each option.
	 *
	 * @param $value
	 * @return void
	 */
	function create_closing_tag($value) { 
		if (isset($value['grouping'])) {
			echo "&lt;/div&gt;\n";
		}
		//echo "&lt;/div&gt;&lt;!-- suf-section --&gt;\n";
		echo "&lt;/div&gt;\n";
	 }
		
	function create_suf_header_3($value) { echo '&lt;h3 class="suf-header-3"&gt;'.$value['name']."&lt;/h3&gt;\n"; }
		
	function create_section_for_text($value) { 
		create_opening_tag($value);
		$text = "";
		if (get_option($value['id']) === FALSE) {
			$text = $value['std'];
		}
		else {
			$text = get_option($value['id']);
		}
	 
		echo '&lt;input type="text" id="'.$value['id'].'" placeholder="enter your title" name="'.$value['id'].'" value="'.$text.'" /&gt;'."\n";
		create_closing_tag($value);
	 }
	
	function create_section_for_textarea($value) { 
		create_opening_tag($value);
		echo '&lt;textarea name="'.$value['id'].'" type="textarea" cols="" rows=""&gt;'."\n";
		if ( get_option( $value['id'] )&#160;!= "") {
			echo get_option( $value['id'] );
		}
		else {
			echo $value['std'];
		}
		echo '&lt;/textarea&gt;';
		create_closing_tag($value);
	 }
	
	function create_section_for_color_picker($value) { 
		create_opening_tag($value);
		$color_value = "";
		if (get_option($value['id']) === FALSE) {
			$color_value = $value['std'];
		}
		else {
			$color_value = get_option($value['id']);
		}
	 
		echo '&lt;div class="color-picker"&gt;'."\n";
		echo '&lt;input type="text" id="'.$value['id'].'" name="'.$value['id'].'" value="'.$color_value.'" class="color" /&gt;';
		echo ' &#171; Click to select color&lt;br/&gt;'."\n";
		echo "&lt;strong&gt;Default: &lt;font color='".$value['std']."'&gt; ".$value['std']."&lt;/font&gt;&lt;/strong&gt;";
		echo " (You can copy and paste this into the box above)\n";
		echo "&lt;/div&gt;\n";
		create_closing_tag($value);
	 }
	
	function create_section_for_radio($value) { 
		create_opening_tag($value);
		foreach ($value['options'] as $option_value =&gt; $option_text) {
			$checked = ' ';
			if (get_option($value['id']) == $option_value) {
				$checked = ' checked="checked" ';
			}
			else if (get_option($value['id']) === FALSE &amp;&amp; $value['std'] == $option_value){
				$checked = ' checked="checked" ';
			}
			else {
				$checked = ' ';
			}
			echo '&lt;div class="mnt-radio"&gt;&lt;input type="radio" name="'.$value['id'].'" value="'.
				$option_value.'" '.$checked."/&gt;".$option_text."&lt;/div&gt;\n";
		}
		create_closing_tag($value);
	 }

	function create_section_for_multi_select($value) { 
		create_opening_tag($value);
		echo '&lt;ul class="mnt-checklist" id="'.$value['id'].'" &gt;'."\n";
		foreach ($value['options'] as $option_value =&gt; $option_list) {
			$checked = " ";
			if (get_option($value['id']."_".$option_value)) {
				$checked = " checked='checked' ";
			}
			echo "&lt;li&gt;\n";
			echo '&lt;input type="checkbox" name="'.$value['id']."_".$option_value.'" value="true" '.$checked.' class="depth-'.($option_list['depth']+1).'" /&gt;'.$option_list['title']."\n";
			echo "&lt;/li&gt;\n";
		}
		echo "&lt;/ul&gt;\n";
		create_closing_tag($value);
	 }
	
	function create_section_for_category_select($page_section,$value) { 
		create_opening_tag($value);
		$all_categoris='';
			echo '&lt;div class="wrap" id="'.$value['id'].'" &gt;'."\n";
			echo '&lt;h1&gt;Theme Options&lt;/h1&gt; '."\n" .'
				&lt;p&gt;&lt;strong&gt;'.$page_section.':&lt;/strong&gt;&lt;/p&gt;';
				echo "&lt;select id='".$value['id']."' class='post_form' name='".$value['id']."' value='true'&gt;\n";
				echo "&lt;option id='all' value=''&gt;All&lt;/option&gt;";
			foreach ($value['options'] as $option_value =&gt; $option_list) {
				$checked = ' ';
				echo 'value_id=' . $value['id'] .' value_id=' . get_option($value['id']) . ' options_value=' . $option_value;
			if (get_option($value['id']) == $option_value) {
				$checked = ' checked="checked" ';
			}
			else if (get_option($value['id']) === FALSE &amp;&amp; $value['std'] == $option_value){
				$checked = ' checked="checked" ';
			}
			else {
				$checked = '';
			}
				echo '&lt;option value="'.$option_list['name'].'" class="level-0" '.$checked.' number="'.($option_list['number']).'" /&gt;'.$option_list['name']."&lt;/option&gt;\n";
				//$all_categoris .= $option_list['name'] . ',';
			}	
			echo "&lt;/select&gt;\n &lt;/div&gt;";
			//echo '&lt;script&gt;jQuery("#all").val("'.$all_categoris.'")&lt;/\script&gt;';
		create_closing_tag($value);
	 }

	$options = array( 
		array("name" =&gt; "Header Customization",
				"type" =&gt; "sub-section-3",
				"category" =&gt; "header-styles",
		),
		array("name" =&gt; "Header Image",
				"desc" =&gt; "Set the image to use for the header background. ",
				"id" =&gt; $shortname."_header_background_image",
				"type" =&gt; "text",
				"parent" =&gt; "header-styles",
				"std" =&gt; ""),
		array("name" =&gt; "Body Background Settings",
				"type" =&gt; "sub-section-3",
				"category" =&gt; "body-styles",
		),
		array("name" =&gt; "Body Background Color",
				"desc" =&gt; "Set the color of the background on which the page is. ",
				"id" =&gt; $shortname."_body_background_color",
				"type" =&gt; "color-picker",
				"parent" =&gt; "body-styles",
				"std" =&gt; "444444"),
		array("name" =&gt; "Sidebar Setup",
				"type" =&gt; "sub-section-3",
				"category" =&gt; "sidebar-setup",
		),
		array("name" =&gt; "Sidebar Position",
				"id" =&gt; $shortname."_sidebar_alignment",
				"type" =&gt; "radio",
				"desc" =&gt; "Which side would you like your sidebar?",
				"options" =&gt; array("left" =&gt; "Left", "right" =&gt; "Right"),
				"parent" =&gt; "sidebar-setup",
				"std" =&gt; "right"),
		array("name" =&gt; "Navigation Bar Setup",
				"type" =&gt; "sub-section-3",
				"category" =&gt; "nav-setup",
		),
		array("name" =&gt; "Pages to show in Navigation Bar",
				"desc" =&gt; "Select the pages you want to include. All pages are excluded by default",
				"id" =&gt; $shortname."_nav_pages",
				"type" =&gt; "multi-select",
				"options" =&gt; mnt_get_formatted_page_array($shortname."_nav_pages"),
				"parent" =&gt; "nav-setup",
				"std" =&gt; "none"
		),
		array("name" =&gt; "Analytics",
				"type" =&gt; "sub-section-3",
				"category" =&gt; "analytics-setup",
		),
		array("name" =&gt; "Custom Google Analytics Tracking Code",
				"desc" =&gt; "Enter your tracking code here for Google Analytics",
				"id" =&gt; $shortname."_custom_analytics_code",
				"type" =&gt; "textarea",
				"parent" =&gt; "analytics-setup",
				"std" =&gt; ""
		),
		array("name" =&gt; "category posts to show on the front page",
				"desc" =&gt; "Select the category you want to include. All pages are excluded by default",
				"id" =&gt; $shortname."_front_page_first_section",
				"type" =&gt; "select",
				"options" =&gt; mnt_get_category_array($shortname."_nav_pages"),
				"parent" =&gt; "nav-setup",
				"std" =&gt; mnt_get_category_array($shortname."_nav_pages")
		),
		array("name" =&gt; "category posts to show on the front page below",
				"desc" =&gt; "Select the category you want to include. All pages are excluded by default",
				"id" =&gt; $shortname."_front_page_second_section",
				"type" =&gt; "select-2",
				"options" =&gt; mnt_get_category_array($shortname."_nav_pages"),
				"parent" =&gt; "nav-setup",
				"std" =&gt; mnt_get_category_array($shortname."_nav_pages")
		),
	 );
	
	function create_form($options) { 
		echo "&lt;form id='options_form' method='post' name='form' &gt;\n";
		foreach ($options as $value) {
			switch ( $value['type'] ) {
				case "sub-section-3":
					create_suf_header_3($value);
					break;
	 
				case "text";
					create_section_for_text($value);
					break;
	 
				case "textarea":
					create_section_for_textarea($value);
					break;
	 
				case "multi-select":
					create_section_for_multi_select($value);
					break;
	 
				case "radio":
					create_section_for_radio($value);
					break;
	 
				case "color-picker":
					create_section_for_color_picker($value);
					break;
				case "select":
					create_section_for_category_select('first section',$value);
					break;
				case "select-2":
					create_section_for_category_select('second section',$value);
					break;
			}
		}
		
		?&gt; 
		&lt;input name="save" type="button" value="Save" class="button" onclick="submit_form(this, document.forms['form'])" /&gt;
		&lt;input name="reset_all" type="button" value="Reset to default values" class="button" onclick="submit_form(this, document.forms['form'])" /&gt;
		&lt;input type="hidden" name="formaction" value="default" /&gt;
	
     &lt;script&gt; function submit_form(element, form){ 
				 form['formaction'].value = element.name;
				 form.submit();
			 } &lt;/script&gt;
    
		&lt;/form&gt;
	&lt;?php } &#160;?&gt;
	
    		
	
	&lt;?php
   
add_action('admin_menu', 'mynewtheme_add_admin');   
function mynewtheme_add_admin() { 
    global $themename, $shortname, $options, $spawned_options;
 
    if ( $_GET['page'] == basename(__FILE__) ) {
        if ( 'save' == $_REQUEST['formaction'] ) {
            foreach ($options as $value) {
                if( isset( $_REQUEST[ $value['id'] ] ) ) {
                    update_option( $value['id'], $_REQUEST[ $value['id'] ]  );
                }
                else {
                    delete_option( $value['id'] );
                }
            }
 
            foreach ($spawned_options as $value) {
                if( isset( $_REQUEST[ $value['id'] ] ) ) {
                    update_option( $value['id'], $_REQUEST[ $value['id'] ]  );
                }
                else {
                    delete_option( $value['id'] );
                }
            }
			header("Location: themes.php?page=options.php&amp;saved=true");
            die;
        }
        else if('reset_all' == $_REQUEST['formaction']) {
            foreach ($options as $value) {
                delete_option( $value['id'] );
            }
 
            foreach ($spawned_options as $value) {
                delete_option( $value['id'] );
            }
 			header("Location: themes.php?page=options.php&amp;".$_REQUEST['formaction']."=true");
            die;
        }
  }

add_theme_page($themename." Theme Options", "".$themename." Theme Options", 
        'edit_themes', basename(__FILE__), 'mynewtheme_admin'); }

function mynewtheme_admin() { 
    global $themename, $shortname, $options, $spawned_options, $theme_name;
 
    if ($_REQUEST['saved']) {
        echo '&lt;div id="message" class="updated fade"&gt;&lt;p&gt;&lt;strong&gt;'.$themename.' settings saved for this page.&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;';
    }
    if ($_REQUEST['reset_all']) {
        echo '&lt;div id="message" class="updated fade"&gt;&lt;p&gt;&lt;strong&gt;'.$themename.' settings reset.&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;';
    }
   &#160;?&gt;
&lt;div class="wrap"&gt;
    &lt;h1&gt;Settings for &lt;?php echo $themename;&#160;?&gt;&lt;/h1&gt;
    &lt;div class="mnt-options"&gt;
&lt;?php
    create_form($options);
?&gt;
    &lt;/div&gt;&lt;!-- mnt-options --&gt;
&lt;/div&gt;&lt;!-- wrap --&gt;
&lt;?php } // end function mynewtheme_admin()
?&gt;

</pre>
<p>the code will create something like this:
</p><p><a href="https://codex.wordpress.org/File:Capture.PNG" class="image"><img alt="Capture.PNG" src="/images/c/c7/Capture.PNG" width="455" height="738" /></a>
</p><p>to get the values from the options.php after submit put this code in the page you want to get the value in the head of the page 
</p>
<pre>
&lt;?php 
global $options;
foreach ($options as $value) {
    if (get_option($value['id']) === FALSE) {
        $$value['id'] = $value['std'];
    }
    else {
        $$value['id'] = get_option( $value['id'] );
    }
}?&gt;
</pre>
<p>to get the value 
</p>
<pre>
if (trim($mnt_front_page_first_section)&#160;!= "") 
     	$first_section_category=$mnt_front_page_first_section;
//$mnt_front_page_first_section = the element id from the $options array
/*
array("name" =&gt; "category posts to show on the front page",
				"desc" =&gt; "Select the category you want to include. All pages are excluded by default",
				"id" =&gt; $shortname."_front_page_first_section",//&lt;- id
				"type" =&gt; "select",
				"options" =&gt; mnt_get_category_array($shortname."_nav_pages"),
				"parent" =&gt; "nav-setup",
				"std" =&gt; mnt_get_category_array($shortname."_nav_pages")
		),
*/
</pre>
<h4><span class="mw-headline" id="Pitfalls">Pitfalls</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Creating_Options_Pages&amp;action=edit&amp;section=11" title="Edit section: Pitfalls">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The <b>Settings</b> name, the second parameter in the <i>register_setting()</i> function, MUST match the name of the option being updated in the database!
<br />
For example, say you have <b>add_option( 'foo_bar', 'isfoo' )</b>, you MUST use <b>foo_bar</b> as the second parameter for the <b>register_setting()</b> function.  Otherwise WordPress does not know which setting it is suppose to update and it will fail to update.
</p><p>To show the menu in <b>Multisite</b> network screen, it would be a matter of doing:<br />
<tt>add_action( is_multisite()&#160;? 'network_admin_menu'&#160;: 'admin_menu', 'callback_function' );</tt><br />
But the form save action leads to a 404 page: <tt>/wp-admin/network/options.php</tt>.<br />
To solve it, use the solution in <a rel="nofollow" class="external text" href="http://wordpress.stackexchange.com/a/72503">this WordPress Answers post</a>, or alternatively the one in <a rel="nofollow" class="external text" href="http://code.hyperspatial.com/1250/save-plugin-options-multisite-3-1/">this blog post</a>.
</p>
<h2><span class="mw-headline" id="External_Resources">External Resources</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Creating_Options_Pages&amp;action=edit&amp;section=12" title="Edit section: External Resources">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li><a rel="nofollow" class="external text" href="https://github.com/bueltge/WordPress-Admin-Style">WordPress Admin Style</a> (19July16)</li>
<li><a rel="nofollow" class="external text" href="https://github.com/helen/wp-style-guide">WordPress Admin Pattern Library</a> (16July15)</li></ul>

<!-- 
NewPP limit report
Cached time: 20190429052948
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.028 seconds
Real time usage: 0.034 seconds
Preprocessor visited node count: 161/1000000
Preprocessor generated node count: 514/1000000
Post‐expand include size: 854/2097152 bytes
Template argument size: 416/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    6.861      1 - -total
100.00%    6.861      1 - Template:Languages
 16.16%    1.109      1 - Template:ja
 15.94%    1.094      1 - Template:zh-tw
 15.10%    1.036      1 - Template:zh-cn
 15.01%    1.030      1 - Template:ru
 14.82%    1.017      1 - Template:en
-->
