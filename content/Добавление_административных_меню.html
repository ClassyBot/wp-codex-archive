<p class="LanguageLinks" style="border:1px solid #CCCCCC; line-height:1.5; text-align:left; color:#333333; font-size:90%; padding:10px;"><span style="white-space:nowrap;"><a href="https://codex.wordpress.org/Multilingual_Codex" title="Multilingual Codex" class="mw-redirect">Languages</a>:</span> 
<a href="https://codex.wordpress.org/Adding_Administration_Menus" title="Adding Administration Menus" class="mw-redirect">English</a> • 
<a rel="nofollow" class="external text" href="https://wpdocs.osdn.jp/Adding">Administration Menus 日本語</a> 
<strong class="selflink">Русский</strong> • 

 <small>(<a href="https://codex.wordpress.org/Multilingual_Codex#Language_Cross_Reference" title="Multilingual Codex" class="mw-redirect">Add your language</a>)</small>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.D0.92.D1.81.D1.82.D1.83.D0.BF.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5"><span class="tocnumber">1</span> <span class="toctext">Вступление</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#.D0.9C.D0.B5.D0.BD.D1.8E_.D0.B8_.D0.9F.D0.BE.D0.B4.D0.BC.D0.B5.D0.BD.D1.8E"><span class="tocnumber">2</span> <span class="toctext">Меню и Подменю</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Admin_Menu_Functions"><span class="tocnumber">3</span> <span class="toctext">Admin Menu Functions</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#.D0.9C.D0.B5.D0.BD.D1.8E_.D0.B2.D0.B5.D1.80.D1.85.D0.BD.D0.B5.D0.B3.D0.BE_.D1.83.D1.80.D0.BE.D0.B2.D0.BD.D1.8F"><span class="tocnumber">3.1</span> <span class="toctext">Меню верхнего уровня</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Sub-Menus"><span class="tocnumber">3.2</span> <span class="toctext">Sub-Menus</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#.D0.92.D1.81.D1.82.D0.B0.D0.B2.D0.BA.D0.B0_.D1.81.D1.82.D1.80.D0.B0.D0.BD.D0.B8.D1.86"><span class="tocnumber">3.3</span> <span class="toctext">Вставка страниц</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Sample_Menu_Page"><span class="tocnumber">3.4</span> <span class="toctext">Sample Menu Page</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id=".D0.92.D1.81.D1.82.D1.83.D0.BF.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5">Вступление</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D1%8B%D1%85_%D0%BC%D0%B5%D0%BD%D1%8E&amp;action=edit&amp;section=1" title="Edit section: Вступление">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Многие плагины создают своим пользователям опции и настройки, которые позволяют настроить плагин. Как у автора плагина, у Вас есть несколько вариантов для реализации этой возможности. Одна из них - дать пользователю возможность редактировать код PHP, но это будет для большинства пользователей неудобно. Более привычный вариант - создать специальную страницу в административной части для управления определенными опциями плагина.
</p><p>Эта статья объясняет как добавить собственное административное меню в WordPress. Это предполагает что вы уже знакомы с основами <a href="https://codex.wordpress.org/%D0%9D%D0%B0%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BF%D0%BB%D0%B0%D0%B3%D0%B8%D0%BD%D0%B0" title="Написание плагина">Написание плагина</a> и <a href="https://codex.wordpress.org/Plugin_API" title="Plugin API">Plugin API</a> действий и фильтров.
</p>
<h2><span class="mw-headline" id=".D0.9C.D0.B5.D0.BD.D1.8E_.D0.B8_.D0.9F.D0.BE.D0.B4.D0.BC.D0.B5.D0.BD.D1.8E">Меню и Подменю</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D1%8B%D1%85_%D0%BC%D0%B5%D0%BD%D1%8E&amp;action=edit&amp;section=2" title="Edit section: Меню и Подменю">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Первый шаг в создании собственного административного меню — определить, к какому системному меню WordPress оно относится. Большинство плагинов добавляют свои меню в существующий верхний уровень меню WordPress. Вот руководство, что принадлежит к каждому меню верхнего уровня:
</p>
<dl><dt><a href="https://codex.wordpress.org/Administration_Panels#Settings_-_Configuration_Settings" title="Administration Panels" class="mw-redirect">Settings / Настройки</a></dt>
<dd>Отобажение настроек плагина которые доступны только администратору (также смотрите <a href="https://codex.wordpress.org/%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86_%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B8" title="Создание страниц настройки">Создание страниц настройки</a>). </dd>
<dt><a href="https://codex.wordpress.org/Administration_Panels#Manage_-_Change_your_content" title="Administration Panels" class="mw-redirect">Manage</a></dt>
<dd>Отображение управления ссылками, записями, категориями, изображениями, etc.</dd>
<dt><a href="https://codex.wordpress.org/Administration_Panels#Plugins_-_Add_Functionality_to_your_Blog" title="Administration Panels" class="mw-redirect">Plugins / Плагины</a></dt>
<dd>Установка/удаление, включение/выключение и редактирование плагинов.</dd>
<dt><a href="https://codex.wordpress.org/Administration_Panels#Presentation_-_Change_the_Look_of_your_Blog" title="Administration Panels" class="mw-redirect">Presentation / Внешний Вид</a></dt>
<dd>Управление темами/стилями файлов, боковой панелью, etc.</dd>
<dt><a href="https://codex.wordpress.org/Administration_Panels#Write_-_Make_some_content" title="Administration Panels" class="mw-redirect">Write / Записи</a></dt>
<dd>Создание контента (записей и страниц). </dd>
<dt><a href="https://codex.wordpress.org/Administration_Panels#Users_-_Your_Blogging_Family" title="Administration Panels" class="mw-redirect">Users / Пользователи</a></dt>
<dd>Управление пользователями. </dd></dl>
<p>Если ваш плагин вводит совершенно новое понятие или функцию для WordPress и нуждается в большем колличестве экранов, чтобы это сделать, для вашего плагина возможен вариант создания нового меню верхнего уровня. Это следует рассматривать только если вам действительно нужно несколько связанных экранов, чтобы сделать в WordPress к чему он изначально не предназначен. Примеры могут включать управление галерей изображений, администрирование баз данных, или управление конференцией.
</p><p>С <a rel="nofollow" class="external text" href="http://barunsingh.com/software/custom-admin-menu/">плагином Custom Admin Menu</a> пользователи также имеют возможность сами решать, должен ли ваш плагин занять меню верхнего уровня или нет — вы можете дать понять пользователям, что они имеют такую ​​возможность, особенно если вы решили создать меню верхнего уровня.
</p>
<h2><span class="mw-headline" id="Admin_Menu_Functions">Admin Menu Functions</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D1%8B%D1%85_%D0%BC%D0%B5%D0%BD%D1%8E&amp;action=edit&amp;section=3" title="Edit section: Admin Menu Functions">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Теперь когда вы решили куда будете добавлять меню/подменю, следующий шаг расказать WordPress о новых страницах. Для этого нужно создать функцию, которую следует привязать к действию  <tt>'admin_menu'</tt> (пример приведен в конце раздела).
</p>
<h3><span class="mw-headline" id=".D0.9C.D0.B5.D0.BD.D1.8E_.D0.B2.D0.B5.D1.80.D1.85.D0.BD.D0.B5.D0.B3.D0.BE_.D1.83.D1.80.D0.BE.D0.B2.D0.BD.D1.8F">Меню верхнего уровня</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D1%8B%D1%85_%D0%BC%D0%B5%D0%BD%D1%8E&amp;action=edit&amp;section=4" title="Edit section: Меню верхнего уровня">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The first thing you'll need to do is to create a top-level menu, if you have decided that your plugin really needs one. You'll use the <tt>add_menu_page</tt> function:
</p><p>add_menu_page(<i>page_title</i>, <i>menu_title</i>, <i>access_level/capability</i>, <i>file</i>, <i>[function]</i>);
</p><p>Parameter values:
</p>
<dl><dt>page_title</dt>
<dd>Text that will go into the HTML page title for the page when the menu is active.</dd>
<dt>menu_title</dt>
<dd>The on-screen name text for the menu.</dd>
<dt>access_level/capability</dt>
<dd>The minimum <a href="https://codex.wordpress.org/User_Levels" title="User Levels">user level</a> or the <a href="https://codex.wordpress.org/Roles_and_Capabilities" title="Roles and Capabilities">capability</a> required to display and use this menu page.</dd>
<dt>file</dt>
<dd>The PHP file that handles the display of the menu page content.</dd>
<dt>function</dt>
<dd> The function that displays the page content for the menu page.</dd></dl>
<p>Technically, the <i>function</i> parameter is optional, but if it is not supplied, then WordPress will basically assume that including the PHP file will generate the administration screen, without calling a function. Most plugin authors choose to put the page-generating code in a function within their main plugin file.
</p>
<h3><span class="mw-headline" id="Sub-Menus">Sub-Menus</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D1%8B%D1%85_%D0%BC%D0%B5%D0%BD%D1%8E&amp;action=edit&amp;section=5" title="Edit section: Sub-Menus">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Once you have a top-level menu defined, or have chosen to use an existing WordPress top-level menu, you are ready to define one or more sub-menu pages using the <tt>add_submenu_page</tt> function. Make sure to add the submenu pages in the order you want them displayed.
</p><p>add_submenu_page(<i>parent</i>, <i>page_title</i>, <i>menu_title</i>, <i>access_level/capability</i>, <i>file</i>, <i>[function]</i>);
</p><p>Parameter values:
</p>
<dl><dt>parent</dt>
<dd>The filename of the core WordPress admin file that supplies the top-level menu in which you want to insert your submenu, or your plugin file if this submenu is going into a custom top-level menu.  (Examples: index.php, post.php, edit.php, themes.php, plugins.php, etc.)</dd>
<dt>page_title</dt>
<dd>Text that will go into the HTML page title for the page when the submenu is active.</dd>
<dt>menu_title</dt>
<dd>The on-screen name text for the submenu.</dd>
<dt>access_level/capability</dt>
<dd>The minimum <a href="https://codex.wordpress.org/User_Levels" title="User Levels">user level</a> or the <a href="https://codex.wordpress.org/Roles_and_Capabilities" title="Roles and Capabilities">capability</a> required to display and use this submenu page.</dd>
<dt>file</dt>
<dd>For existing WordPress menus, the PHP file that handles the display of the menu page content. For submenus of a custom top-level menu, a <b>unique</b> identifier for this sub-menu page.</dd></dl>
<p><i>In situations where a plugin is creating it's own top-level menu, the first submenu will normally have the same link title as the top-level menu and hence the link will be duplicated. The duplicate link title can be avoided by calling the add_submenu_page function with the parent and file parameters being given the same value. </i>

</p>
<dl><dt>function</dt>
<dd> The function that displays the page content for the menu page.</dd></dl>
<p>Technically, as in the <tt>add_menu_page</tt> function, the <i>function</i> parameter is optional, but if it is not supplied, then WordPress will basically assume that including the PHP file will generate the administration screen, without calling a function. Most plugin authors choose to put the page-generating code in a function within their main plugin file.
</p><p>Here's a quick example, illustrating how to insert a top-level menu page and a sub-menu page, where the title on the sub-menu page is different from the top-level page. In this example, 'my_magic_function' is the name of the function that displays the first sub-menu page:
</p>
<pre>
add_menu_page('Page title', 'Top-level menu title', 8, __FILE__, 'my_magic_function');
add_submenu_page(__FILE__, 'Page title', 'Sub-menu title', 8, __FILE__, 'my_magic_function');
</pre>
<p>Since most submenus go into WordPress's Options, Management, or Presentation menus, WordPress supplies three wrapper functions that make adding a submenu to those pages easier:
</p>
<dl><dt>For the Options top-level menu (see <a href="https://codex.wordpress.org/Creating_Options_Pages" title="Creating Options Pages">Creating Options Pages</a> for more on this)</dt>
<dd></dd></dl>
<pre>add_options_page(<i>page_title</i>, <i>menu_title</i>, <i>access_level/capability</i>, <i>file</i>, <i>[function]</i>);
</pre>
<dl><dt>For Management</dt>
<dd></dd></dl>
<pre>add_management_page(<i>page_title</i>, <i>menu_title</i>, <i>access_level/capability</i>, <i>file</i>, <i>[function]</i>);
</pre>
<dl><dt>For Presentation</dt>
<dd></dd></dl>
<pre>add_theme_page( <i>page_title</i>, <i>menu_title</i>, <i>access_level/capability</i>, <i>file</i>, <i>[function]</i>);
</pre>
<h3><span class="mw-headline" id=".D0.92.D1.81.D1.82.D0.B0.D0.B2.D0.BA.D0.B0_.D1.81.D1.82.D1.80.D0.B0.D0.BD.D0.B8.D1.86">Вставка страниц</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D1%8B%D1%85_%D0%BC%D0%B5%D0%BD%D1%8E&amp;action=edit&amp;section=6" title="Edit section: Вставка страниц">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Вот пример плагина WordPress, который вставляет новые меню в разные места:
</p>
<pre>
&lt;?php
/*
Plugin Name: Menu Test
Plugin URI: http://wordpress.org
Description: Menu Test
Author: Nobody
Author URI: http://example.com
*/

// Hook for adding admin menus
add_action('admin_menu', 'mt_add_pages');

// action function for above hook
function mt_add_pages() {
    // Add a new submenu under Options:
    add_options_page('Test Options', 'Test Options', 8, 'testoptions', 'mt_options_page');

    // Add a new submenu under Manage:
    add_management_page('Test Manage', 'Test Manage', 8, 'testmanage', 'mt_manage_page');

    // Add a new top-level menu (ill-advised):
    add_menu_page('Test Toplevel', 'Test Toplevel', 8, __FILE__, 'mt_toplevel_page');

    // Add a submenu to the custom top-level menu:
    add_submenu_page(__FILE__, 'Test Sublevel', 'Test Sublevel', 8, 'sub-page', 'mt_sublevel_page');

    // Add a second submenu to the custom top-level menu:
    add_submenu_page(__FILE__, 'Test Sublevel 2', 'Test Sublevel 2', 8, 'sub-page2', 'mt_sublevel_page2');
}

// mt_options_page() displays the page content for the Test Options submenu
function mt_options_page() {
    echo "&lt;h2&gt;Test Options&lt;/h2&gt;";
}

// mt_manage_page() displays the page content for the Test Manage submenu
function mt_manage_page() {
    echo "&lt;h2&gt;Test Manage&lt;/h2&gt;";
}

// mt_toplevel_page() displays the page content for the custom Test Toplevel menu
function mt_toplevel_page() {
    echo "&lt;h2&gt;Test Toplevel&lt;/h2&gt;";
}

// mt_sublevel_page() displays the page content for the first submenu
// of the custom Test Toplevel menu
function mt_sublevel_page() {
    echo "&lt;h2&gt;Test Sublevel&lt;/h2&gt;";
}

// mt_sublevel_page2() displays the page content for the second submenu
// of the custom Test Toplevel menu
function mt_sublevel_page2() {
    echo "&lt;h2&gt;Test Sublevel 2&lt;/h2&gt;";
}

?&gt;
</pre>
<h3><span class="mw-headline" id="Sample_Menu_Page">Sample Menu Page</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D1%8B%D1%85_%D0%BC%D0%B5%D0%BD%D1%8E&amp;action=edit&amp;section=7" title="Edit section: Sample Menu Page">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The example above contains several dummy functions, such as <tt>mt_options_page</tt>, as placeholders for actual page content. We need to turn them into real menu pages. So, let's assume that our plugin has an option called mt_favorite_food, and that we want to allow the site owner to type in his/her favorite food on the plugin's Option page. The <tt>mt_options_page</tt> function will need to put a data entry form on the screen to enable this, and also process the entered data. Here is a function that does this:
</p>
<pre>

// mt_options_page() displays the page content for the Test Options submenu
function mt_options_page() {

    // variables for the field and option names 
    $opt_name = 'mt_favorite_food';
    $hidden_field_name = 'mt_submit_hidden';
    $data_field_name = 'mt_favorite_food';

    // Read in existing option value from database
    $opt_val = get_option( $opt_name );

    // See if the user has posted us some information
    // If they did, this hidden field will be set to 'Y'
    if( $_POST[ $hidden_field_name ] == 'Y' ) {
        // Read their posted value
        $opt_val = $_POST[ $data_field_name ];

        // Save the posted value in the database
        update_option( $opt_name, $opt_val );

        // Put an options updated message on the screen

?&gt;
&lt;div class="updated"&gt;&lt;p&gt;&lt;strong&gt;&lt;?php _e('Options saved.', 'mt_trans_domain' );&#160;?&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;
&lt;?php

    }

    // Now display the options editing screen

    echo '&lt;div class="wrap"&gt;';

    // header

    echo "&lt;h2&gt;" . __( 'Menu Test Plugin Options', 'mt_trans_domain' ) . "&lt;/h2&gt;";

    // options form
    
   &#160;?&gt;

&lt;form name="form1" method="post" action="&lt;?php echo str_replace( '%7E', '~', $_SERVER['REQUEST_URI']);&#160;?&gt;"&gt;
&lt;input type="hidden" name="&lt;?php echo $hidden_field_name;&#160;?&gt;" value="Y"&gt;

&lt;p&gt;&lt;?php _e("Favorite Color:", 'mt_trans_domain' );&#160;?&gt; 
&lt;input type="text" name="&lt;?php echo $data_field_name;&#160;?&gt;" value="&lt;?php echo $opt_val;&#160;?&gt;" size="20"&gt;
&lt;/p&gt;&lt;hr /&gt;

&lt;p class="submit"&gt;
&lt;input type="submit" name="Submit" value="&lt;?php _e('Update Options', 'mt_trans_domain' )&#160;?&gt;" /&gt;
&lt;/p&gt;

&lt;/form&gt;
&lt;/div&gt;

&lt;?php
 
}
</pre>
<p>A few notes:
</p>
<ul><li> The WordPress administration functions take care of validating the user, so you don't have to worry about it in your function. </li>
<li> The function example above has been internationalized -- see <a href="https://codex.wordpress.org/%D0%9D%D0%B0%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BF%D0%BB%D0%B0%D0%B3%D0%B8%D0%BD%D0%B0#.D0.98.D0.BD.D1.82.D0.B5.D1.80.D0.BD.D0.B0.D1.86.D0.B8.D0.BE.D0.BD.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D1.8F_.D0.BF.D0.BB.D0.B0.D0.B3.D0.B8.D0.BD.D0.B0" title="Написание плагина">the Internationalization section of Writing a Plugin</a> for more information</li>
<li> The function processes any entered data before putting the data entry form on the screen, so that the new values will be shown in the form (rather than the values from the database).</li>
<li> You don't have to worry about this working the first time, because the WordPress <tt>update_option</tt> function will automatically add an option to the database if it doesn't already exist.</li></ul>

<!-- 
NewPP limit report
Cached time: 20190211004606
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.016 seconds
Real time usage: 0.024 seconds
Preprocessor visited node count: 73/1000000
Preprocessor generated node count: 282/1000000
Post‐expand include size: 692/2097152 bytes
Template argument size: 314/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    6.116      1 - Template:Languages
100.00%    6.116      1 - -total
 27.06%    1.655      1 - Template:en
 24.66%    1.508      1 - Template:ru
 20.39%    1.247      1 - Template:ja
-->
