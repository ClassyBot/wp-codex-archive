<div style="background-color: #e0e0e0; padding: 5px 10px; border: 1px solid #a0a0a0; margin-bottom: 10px;border-radius:5px;box-shadow: 0px 0px 1px #a0a0a0 inset">
<p style="margin: 0px; padding: 0px"><a href="https://codex.wordpress.org/fr:Accueil" title="fr:Accueil"> Page d'accueil du Codex en français</a> - <a rel="nofollow" class="external text" href="http://fr.wordpress.org/">Télécharger WordPress en français</a><br />
Les utilisateurs francophones se retrouvent sur le site <a rel="nofollow" class="external text" href="https://www.wpfr.net">WordPress-Francophone</a>, notamment sur son <a rel="nofollow" class="external text" href="https://wpfr.net/support/">forum d'entraide</a>.</p>
</div>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Utilisation"><span class="tocnumber">1</span> <span class="toctext">Utilisation</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Afficher_les_champs_personnalisables"><span class="tocnumber">2</span> <span class="toctext">Afficher les champs personnalisables</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Champs_personnalisables_:_Techniques_Avanc.C3.A9es"><span class="tocnumber">3</span> <span class="toctext">Champs personnalisables&#160;: Techniques Avancées</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#R.C3.A9cup.C3.A9rer_les_champs_personnalisables"><span class="tocnumber">3.1</span> <span class="toctext">Récupérer les champs personnalisables</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#D.C3.A9tails_d.27impl.C3.A9mentation"><span class="tocnumber">3.1.1</span> <span class="toctext">Détails d'implémentation</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-6"><a href="#Fonctions_PostMeta"><span class="tocnumber">3.2</span> <span class="toctext">Fonctions PostMeta</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="#Fonctions_internes"><span class="tocnumber">3.2.1</span> <span class="toctext">Fonctions internes</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Fonctions_de_th.C3.A8me"><span class="tocnumber">3.2.2</span> <span class="toctext">Fonctions de thème</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>

<p>WordPress a la particularité de permettre aux utilisateurs d'assigner des champs personnalisables à un article. Ces informations supplémentaires arbitraires sont aussi connues sous le nom de <i>meta-données</i>. Ces <i>meta-données</i> peuvent contenir des informations telles que&#160;:
</p>
<ul><li> <b>Humeur: Content</b></li>
<li> <b>Lecture actuelle: Cendrillon</b></li>
<li> <b>J'écoute: Rock Around the Clock</b></li>
<li> <b>Météo: Chaud et humide</b></li></ul>
<p>Avec un peu de programmation supplémentaire, il est possible de gérer des actions plus complexes, comme utiliser une <b>meta-donnée</b> pour garder en mémoire une date d'expiration de l'article.
</p><p>Ces meta-données sont gérées avec des paires <b>clé/valeur</b>. La <b>clé</b> correspond au nom de la méta-donnée. La <b>valeur</b> représente l'information que doit porter la méta-donnée dans la liste des informations associées à chaque article qui porte cette méta-donnée.
</p><p>Il est possible d'associer plusieurs fois la même <b>clé</b> pour un même article. Par exemple, si vous lisez deux livres en même temps (peut-être un livre technique pour votre travail et un roman à la maison), vous pouvez créer une clé "lecture" que vous utilisez deux fois sur le même article, une pour chaque livre.
</p><p>Voici un exemple de la façon dont ces informations peuvent apparaitre dans votre article&#160;:
</p>
<div style="border:1px solid blue; width:50%; margin: 20px; padding:20px"><b>Lectures actuelles</b>: <i>Calvin et Hobbes</i>
<p><b>Humeur du jour</b>: <i>Content et heureux</i>
</p>
</div>
<h2><span class="mw-headline" id="Utilisation">Utilisation</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=fr:Utiliser_les_champs_personnalis%C3%A9s&amp;action=edit&amp;section=1" title="Edit section: Utilisation">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Basé sur l'exemple ci-dessus, mettons-le en application. Nous allons ajouter deux champs personnalisables, le premier sera appelé "Lectures" et le second "Humeur du jour". Les instructions suivantes vous montreront comment ajouter ces informations à un article en utilisant les champs personnalisables.
</p>
<ol><li> A partir de la page <a href="https://codex.wordpress.org/fr:Panneaux_Administration#.C3.89crire_un_Article" title="fr:Panneaux Administration">Écrire</a>, choisissez <b>Édition avancée</b>. Si vous utilisez l'écran d'<b>édition simple</b>, cherchez un bouton à côté du bouton <b>Publier</b> dont le libellé est <b>Édition avancée &#187;</b>. Cliquez sur ce bouton et allez à l'écran d'édition avancée.</li>
<li> Après avoir rédigé votre article, allez en bas de la section <b>édition avancée</b> et cherchez une zone appelée <b>Champs personnalisables</b>.</li>
<li> Pour créer un nouveau <b>champ personnalisable</b> appelé "Lectures", tapez le texte "Lectures" dans la zone de texte <b>clé</b>.</li>
<li> Cette nouvelle <b>clé</b> doit avoir une valeur associée, qui dans notre cas correspond au nom du livre que nous sommes en train de lire&#160;: "Calvin et Hobbes". Tapez "Calvin et Hobbes" dans la zone <i>Valeur</i>.</li>
<li> Cliquez sur le bouton <b>Ajouter Champ Personnalisé</b> pour sauvegarder ces informations pour cet article.</li></ol>
<p>Pour ajouter votre "Humeur du jour", répétez le processus avec "Humeur du jour" dans la clé et la description de votre humeur dans la zone <b>valeur</b> puis cliquez sur <b>Sauvegarder</b> pour enregistrer cette information en même temps que l'article.
</p><p>Sur votre article suivant, vous pouvez ajouter un nouveau livre et votre humeur à vos méta-données. Dans la section <b>Champs personnalisables</b>, la zone <b>clé</b> contient maintenant une liste déroulante avec les clés saisies sur les articles précédents. Choissisez "Lectures" et saisissez le titre de votre nouveau livre dans la zone <b>valeur</b>. Cliquez sur <b>Ajouter Champ personnalisable</b> et répétez l'opération pour ajouter votre "Humeur du jour".
</p><p>Il suffit de créer <b>une seule fois</b> une clé, ensuite vous pouvez assigner une valeur à cette clé pour tous vos articles, si vous le souhaitez. Vous pouvez aussi assigner plus d'une <b>valeur</b> à une clé pour le même article. C'est très pratique pour les personnes qui lisent plus d'un livre à la fois.
</p>
<h2><span class="mw-headline" id="Afficher_les_champs_personnalisables">Afficher les champs personnalisables</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=fr:Utiliser_les_champs_personnalis%C3%A9s&amp;action=edit&amp;section=2" title="Edit section: Afficher les champs personnalisables">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Une fois les champs personnalisables créés, il faut les afficher afin que tout le monde puisse voir vos lectures et votre humeur du jour. Pour afficher le champ personnalisable de chaque article, il faut utiliser la balise de modèle <tt><a href="https://codex.wordpress.org/Template_Tags/the_meta" title="Template Tags/the meta" class="mw-redirect">the_meta()</a></tt> (en anglais). Cette balise doit être placée à l'intérieur de <a href="https://codex.wordpress.org/The_Loop" title="The Loop">la Boucle</a> (en anglais) pour fonctionner. La plupart des gens ajoute cette balise <tt>the_meta()</tt> à la fin de leur article ou dans la <a href="https://codex.wordpress.org/Post_Meta_Data_Section" title="Post Meta Data Section"> section méta données de l'article</a> (en anglais).
</p><p>Voici un exemple simple d'utilisation de cette balise&#160;:
</p><p><code><span style="color: #000000">
&#160;<span style="color: #0000BB">&lt;?php&#160;the_meta</span><span style="color: #007700">();&#160;</span><span style="color: #0000BB">?&gt;</span>&#160;</span>
</code>
</p><p>à l'affichage de la page, le code devrait ressembler à ceci:
</p>
<pre>&lt;ul class='post-meta'&gt;
&lt;li&gt;&lt;span class='post-meta-key'&gt;Lectures:&lt;/span&gt; Calvin et Hobbes&lt;/li&gt;
&lt;li&gt;&lt;span class='post-meta-key'&gt;Humeur du jour:&lt;/span&gt; Content et Heureux&lt;/li&gt;
&lt;/ul&gt;</pre>
<p>La balise de modèle met automatiquement toutes les meta-données personnalisées dans une liste dont la classe CSS s'appelle <tt>post-meta</tt>. La <b>clé</b> est placée dans une balise HTML <tt>span</tt> de classe CSS <tt>post-meta-key</tt> ainsi vous pouvez l'habiller via la feuille de style. Toutes ces données sont présentées dans une liste à puce.
</p><p>Pour habiller la liste <tt>post-meta</tt>, changez les caractéristiques dans la feuille de style. Pour l'instant, ajoutons quelques effets à notre exemple. Les éléments de la feuille de style peuvent ressembler à ceci:
</p>
<pre>.post-meta {font-variant: small-caps; color: maroon; }
.post-meta-key {color: green; font-weight: bold; font-size: 110%; }</pre>
<div style="border:1px solid blue; width:50%; margin: 20px; padding:20px">
<ul><li> <span style="font-size:110%; color: green; font-weight:bold; font-variant: small-caps">Lectures</span>: <span style="font-style:italic; color: maroon; font-variant: small-caps">Calvin et Hobbes</span></li>
<li> <span style="font-size:110%; color: green; font-weight:bold; font-variant: small-caps">Humeur du jour</span>: <span style="font-style:italic; color: maroon; font-variant: small-caps">Content et Heureux</span></li></ul>
</div>
<p>Il y a aussi WordPress Plugins de <a rel="nofollow" class="external text" href="http://wordpress.org/extend/plugins/">Official WordPress Plugin Directory</a> (en anglais) qui ajoutent des fonctions utiles pour l'affichage de ces méta-données. Recherchez  <a rel="nofollow" class="external text" href="http://www.google.com/search?hl=en&amp;q=custom+fields+plugin+wordpress&amp;btnG=Google+Search">Custom Field plugins sur Google</a> et vous en trouverez encore plus.
</p>
<h2><span class="mw-headline" id="Champs_personnalisables_:_Techniques_Avanc.C3.A9es">Champs personnalisables&#160;: Techniques Avancées</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=fr:Utiliser_les_champs_personnalis%C3%A9s&amp;action=edit&amp;section=3" title="Edit section: Champs personnalisables : Techniques Avancées">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Ci-dessous vous trouverez des techniques avancées pour utiliser et paramétrer les méta-données et champs personnalisables.
</p>
<h3><span class="mw-headline" id="R.C3.A9cup.C3.A9rer_les_champs_personnalisables">Récupérer les champs personnalisables</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=fr:Utiliser_les_champs_personnalis%C3%A9s&amp;action=edit&amp;section=4" title="Edit section: Récupérer les champs personnalisables">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Pour récupérer les méta-données, utilisez la fonction PHP <tt>get_post_meta()</tt>:
</p><p><code><span style="color: #000000">
&#160;get_post_meta($post_id,&#160;$clé,&#160;$unique);&#160;</span>
</code>
</p>
<ul><li><tt>$post_id</tt> est le numéro identifiant l'article dont vous voulez récupérer les méta-données. Utilisez <tt>$post-&gt;ID</tt> pour obtenir ce numéro d'identifiant.</li>
<li><tt>$clé</tt> est la chaine de caractère qui contient le nom de la méta-donnée dont vous voulez récupérer la valeur.</li>
<li><tt>$unique</tt> peut être soit <tt>true</tt> (vrai) ou <tt>false</tt> (faux). Si la valeur est vrai, la fonction renverra un résultat simple sous la forme d'une <b>chaîne de caractère</b>. Si la valeur est fausse ou non précisée, la fonction renverra un <b>tableau</b> de champs personnalisables.</li></ul>
<h4><span class="mw-headline" id="D.C3.A9tails_d.27impl.C3.A9mentation">Détails d'implémentation</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=fr:Utiliser_les_champs_personnalis%C3%A9s&amp;action=edit&amp;section=5" title="Edit section: Détails d'implémentation">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Les méta-informations des articles sont stockées dans une table particulière, <tt>$wpdb-&gt;postmeta</tt>. Cette table contient quatre champs:
</p>
<dl><dd><tt>meta_id</tt>: Identifiant unique pour chaque entrée<br /></dd>
<dd><tt>post_id</tt>: L'identifiant de l'article pour cette méta-donnée<br /></dd>
<dd><tt>meta_key</tt>: Le nom de la <b>clé</b><br /></dd>
<dd><tt>meta_value</tt>: La valeur associée à cette clé<br /></dd></dl>
<p>Les valeurs de cette table sont stockées dans un tableau multi-dimensionnel structuré appelé <tt>$post_meta_cache</tt>, après la récupération des articles dans le tableau <tt>$posts</tt> dans <tt>wp-blog-header.php</tt>. Cette variable ne contient que les valeurs associées aux articles récupérés pour la page courante. La structure de ce tableau se présente comme ceci:
</p>
<pre> [
   postid1 =&gt; [
     [
       clé1 =&gt; [valeur1, valeur2, ...],
       clé2 =&gt; [valeur1, valeur2, ...],
       ...
     ],
   postid2 =&gt; [ ... ],
   ...
 ]
</pre>
<p>Ainsi, pour récupérer les valeurs de "Lectures" pour l'article 256, vous devrez utilisez le code PHP suivant:
</p><p><code><span style="color: #000000">
&#160;//&#160;Fetch&#160;an&#160;array&#160;of&#160;values&#160;for&#160;what&#160;I'm&#160;reading:&#160;</span>
</code>
<code><span style="color: #000000">
&#160;$readinglist&#160;=&#160;$post_meta_cache[256]['Lectures'];&#160;</span>
</code>
</p>
<dl><dd>Ne pas oublier que <tt>$readinglist</tt> contient un tableau et non une chaîne de caractères.</dd>
<dd>A partir de WordPress 2.1, $post_meta_cache n'est plus prérempli. Vous pouvez récupérer les valeurs grâce aux fonctions mentionnées plus bas.</dd></dl>
<h3><span class="mw-headline" id="Fonctions_PostMeta">Fonctions PostMeta</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=fr:Utiliser_les_champs_personnalis%C3%A9s&amp;action=edit&amp;section=6" title="Edit section: Fonctions PostMeta">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<h4><span class="mw-headline" id="Fonctions_internes">Fonctions internes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=fr:Utiliser_les_champs_personnalis%C3%A9s&amp;action=edit&amp;section=7" title="Edit section: Fonctions internes">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Ces fonctions sont faites pour être appelées à l'intérieur de la boucle WordPress, et retournent toutes des tableaux.
</p>
<dl><dt><tt>get_post_custom()</tt></dt>
<dd> Récupère toutes les paires clé/valeur pour l'article courant.</dd>
<dt><tt>get_post_custom_keys()</tt></dt>
<dd> Récupère la liste de toutes les clés pour l'article courant.</dd>
<dt><tt>get_post_custom_values($clé)</tt></dt>
<dd> Récupère la liste des valeurs pour une clé particulière pour l'article courant.</dd>
<dt><tt>get_post_meta($post_id, $key, $single = false)</tt></dt>
<dd> WordPress 1.5 et plus, cette fonction récupère les informations sans passer par le cache (<tt>$post_meta_cache</tt>). Cette fonction requiert le numéro de l'article et la clé à récupérer pour un usage en PHP. A noter que si le paramètre <tt>$single</tt> est passé avec la valeur TRUE, la fonction renvoie le premier résultat sous forme d'une chaîne et non un tableau.</dd></dl>
<h4><span class="mw-headline" id="Fonctions_de_th.C3.A8me">Fonctions de thème</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=fr:Utiliser_les_champs_personnalis%C3%A9s&amp;action=edit&amp;section=8" title="Edit section: Fonctions de thème">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Au moment de la rédaction de cette page, il n'existe qu'une fonction de thème.
</p>
<dl><dt><tt><a href="https://codex.wordpress.org/Template_Tags/the_meta" title="Template Tags/the meta" class="mw-redirect">the_meta()</a></tt></dt>
<dd> Affiche une liste à puce contenant les méta-données avec la classe CSS <i>post-meta</i> pour l'élement UL et la classe CSS <i>post-meta-key</i> pour chaque élément LI.</dd></dl>
<p>Nous esperons que les développeurs indépendants vont fournir beaucoup d'usages intéressants pour ces méta-données sous la forme de plugins. La fonction de thème <tt>the_meta()</tt> n'est qu'un exemple très simple.
</p><p><a href="https://codex.wordpress.org/fr:Accueil" title="fr:Accueil">Retour à la Page d'Accueil</a>
</p>

