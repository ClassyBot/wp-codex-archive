<p class="LanguageLinks" style="border:1px solid #CCCCCC; line-height:1.5; text-align:left; color:#333333; font-size:90%; padding:10px;"><span style="white-space:nowrap;"><a href="https://codex.wordpress.org/Multilingual_Codex" title="Multilingual Codex" class="mw-redirect">Languages</a>:</span> 
<a href="https://codex.wordpress.org/Function_Reference/wp_schedule_event" title="Function Reference/wp schedule event">English</a> • 
<a rel="nofollow" class="external text" href="https://wpdocs.osdn.jp/関数リファレンス/wp_schedule_event">日本語</a> 
<strong class="selflink">中文(简体)</strong> • 
 <small>(<a href="https://codex.wordpress.org/Multilingual_Codex#Language_Cross_Reference" title="Multilingual Codex" class="mw-redirect">Add your language</a>)</small>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.E6.8F.8F.E8.BF.B0"><span class="tocnumber">1</span> <span class="toctext">描述</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#.E7.94.A8.E6.B3.95"><span class="tocnumber">2</span> <span class="toctext">用法</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#.E5.8F.82.E6.95.B0"><span class="tocnumber">3</span> <span class="toctext">参数</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#.E4.BE.8B.E5.AD.90"><span class="tocnumber">4</span> <span class="toctext">例子</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#.E5.AE.89.E6.8E.92.E4.B8.80.E4.B8.AA.E6.AF.8F.E5.B0.8F.E6.97.B6.E6.89.A7.E8.A1.8C.E7.9A.84.E4.BB.BB.E5.8A.A1"><span class="tocnumber">4.1</span> <span class="toctext">安排一个每小时执行的任务</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#.E5.85.B6.E5.AE.83.E5.8F.82.E8.80.83"><span class="tocnumber">5</span> <span class="toctext">其它参考</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#.E5.BB.B6.E4.BC.B8.E9.98.85.E8.AF.BB"><span class="tocnumber">6</span> <span class="toctext">延伸阅读</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id=".E6.8F.8F.E8.BF.B0">描述</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=zh-cn:%E5%87%BD%E6%95%B0/wp_schedule_event&amp;action=edit&amp;section=1" title="Edit section: 描述">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>对一个钩子函数作定时处理,这个钩子会通过 WordPress 动作核心,在特定的时间间歇执行,时间间歇可以自定义.如果 定时的事件参数 (time) 被传递了的话,这个动作会在有人访问你的 WordPress 站点的时候触发.通过查看 <a href="https://codex.wordpress.org/Plugin_API" title="Plugin API">Plugin API</a> 获得钩子的列表.
</p>
<h2><span class="mw-headline" id=".E7.94.A8.E6.B3.95">用法</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=zh-cn:%E5%87%BD%E6%95%B0/wp_schedule_event&amp;action=edit&amp;section=2" title="Edit section: 用法">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><code><span style="color: #000000">
&#160;<span style="color: #0000BB">&lt;?php&#160;wp_schedule_event</span><span style="color: #007700">(</span><span style="color: #0000BB">time</span><span style="color: #007700">(),&#160;</span><span style="color: #DD0000">'hourly'</span><span style="color: #007700">,&#160;</span><span style="color: #DD0000">'my_schedule_hook'</span><span style="color: #007700">,&#160;</span><span style="color: #0000BB">$args</span><span style="color: #007700">);&#160;</span><span style="color: #0000BB">?&gt;</span>&#160;</span>
</code>
</p>
<h2><span class="mw-headline" id=".E5.8F.82.E6.95.B0">参数</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=zh-cn:%E5%87%BD%E6%95%B0/wp_schedule_event&amp;action=edit&amp;section=3" title="Edit section: 参数">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<dl><dt> <tt>$timestamp</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Integer" title="How to Pass Tag Parameters"><i>integer</i></a>) (<i>required</i>) The first time that you want the event to occur. This must be in a UNIX timestamp format.<br /> 你希望事件发生的第一次事件.这里必须是一个 UNIX 风格的时间戳
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<dl><dt> <tt>$recurrance</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#String" title="How to Pass Tag Parameters"><i>string</i></a>) (<i>required</i>) How often the event should reoccur. Valid values:<ul><li><tt>hourly</tt></li><li><tt>twicedaily</tt></li><li><tt>daily</tt></li></ul>这个事件会在多久之后重新发生.有效值:<ul><li><tt>hourly</tt></li><li><tt>twicedaily</tt></li><li><tt>daily</tt></li></ul>
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<dl><dt> <tt>$hook</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#String" title="How to Pass Tag Parameters"><i>string</i></a>) (<i>required</i>) The name of an action hook to execute.要运行的动作钩子名
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<dl><dt> <tt>$args</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Array" title="How to Pass Tag Parameters"><i>array</i></a>) (<i>optional</i>) Arguments to pass to the hook function(s).传给钩子函数的参数
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<h2><span class="mw-headline" id=".E4.BE.8B.E5.AD.90">例子</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=zh-cn:%E5%87%BD%E6%95%B0/wp_schedule_event&amp;action=edit&amp;section=4" title="Edit section: 例子">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id=".E5.AE.89.E6.8E.92.E4.B8.80.E4.B8.AA.E6.AF.8F.E5.B0.8F.E6.97.B6.E6.89.A7.E8.A1.8C.E7.9A.84.E4.BB.BB.E5.8A.A1">安排一个每小时执行的任务</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=zh-cn:%E5%87%BD%E6%95%B0/wp_schedule_event&amp;action=edit&amp;section=5" title="Edit section: 安排一个每小时执行的任务">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>在一个插件中设定一个每小时执行一次的任务,在激活插件的时候的时候调用 <tt>wp_schedule_event</tt> (否则会产生很多的定时事件):
</p>
<pre>
register_activation_hook(__FILE__, 'my_activation');
add_action('my_hourly_event', 'do_this_hourly');

function my_activation() {
  if (! wp_next_scheduled ( 'my_hourly_event' )) {
    wp_schedule_event(time(), 'hourly', 'my_hourly_event');
  }
}

function do_this_hourly() {
  // do something every hour
}
</pre>
<p>别忘了在禁用插件的时候清理定时器:
</p>
<pre>
register_deactivation_hook(__FILE__, 'my_deactivation');

function my_deactivation() {
  wp_clear_scheduled_hook('my_hourly_event');
}
</pre>
<h2><span class="mw-headline" id=".E5.85.B6.E5.AE.83.E5.8F.82.E8.80.83">其它参考</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=zh-cn:%E5%87%BD%E6%95%B0/wp_schedule_event&amp;action=edit&amp;section=6" title="Edit section: 其它参考">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> <a href="https://codex.wordpress.org/Function_Reference/wp_schedule_event" title="Function Reference/wp schedule event">wp_schedule_event</a></li>
<li> <a href="https://codex.wordpress.org/Function_Reference/wp_schedule_single_event" title="Function Reference/wp schedule single event">wp_schedule_single_event</a></li>
<li> <a href="https://codex.wordpress.org/Function_Reference/wp_clear_scheduled_hook" title="Function Reference/wp clear scheduled hook">wp_clear_scheduled_hook</a></li>
<li> <a href="https://codex.wordpress.org/Function_Reference/wp_next_scheduled" title="Function Reference/wp next scheduled">wp_next_scheduled</a></li>
<li> <a href="https://codex.wordpress.org/Function_Reference/wp_unschedule_event" title="Function Reference/wp unschedule event">wp_unschedule_event</a></li>
<li> <a href="https://codex.wordpress.org/Function_Reference/wp_get_schedule" title="Function Reference/wp get schedule">wp_get_schedule</a></li></ul>
<h2><span class="mw-headline" id=".E5.BB.B6.E4.BC.B8.E9.98.85.E8.AF.BB">延伸阅读</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=zh-cn:%E5%87%BD%E6%95%B0/wp_schedule_event&amp;action=edit&amp;section=7" title="Edit section: 延伸阅读">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> <a rel="nofollow" class="external text" href="https://GenerateWP.com/schedule_event/">WordPress Cron Job Event Generator</a></li>
<li> <a rel="nofollow" class="external text" href="http://holisticnetworking.net/plugins/2008/10/18/scheduling-with-wordpress-cron-functions/">How cronjobs work in wordpress</a></li>
<li> For a comprehensive list of functions, take a look at the <a rel="nofollow" class="external text" href="http://codex.wordpress.org/Category:Functions">category Functions</a></li></ul>

<!-- 
NewPP limit report
Cached time: 20190211004548
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.016 seconds
Real time usage: 0.020 seconds
Preprocessor visited node count: 139/1000000
Preprocessor generated node count: 493/1000000
Post‐expand include size: 1717/2097152 bytes
Template argument size: 962/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    7.087      1 - -total
 64.97%    4.604      1 - Template:Languages
 29.87%    2.117      4 - Template:Parameter
 14.97%    1.061      1 - Template:ja
 14.58%    1.033      1 - Template:en
 13.86%    0.982      1 - Template:zh-cn
-->
