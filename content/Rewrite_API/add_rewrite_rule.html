<p class="LanguageLinks" style="border:1px solid #CCCCCC; line-height:1.5; text-align:left; color:#333333; font-size:90%; padding:10px;"><span style="white-space:nowrap;"><a href="https://codex.wordpress.org/Multilingual_Codex" title="Multilingual Codex" class="mw-redirect">Languages</a>:</span> 
<strong class="selflink">English</strong> • 
<a rel="nofollow" class="external text" href="https://wpdocs.osdn.jp/Rewrite_API/add_rewrite_rule">日本語</a> 
 <small>(<a href="https://codex.wordpress.org/Multilingual_Codex#Language_Cross_Reference" title="Multilingual Codex" class="mw-redirect">Add your language</a>)</small>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Usage"><span class="tocnumber">2</span> <span class="toctext">Usage</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Arguments"><span class="tocnumber">3</span> <span class="toctext">Arguments</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Example"><span class="tocnumber">4</span> <span class="toctext">Example</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Basic_Usage"><span class="tocnumber">4.1</span> <span class="toctext">Basic Usage</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Using_Custom_Templates_with_custom_querystring"><span class="tocnumber">4.2</span> <span class="toctext">Using Custom Templates with custom querystring</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Using_rewrite_rules_to_redirect_to_scripts_other_than_index.php"><span class="tocnumber">4.3</span> <span class="toctext">Using rewrite rules to redirect to scripts other than index.php</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Source_File"><span class="tocnumber">5</span> <span class="toctext">Source File</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Related"><span class="tocnumber">6</span> <span class="toctext">Related</span></a>
<ul>
<li class="toclevel-2"><a href="#Articles"><span class="tocnumber">6.1</span> <span class="toctext">Articles</span></a></li>
<li class="toclevel-2"><a href="#Hooks"><span class="tocnumber">6.2</span> <span class="toctext">Hooks</span></a></li>
<li class="toclevel-2"><a href="#Functions"><span class="tocnumber">6.3</span> <span class="toctext">Functions</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#External_Resources"><span class="tocnumber">7</span> <span class="toctext">External Resources</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Description">Description</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Rewrite_API/add_rewrite_rule&amp;action=edit&amp;section=1" title="Edit section: Description">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>add_rewrite_rule() allows you to specify additional rewrite rules for WordPress. It is most commonly used in conjunction with <a href="https://codex.wordpress.org/Rewrite_API/add_rewrite_tag" title="Rewrite API/add rewrite tag">add_rewrite_tag()</a> (which allows WordPress to recognize custom post/get variables).
</p>
<h2><span class="mw-headline" id="Usage">Usage</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Rewrite_API/add_rewrite_rule&amp;action=edit&amp;section=2" title="Edit section: Usage">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php&#160;add_rewrite_rule</span><span style="color: #007700">(</span><span style="color: #0000BB">$regex</span><span style="color: #007700">,&#160;</span><span style="color: #0000BB">$redirect</span><span style="color: #007700">,&#160;</span><span style="color: #0000BB">$after</span><span style="color: #007700">);&#160;</span><span style="color: #0000BB">?&gt;</span>
</span>
</code>
</p>
<h2><span class="mw-headline" id="Arguments">Arguments</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Rewrite_API/add_rewrite_rule&amp;action=edit&amp;section=3" title="Edit section: Arguments">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<dl><dt> <tt>$regex</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#String" title="How to Pass Tag Parameters"><i>string</i></a>) (<i>required</i>) A regular expression to match against a requested URL. This can optionally use one or more capture groups.
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<dl><dt> <tt>$redirect</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#String" title="How to Pass Tag Parameters"><i>string</i></a>) (<i>required</i>) The URL you would like to actually fetch (when the $regex is matched). You can use the $matches[] array to insert capture group matches here.
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<dl><dt> <tt>$after</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#String" title="How to Pass Tag Parameters"><i>string</i></a>) (<i>optional</i>) This can either be '<b>top'</b> or '<b>bottom'</b>. 'top' will take precedence over WordPress's existing rules, where 'bottom' will check all other rules match first.
<dl><dd> Default: "bottom"</dd></dl></dd></dl>
<h2><span class="mw-headline" id="Example">Example</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Rewrite_API/add_rewrite_rule&amp;action=edit&amp;section=4" title="Edit section: Example">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Basic_Usage">Basic Usage</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Rewrite_API/add_rewrite_rule&amp;action=edit&amp;section=5" title="Edit section: Basic Usage">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>You can retrieve any page by specifying ID in URL as following:
<code><span style="color: #000000">
<a rel="nofollow" class="external free" href="http://example.com/?p=95">http://example.com/?p=95</a></span>
</code>
If you add the following rule to the <i><a href="https://codex.wordpress.org/Functions_File_Explained" title="Functions File Explained">functions.php</a></i> file, you can provide custom formed URL to access.
</p>
<pre>
function custom_rewrite_basic() {
  add_rewrite_rule('^leaf/([0-9]+)/?', 'index.php?page_id=$matches[1]', 'top');
}
add_action('init', 'custom_rewrite_basic');
</pre>
<p><b>NOTE:</b> When using <em>$matches[]</em> to retrieve the values of a matched URL, capture group data starts at 1, not 0.
</p><p><b>IMPORTANT:</b> Do not forget to flush and regenerate the rewrite rules database after modifying rules. From WordPress <a href="https://codex.wordpress.org/Administration_Screens" title="Administration Screens">Administration Screens</a>, Select Settings -&gt; Permalinks and just click Save Changes without any changes.
</p><p>Now, you can access the same page as 
<code><span style="color: #000000">
<a rel="nofollow" class="external free" href="http://example.com/leaf/95">http://example.com/leaf/95</a></span>
</code>
</p>
<h3><span class="mw-headline" id="Using_Custom_Templates_with_custom_querystring">Using Custom Templates with custom querystring</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Rewrite_API/add_rewrite_rule&amp;action=edit&amp;section=6" title="Edit section: Using Custom Templates with custom querystring">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Let's assume you are creating a "Nutrition" page for showing nutritional information. This page uses a custom template and takes two variables, <b>food</b> and <b>variety</b>. 
Create a file named <i>my-custom-template.php</i> in your themes root directory as following:
</p>
<pre>
/**
 * Template Name: Nutritional Information
 */
get_header(); 

global $wp_query;
echo 'Food&#160;: ' . $wp_query-&gt;query_vars['food'];
echo '&lt;br /&gt;';
echo 'Variety&#160;: ' . $wp_query-&gt;query_vars['variety'];
// ... more ...
get_footer(); 
</pre>
<p>Using this template, create a page. In Add New of Pages screen, select "Nutritional Information" from Template dropdown box. You may leave blank for title or contents. Click Publish to publish the page.
Write down the ID of created page from All Pages screen. Move a mouse cursor on the page title to show the link information in status bar of Web browser. You will see the ID after the <b>POST=</b> in URL. In this example, assume the ID is 12.
</p><p>Use <a href="https://codex.wordpress.org/Rewrite_API/add_rewrite_tag" title="Rewrite API/add rewrite tag">add_rewrite_tag()</a> to make WordPress aware of custom querystring variables <b>food</b> and <b>variety</b>. Add the following code to the <i><a href="https://codex.wordpress.org/Functions_File_Explained" title="Functions File Explained">functions.php</a></i> file,
</p>
<pre>
function custom_rewrite_tag() {
  add_rewrite_tag('%food%', '([^&amp;]+)');
  add_rewrite_tag('%variety%', '([^&amp;]+)');
}
add_action('init', 'custom_rewrite_tag', 10, 0);</pre>
<p>You can call the page as following:
<code><span style="color: #000000">
<a rel="nofollow" class="external free" href="http://example.com/index.php?page_id=12&amp;food=milkshake&amp;variety=strawberry">http://example.com/index.php?page_id=12&amp;food=milkshake&amp;variety=strawberry</a></span>
</code>
The page will show two values passed by querystring variables.
</p><p>Now, instead of passing ugly querystring variables to the page, you can set up a rewrite rule to create some custom pretty URLs. Add the following rule to the <i><a href="https://codex.wordpress.org/Functions_File_Explained" title="Functions File Explained">functions.php</a></i> file and replace the page ID <em>12</em> by the ID that you investigated in above step. Don't forget to click Save Changes in Permalinks Settings. (refer above IMPORTANT)
</p>
<pre>
  function custom_rewrite_rule() {
    add_rewrite_rule('^nutrition/([^/]*)/([^/]*)/?','index.php?page_id=12&amp;food=$matches[1]&amp;variety=$matches[2]','top');
  }
  add_action('init', 'custom_rewrite_rule', 10, 0);
</pre>
<p>User can access the same page with following URL:
<code><span style="color: #000000">
<a rel="nofollow" class="external free" href="http://example.com/nutrition/milkshakes/strawberry/">http://example.com/nutrition/milkshakes/strawberry/</a></span>
</code>
</p>
<h3><span class="mw-headline" id="Using_rewrite_rules_to_redirect_to_scripts_other_than_index.php">Using rewrite rules to redirect to scripts other than index.php</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Rewrite_API/add_rewrite_rule&amp;action=edit&amp;section=7" title="Edit section: Using rewrite rules to redirect to scripts other than index.php">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The $redirect argument works slightly differently when redirecting to a custom PHP script because WordPress delegates these redirects to .htaccess instead of processing them itself. For this reason, querystring variables should be written like $1 instead of $matches[1]. Given we're redirecting to a custom PHP script, adding the same rewrite rule from our previous example would look like this:
</p>
<pre>
  function custom_rewrite_rule() {
    add_rewrite_rule('^nutrition/([^/]*)/([^/]*)/?','url/to/my/script.php?food=$1&amp;variety=$2','top');
  }
  add_action('init', 'custom_rewrite_rule', 10, 0);
</pre>
<h2><span class="mw-headline" id="Source_File">Source File</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Rewrite_API/add_rewrite_rule&amp;action=edit&amp;section=8" title="Edit section: Source File">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><tt>add_rewrite_rule()</tt> is located in <code><a rel="nofollow" class="external text" href="https://core.trac.wordpress.org/browser/tags/5.0.3/src/wp-includes/rewrite.php#L0">wp-includes/rewrite.php</a></code>
</p>
<h2><span class="mw-headline" id="Related">Related</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Rewrite_API/add_rewrite_rule&amp;action=edit&amp;section=9" title="Edit section: Related">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h4><span class="mw-headline" id="Articles">Articles</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Template:Rewrite_API&amp;action=edit&amp;section=T-1" title="Template:Rewrite API">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<ul><li> Lesson: <a href="https://codex.wordpress.org/Rewrite_API" title="Rewrite API"> Rewrite API Overview</a></li>
<li> Class: <tt><a href="https://codex.wordpress.org/Class_Reference/WP_Rewrite" title="Class Reference/WP Rewrite">WP_Rewrite()</a></tt> - An overview of WordPress's built-in URL rewrite class.</li></ul>
<h4><span class="mw-headline" id="Hooks">Hooks</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Template:Rewrite_API&amp;action=edit&amp;section=T-2" title="Template:Rewrite API">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<ul><li> Filter: <tt><a href="https://codex.wordpress.org/Plugin_API/Filter_Reference/root_rewrite_rules" title="Plugin API/Filter Reference/root rewrite rules">root_rewrite_rules</a></tt> - Filters the rewrite rules generated for the root of your weblog.</li>
<li> Filter: <tt><a href="https://codex.wordpress.org/Plugin_API/Filter_Reference/post_rewrite_rules" title="Plugin API/Filter Reference/post rewrite rules">post_rewrite_rules</a></tt> - Filters the rewrite rules generated for permalink URLs.</li>
<li> Filter: <tt><a href="https://codex.wordpress.org/Plugin_API/Filter_Reference/page_rewrite_rules" title="Plugin API/Filter Reference/page rewrite rules">page_rewrite_rules</a></tt> - Filters the rewrite rules generated for your Pages.</li>
<li> Filter: <tt><a href="https://codex.wordpress.org/Plugin_API/Filter_Reference/date_rewrite_rules" title="Plugin API/Filter Reference/date rewrite rules">date_rewrite_rules</a></tt> - Filters the rewrite rules generated for dated archive URLs.</li>
<li> Filter: <tt><a href="https://codex.wordpress.org/Plugin_API/Filter_Reference/search_rewrite_rules" title="Plugin API/Filter Reference/search rewrite rules">search_rewrite_rules</a></tt> - Filters the rewrite rules generated for search URLs.</li>
<li> Filter: <tt><a href="https://codex.wordpress.org/Plugin_API/Filter_Reference/comments_rewrite_rules" title="Plugin API/Filter Reference/comments rewrite rules">comments_rewrite_rules</a></tt> - Filters the rewrite rules generated for the latest comment feed URLs.</li>
<li> Filter: <tt><a href="https://codex.wordpress.org/Plugin_API/Filter_Reference/author_rewrite_rules" title="Plugin API/Filter Reference/author rewrite rules">author_rewrite_rules</a></tt> - Filters the rewrite rules generated for author archive URLs.</li>
<li> Filter: <tt><a href="https://codex.wordpress.org/Plugin_API/Filter_Reference/rewrite_rules_array" title="Plugin API/Filter Reference/rewrite rules array">rewrite_rules_array</a></tt> - Filters <i>all</i> the rewrite rules at once.</li>
<li> Filter: <tt><a href="https://codex.wordpress.org/Plugin_API/Filter_Reference/$permastruct_rewrite_rules" title="Plugin API/Filter Reference/$permastruct rewrite rules">{$permastruct}_rewrite_rules</a></tt> - Can be used to create or modify rewrite rules for any custom permastructs, such as taxonomies or custom post types.</li>
<li> Action: <tt><a href="https://codex.wordpress.org/Plugin_API/Action_Reference/generate_rewrite_rules" title="Plugin API/Action Reference/generate rewrite rules">generate_rewrite_rules</a></tt> - Runs <strong>after</strong> all the rules have been created.</li></ul>
<h4><span class="mw-headline" id="Functions">Functions</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Template:Rewrite_API&amp;action=edit&amp;section=T-3" title="Template:Rewrite API">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<ul><li> <a href="https://codex.wordpress.org/Rewrite_API/add_rewrite_tag" title="Rewrite API/add rewrite tag"> add_rewrite_tag()</a> - Can be used to allow WordPress to recognize custom variables (particularly custom querystring variables).</li>
<li> <strong class="selflink"> add_rewrite_rule()</strong> - Allows you to specify new, custom rewrite rules.</li>
<li> <a href="https://codex.wordpress.org/Rewrite_API/add_rewrite_endpoint" title="Rewrite API/add rewrite endpoint"> add_rewrite_endpoint()</a> - Add a new endpoint like /trackback/</li>
<li> <a href="https://codex.wordpress.org/Rewrite_API/flush_rules" title="Rewrite API/flush rules"> flush_rules()</a> - Regenerate the rewrite rules and save them to the database.</li>
<li> <a href="https://codex.wordpress.org/Function_Reference/flush_rewrite_rules" title="Function Reference/flush rewrite rules"> flush_rewrite_rules()</a> - Remove rewrite rules and then recreate rewrite rules.</li>
<li> <a href="https://codex.wordpress.org/Rewrite_API/generate_rewrite_rules" title="Rewrite API/generate rewrite rules"> generate_rewrite_rules()</a> - Generates rewrite rules from a permalink structure</li>
<li> <a href="https://codex.wordpress.org/Function_Reference/add_permastruct" title="Function Reference/add permastruct"> add_permastruct()</a> - Add a new permastruct</li>
<li> <a href="https://codex.wordpress.org/Rewrite_API/add_feed" title="Rewrite API/add feed"> add_feed()</a>- Add a new feed type like /atom1/</li></ul>
<h2><span class="mw-headline" id="External_Resources">External Resources</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=Rewrite_API/add_rewrite_rule&amp;action=edit&amp;section=10" title="Edit section: External Resources">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> <a rel="nofollow" class="external text" href="https://carlalexander.ca/wordpress-adventurous-rewrite-api/">WordPress for the Adventurous: Rewrite API</a></li></ul>

<!-- 
NewPP limit report
Cached time: 20190211004114
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.020 seconds
Real time usage: 0.027 seconds
Preprocessor visited node count: 181/1000000
Preprocessor generated node count: 584/1000000
Post‐expand include size: 4163/2097152 bytes
Template argument size: 714/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    9.519      1 - -total
 35.79%    3.407      1 - Template:Languages
 21.77%    2.072      1 - Template:Trac
 18.76%    1.786      3 - Template:Parameter
 15.25%    1.452      1 - Template:Rewrite_API
 11.78%    1.121      1 - Template:ja
 10.62%    1.011      1 - Template:en
  8.48%    0.807      1 - Template:CurrentVersion
-->
