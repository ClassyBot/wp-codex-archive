<p class="LanguageLinks" style="border:1px solid #CCCCCC; line-height:1.5; text-align:left; color:#333333; font-size:90%; padding:10px;"><span style="white-space:nowrap;"><a href="https://codex.wordpress.org/Multilingual_Codex" title="Multilingual Codex" class="mw-redirect">Languages</a>:</span> 
<a href="https://codex.wordpress.org/Function_Reference/wp_insert_post" title="Function Reference/wp insert post">English</a> • 
<a rel="nofollow" class="external text" href="https://wpdocs.osdn.jp/関数リファレンス/wp">insert post 日本語</a> 
<a href="https://codex.wordpress.org/tr:Fonksiyon_Listesi/wp_insert_post" title="tr:Fonksiyon Listesi/wp insert post">Türkçe</a> • 

<strong class="selflink">中文(简体)</strong> • 
 <small>(<a href="https://codex.wordpress.org/Multilingual_Codex#Language_Cross_Reference" title="Multilingual Codex" class="mw-redirect">Add your language</a>)</small>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.E8.AF.B4.E6.98.8E"><span class="tocnumber">1</span> <span class="toctext">说明</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#.E7.94.A8.E6.B3.95"><span class="tocnumber">2</span> <span class="toctext">用法</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#.E7.A4.BA.E4.BE.8B"><span class="tocnumber">3</span> <span class="toctext">示例</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#.E5.88.86.E7.B1.BB.E7.9B.AE.E5.BD.95"><span class="tocnumber">3.1</span> <span class="toctext">分类目录</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#.E5.8F.82.E6.95.B0"><span class="tocnumber">4</span> <span class="toctext">参数</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Return"><span class="tocnumber">5</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Related"><span class="tocnumber">6</span> <span class="toctext">Related</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id=".E8.AF.B4.E6.98.8E">说明</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=zh-cn:%E5%87%BD%E6%95%B0%E5%8F%82%E8%80%83/wp_insert_post&amp;action=edit&amp;section=1" title="Edit section: 说明">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>本函数用于插入一篇日志（页面）到数据库中。在对变更进行处理，检查一些错误，完善未添加的变量比如日期时间等等。 此函数使用一组数组作为函数的参数，成功创建日志（页面）即返回日志（页面）的ID（否则返回一个错误<tt>0</tt>）。
</p>
<h2><span class="mw-headline" id=".E7.94.A8.E6.B3.95">用法</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=zh-cn:%E5%87%BD%E6%95%B0%E5%8F%82%E8%80%83/wp_insert_post&amp;action=edit&amp;section=2" title="Edit section: 用法">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><code><span style="color: #000000">
&#160;<span style="color: #0000BB">&lt;?php&#160;wp_insert_post</span><span style="color: #007700">(&#160;</span><span style="color: #0000BB">$post</span><span style="color: #007700">,&#160;</span><span style="color: #0000BB">$wp_error&#160;</span><span style="color: #007700">);&#160;</span><span style="color: #0000BB">?&gt;</span>&#160;</span>
</code>
</p>
<h2><span class="mw-headline" id=".E7.A4.BA.E4.BE.8B">示例</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=zh-cn:%E5%87%BD%E6%95%B0%E5%8F%82%E8%80%83/wp_insert_post&amp;action=edit&amp;section=3" title="Edit section: 示例">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>在调用 wp_insert_post() 之前，有必要创建一个对象 （通常是一个数组） 组成一篇日志的必要元素。wp_insert_post() 将会填写默认列表值，但用户需要提供标题和内容，否则数据库写入将会失败。
</p>
<pre>
// 创建 post 对象（数组）
  $my_post = array(
     'post_title' =&gt; 'My post',
     'post_content' =&gt; 'This is my post.',
     'post_status' =&gt; 'publish',
     'post_author' =&gt; 1,
     'post_category' =&gt; array(8,39)
  );

// 写入日志到数据库
  wp_insert_post( $my_post );
</pre>
<p>上文提到的本函数默认参数列表，如下：
</p>
<pre>
$defaults = array(
'post_status' =&gt; 'draft', 
'post_type' =&gt; 'post',
'post_author' =&gt; $user_ID,
'ping_status' =&gt; get_option('default_ping_status'), 
'post_parent' =&gt; 0,
'menu_order' =&gt; 0,
'to_ping' =&gt;  '',
'pinged' =&gt; '',
'post_password' =&gt; '',
'guid' =&gt; '',
'post_content_filtered' =&gt; '',
'post_excerpt' =&gt; '',
'import_id' =&gt; 0);
</pre>
<h3><span class="mw-headline" id=".E5.88.86.E7.B1.BB.E7.9B.AE.E5.BD.95">分类目录</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=zh-cn:%E5%87%BD%E6%95%B0%E5%8F%82%E8%80%83/wp_insert_post&amp;action=edit&amp;section=4" title="Edit section: 分类目录">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>插入分类目录到数据库，需要传递一组（数字整形）数组作为分类目录的ID。即使数组只有一个分类目录值也会分配到该日志。
</p>
<h2><span class="mw-headline" id=".E5.8F.82.E6.95.B0">参数</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=zh-cn:%E5%87%BD%E6%95%B0%E5%8F%82%E8%80%83/wp_insert_post&amp;action=edit&amp;section=5" title="Edit section: 参数">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<dl><dt> <tt>$post</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Object" title="How to Pass Tag Parameters"><i>object</i></a>) (<i>required</i>) An object representing the elements that make up a post. There is a one-to-one relationship between these elements and the names of columns in the wp_posts table in the database.
<dl><dd> Default: <i>None</i></dd></dl></dd></dl>
<p><b>IMPORTANT</b>: Setting a value for $post['ID'] WILL NOT create a post with that ID number. Setting this value will cause the function to update the post with that ID number with the other values specified in $post. In short, to insert a new post, $post['ID'] must be blank or not set at all. 
</p><p>The contents of the post array can depend on how much (or little) you want to trust the defaults. Here is a list with a short description of all the keys you can set for a post:
</p>
<pre>
$post = array(
  'ID' =&gt; [ &lt;post id&gt; ] //Are you updating an existing post?
  'menu_order' =&gt; [ &lt;order&gt; ] //If new post is a page, sets the order should it appear in the tabs.
  'comment_status' =&gt; [ 'closed' | 'open' ] // 'closed' means no comments.
  'ping_status' =&gt; [ 'closed' | 'open' ] // 'closed' means pingbacks or trackbacks turned off
  'pinged' =&gt; [&#160;? ] //?
  'post_author' =&gt; [ &lt;user ID&gt; ] //The user ID number of the author.
  'post_category' =&gt; [ array(&lt;category id&gt;, &lt;...&gt;) ] //Add some categories.
  'post_content' =&gt; [ &lt;the text of the post&gt; ] //The full text of the post.
  'post_date' =&gt; [ Y-m-d H:i:s ] //The time post was made.
  'post_date_gmt' =&gt; [ Y-m-d H:i:s ] //The time post was made, in GMT.
  'post_excerpt' =&gt; [ &lt;an excerpt&gt; ] //For all your post excerpt needs.
  'post_name' =&gt; [ &lt;the name&gt; ] // The name (slug) for your post
  'post_parent' =&gt; [ &lt;post ID&gt; ] //Sets the parent of the new post.
  'post_password' =&gt; [&#160;? ] //password for post?
  'post_status' =&gt; [ 'draft' | 'publish' | 'pending'| 'future' ] //Set the status of the new post. 
  'post_title' =&gt; [ &lt;the title&gt; ] //The title of your post.
  'post_type' =&gt; [ 'post' | 'page' ] //Sometimes you want to post a page.
  'tags_input' =&gt; [ '&lt;tag&gt;, &lt;tag&gt;, &lt;...&gt;' ] //For tags.
  'to_ping' =&gt; [&#160;? ] //?
);  
</pre>
<p><b>NOTE</b> (added 10/1/2009): The <b>page_template</b> key was removed from the $post table and is now located in the wp_postmeta table. To set the page template of a page, use <a href="https://codex.wordpress.org/Function_Reference/update_post_meta" title="Function Reference/update post meta">update_post_meta</a> instead.
</p><p><b>NOTE 2</b>: The <b>post_status</b> is documented at <a href="https://codex.wordpress.org/Post_Status_Transitions" title="Post Status Transitions">Post Status Transitions</a>.
</p><p><b>NOTE 3</b>: If providing a post_status of 'future' you must specify the post_date in order for WordPress to know when to publish your post.
</p>
<dl><dt> <tt>$wp_error</tt></dt>
<dd> (<a href="https://codex.wordpress.org/How_to_Pass_Tag_Parameters#Bool" title="How to Pass Tag Parameters"><i>bool</i></a>) (<i>optional</i>) Allow return of WP_Error object on failure
<dl><dd> Default: false</dd></dl></dd></dl>
<h2><span class="mw-headline" id="Return">Return</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=zh-cn:%E5%87%BD%E6%95%B0%E5%8F%82%E8%80%83/wp_insert_post&amp;action=edit&amp;section=6" title="Edit section: Return">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The ID of the post if the post is successfully added to the database. On failure, it returns <tt>0</tt> if $wp_error is set to false, or a WP_Error object if $wp_error is set to true.
</p>
<h2><span class="mw-headline" id="Related">Related</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/index.php?title=zh-cn:%E5%87%BD%E6%95%B0%E5%8F%82%E8%80%83/wp_insert_post&amp;action=edit&amp;section=7" title="Edit section: Related">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><a href="https://codex.wordpress.org/Function_Reference/wp_update_post" title="Function Reference/wp update post">wp_update_post()</a>, 
<a href="https://codex.wordpress.org/Function_Reference/wp_delete_post" title="Function Reference/wp delete post">wp_delete_post()</a>, 
<a href="https://codex.wordpress.org/Function_Reference/wp_publish_post" title="Function Reference/wp publish post">wp_publish_post()</a>, 
<a href="https://codex.wordpress.org/Function_Reference/wp_delete_attachment" title="Function Reference/wp delete attachment">wp_delete_attachment()</a>,
<a href="https://codex.wordpress.org/Function_Reference/wp_get_attachment_url" title="Function Reference/wp get attachment url">wp_get_attachment_url()</a>,
<a href="https://codex.wordpress.org/Function_Reference/wp_insert_attachment" title="Function Reference/wp insert attachment">wp_insert_attachment()</a>,
<a href="https://codex.wordpress.org/Plugin_API/Filter_Reference/wp_insert_post_data" title="Plugin API/Filter Reference/wp insert post data">wp_insert_post_data()</a>
</p>
<div style="background-color:#EEEEFF; border:1px solid #CCCCCC; color:#000000; padding:7px; margin:0.5em auto 0.5em auto; vertical-align:middle; overflow:hidden;">This article is <a href="https://codex.wordpress.org/Category:Copyedits" title="Category:Copyedits" class="mw-redirect">marked</a> as in need of editing. You can <a href="https://codex.wordpress.org/Codex:Contributing" title="Codex:Contributing">help</a> Codex by <b><a rel="nofollow" class="external text" href="https://codex.wordpress.org/index.php?title=zh-cn:%E5%87%BD%E6%95%B0%E5%8F%82%E8%80%83/wp_insert_post&amp;action=edit">editing it</a></b>.</div>


